!function(){"use strict";var i,r;function a(){if(null==i){var e=function(){var e=window.location;"about:srcdoc"==e.href&&(e=window.parent.location);var n={};return function(e,i,t){for(;t=i.exec(e);)n[decodeURIComponent(t[1])]=decodeURIComponent(t[2])}(e.search.substring(1).replace(/\+/g,"%20"),/([^&=]+)=?([^&]*)/g),n}();i="referrer"in e?/^https:\/\/medium.com\//.test(e.referrer):!("auto"in e)}return i}function d(e){var i=e||window.innerWidth;return 999<i?650:599<i?575:400}function s(e,i){if(window.top!==window.self){var t=window;if("srcdoc"==t.location.pathname&&(t=t.parent),r)return e=parseInt(e,10),void t.parent.postMessage({sentinel:"amp",type:"embed-size",height:e},"*");var n={sender:"Flourish",context:"iframe.resize",method:"resize",height:e,src:t.location.toString()};if(i)for(var o in i)n[o]=i[o];t.parent.postMessage(JSON.stringify(n),"*")}}function u(){return(-1!==navigator.userAgent.indexOf("Safari")||-1!==navigator.userAgent.indexOf("iPhone"))&&-1==navigator.userAgent.indexOf("Chrome")}function c(o){window.addEventListener("message",function(i){if(null!=i.source&&(i.origin===document.location.origin||i.origin.match(/\/\/localhost:\d+$|\.flourish\.(?:local(:\d+)?|rocks|studio)$/))){var e;try{e=JSON.parse(i.data)}catch(e){return void console.warn("Unexpected non-JSON message: "+JSON.stringify(i.data))}if("Flourish"===e.sender){for(var t=document.querySelectorAll("iframe"),n=0;n<t.length;n++)if(t[n].contentWindow==i.source||t[n].contentWindow==i.source.parent)return void o(e,t[n]);console.warn("could not find frame",e)}}}),u()&&(window.addEventListener("resize",e),e())}function e(){for(var e=document.querySelectorAll(".flourish-embed"),i=0;i<e.length;i++){var t=e[i];if(!t.getAttribute("data-width")){var n=t.querySelector("iframe"),o=window.getComputedStyle(t),r=t.offsetWidth-parseFloat(o.paddingLeft)-parseFloat(o.paddingRight);n.style.width=r+"px"}}}!function(){if(window.top!==window.self){var i,t=(r="#amp=1"==window.location.hash,{isFixedHeight:a,getHeightForBreakpoint:d,startEventListeners:c,notifyParentWindow:s,isSafari:u}),n=!0;Flourish.uploadImage=function(e){if("story_editor"!==Flourish.environment)throw"Invalid upload request";var i={sender:"Flourish",method:"request-upload",name:e.name,accept:e.accept};window.parent.postMessage(JSON.stringify(i),"*")},Flourish.setHeight=function(e){Flourish.fixed_height||(n=null==(i=e),o())},Flourish.checkHeight=function(){var e=Flourish.__container_height;null!=e?(Flourish.fixed_height=!0,t.notifyParentWindow(e)):t.isFixedHeight()?Flourish.fixed_height=!0:(Flourish.fixed_height=!1,o())},Flourish.fixed_height=t.isFixedHeight(),"loading"===document.readyState?document.addEventListener("DOMContentLoaded",e):e()}else Flourish.setHeight=function(){};function o(){var e;Flourish.fixed_height||(null!=i?e=i:n&&(e=t.getHeightForBreakpoint()),e!==window.innerHeight&&t.notifyParentWindow(e))}function e(){o(),window.addEventListener("resize",o)}}()}();
