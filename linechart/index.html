<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" type="text/css" href="style.css">
    <link href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:400,700" rel="stylesheet" type="text/css">
    <title>GoT line chart race</title>
</head>

<body>
    <script>
    window.Flourish = { "static_prefix": "static", "environment": "preview" };
    </script>
    <script>
    var template = function(t) {
        "use strict";
        var f = {},
            _ = {
                height_mode: "auto",
                margin_top: 5,
                margin_right: 5,
                margin_right_mobile: 5,
                margin_bottom: 0,
                margin_left: 5,
                zoom_enabled: !1,
                zoom_steps_to_show: 3,
                zoom_y_axis: !1,
                zoom_y_padding: 20,
                color: {},
                start_circle_r: 5,
                end_circle_r: 20,
                end_circle_stroke: 2,
                end_circle_stroke_bg: !0,
                horse_images: !0,
                hide_labels: !1,
                label_font_size: 14,
                rank_font_size: 14,
                rank_outside_picture: !0,
                line_opacity: 1,
                line_width: 5,
                curve: "curveLinear",
                shade: !0,
                shade_opacity: .1,
                shade_width: 15,
                missing: !1,
                missing_opacity: 1,
                missing_dash_width: .2,
                missing_dash_space: 4,
                missing_width: 1.5,
                stage_duration: 4000,
                update_duration: 500,
                label_ranks: "Ranks",
                label_scores: "Scores",
                label_replay: "Replay",
                value_type: "ranks",
                higher_scores_win: !0,
                ties_mode: "competition",
                show_buttons: !0,
                show_replay: !0,
                target_position: null,
                selected_horse: null,
                mouseover_horse: null,
                y_axis_min: null,
                y_axis_max: null,
                y_axis_min_rank: null,
                y_axis_max_rank: null,
                y_axis_label_colors: "#000",
                y_axis_label_size: 14,
                y_axis_stroke_color: "#c6c6c5",
                y_axis_format: { suffix: "%" },
                header_title: "",
                header_subtitle: "",
                header_color: "#333333",
                header_margin: "10",
                header_align: "left",
                filter_control_type: "auto-buttons",
                filter_width: 300,
                filter_include_all: !0,
                filter_all_label: "All",
                filter: null,
                localization: {},
                label_format: {},
                layout: {},
                x_axis_label_color: "#000",
                x_axis_label_size: 14,
                x_axis_rotate: "tilted"
            },
            i = "http://www.w3.org/1999/xhtml",
            r = {
                svg: "http://www.w3.org/2000/svg",
                xhtml: i,
                xlink: "http://www.w3.org/1999/xlink",
                xml: "http://www.w3.org/XML/1998/namespace",
                xmlns: "http://www.w3.org/2000/xmlns/"
            };

        function o(t) {
            var e = t += "",
                n = e.indexOf(":");
            return 0 <= n && "xmlns" !== (e = t.slice(0, n)) && (t = t.slice(n + 1)), r.hasOwnProperty(e) ? { space: r[e], local: t } : t
        }

        function a(t) {
            var e = o(t);
            return (e.local ? function(t) { return function() { return this.ownerDocument.createElementNS(t.space, t.local) } } : function(n) {
                return function() {
                    var t = this.ownerDocument,
                        e = this.namespaceURI;
                    return e === i && t.documentElement.namespaceURI === i ? t.createElement(n) : t.createElementNS(e, n)
                }
            })(e)
        }

        function e() {}

        function d(t) { return null == t ? e : function() { return this.querySelector(t) } }

        function n() { return [] }

        function y(t) { return null == t ? n : function() { return this.querySelectorAll(t) } }
        var s = function(t) { return function() { return this.matches(t) } };
        if ("undefined" != typeof document) {
            var l = document.documentElement;
            if (!l.matches) {
                var u = l.webkitMatchesSelector || l.msMatchesSelector || l.mozMatchesSelector || l.oMatchesSelector;
                s = function(t) { return function() { return u.call(this, t) } }
            }
        }
        var c = s;

        function h(t) { return new Array(t.length) }

        function p(t, e) { this.ownerDocument = t.ownerDocument, this.namespaceURI = t.namespaceURI, this._next = null, this._parent = t, this.__data__ = e } p.prototype = { constructor: p, appendChild: function(t) { return this._parent.insertBefore(t, this._next) }, insertBefore: function(t, e) { return this._parent.insertBefore(t, e) }, querySelector: function(t) { return this._parent.querySelector(t) }, querySelectorAll: function(t) { return this._parent.querySelectorAll(t) } };
        var g = "$";

        function w(t, e, n, i, r, o) { for (var a, s = 0, l = e.length, u = o.length; s < u; ++s)(a = e[s]) ? (a.__data__ = o[s], i[s] = a) : n[s] = new p(t, o[s]); for (; s < l; ++s)(a = e[s]) && (r[s] = a) }

        function k(t, e, n, i, r, o, a) {
            var s, l, u, c = {},
                h = e.length,
                f = o.length,
                _ = new Array(h);
            for (s = 0; s < h; ++s)(l = e[s]) && (_[s] = u = g + a.call(l, l.__data__, s, e), u in c ? r[s] = l : c[u] = l);
            for (s = 0; s < f; ++s)(l = c[u = g + a.call(t, o[s], s, o)]) ? ((i[s] = l).__data__ = o[s], c[u] = null) : n[s] = new p(t, o[s]);
            for (s = 0; s < h; ++s)(l = e[s]) && c[_[s]] === l && (r[s] = l)
        }

        function m(t, e) { return t < e ? -1 : e < t ? 1 : e <= t ? 0 : NaN }

        function v(t) { return t.ownerDocument && t.ownerDocument.defaultView || t.document && t || t.defaultView }

        function b(t, e) { return t.style.getPropertyValue(e) || v(t).getComputedStyle(t, null).getPropertyValue(e) }

        function x(t) { return t.trim().split(/^|\s+/) }

        function M(t) { return t.classList || new T(t) }

        function T(t) { this._node = t, this._names = x(t.getAttribute("class") || "") }

        function z(t, e) { for (var n = M(t), i = -1, r = e.length; ++i < r;) n.add(e[i]) }

        function C(t, e) { for (var n = M(t), i = -1, r = e.length; ++i < r;) n.remove(e[i]) }

        function A() { this.textContent = "" }

        function N() { this.innerHTML = "" }

        function S() { this.nextSibling && this.parentNode.appendChild(this) }

        function E() { this.previousSibling && this.parentNode.insertBefore(this, this.parentNode.firstChild) }

        function F() { return null }

        function L() {
            var t = this.parentNode;
            t && t.removeChild(this)
        }

        function P() { return this.parentNode.insertBefore(this.cloneNode(!1), this.nextSibling) }

        function D() { return this.parentNode.insertBefore(this.cloneNode(!0), this.nextSibling) } T.prototype = {
            add: function(t) { this._names.indexOf(t) < 0 && (this._names.push(t), this._node.setAttribute("class", this._names.join(" "))) },
            remove: function(t) {
                var e = this._names.indexOf(t);
                0 <= e && (this._names.splice(e, 1), this._node.setAttribute("class", this._names.join(" ")))
            },
            contains: function(t) { return 0 <= this._names.indexOf(t) }
        };
        var O = {},
            U = null;
        "undefined" != typeof document && ("onmouseenter" in document.documentElement || (O = { mouseenter: "mouseover", mouseleave: "mouseout" }));

        function H(n, t, e) {
            return n = R(n, t, e),
                function(t) {
                    var e = t.relatedTarget;
                    e && (e === this || 8 & e.compareDocumentPosition(this)) || n.call(this, t)
                }
        }

        function R(n, i, r) {
            return function(t) {
                var e = U;
                U = t;
                try { n.call(this, this.__data__, i, r) } finally { U = e }
            }
        }

        function Y(o) { return function() { var t = this.__on; if (t) { for (var e, n = 0, i = -1, r = t.length; n < r; ++n) e = t[n], o.type && e.type !== o.type || e.name !== o.name ? t[++i] = e : this.removeEventListener(e.type, e.listener, e.capture);++i ? t.length = i : delete this.__on } } }

        function q(l, u, c) {
            var h = O.hasOwnProperty(l.type) ? H : R;
            return function(t, e, n) {
                var i, r = this.__on,
                    o = h(u, e, n);
                if (r)
                    for (var a = 0, s = r.length; a < s; ++a)
                        if ((i = r[a]).type === l.type && i.name === l.name) return this.removeEventListener(i.type, i.listener, i.capture), this.addEventListener(i.type, i.listener = o, i.capture = c), void(i.value = u);
                this.addEventListener(l.type, o, c), i = { type: l.type, name: l.name, value: u, listener: o, capture: c }, r ? r.push(i) : this.__on = [i]
            }
        }

        function j(t, e, n) {
            var i = v(t),
                r = i.CustomEvent;
            "function" == typeof r ? r = new r(e, n) : (r = i.document.createEvent("Event"), n ? (r.initEvent(e, n.bubbles, n.cancelable), r.detail = n.detail) : r.initEvent(e, !1, !1)), t.dispatchEvent(r)
        }
        var B = [null];

        function I(t, e) { this._groups = t, this._parents = e }

        function X() {
            return new I([
                [document.documentElement]
            ], B)
        }

        function V(t) {
            return "string" == typeof t ? new I([
                [document.querySelector(t)]
            ], [document.documentElement]) : new I([
                [t]
            ], B)
        }

        function W(t) {
            var e = function() { for (var t, e = U; t = e.sourceEvent;) e = t; return e }();
            return e.changedTouches && (e = e.changedTouches[0]),
                function(t, e) { var n = t.ownerSVGElement || t; if (n.createSVGPoint) { var i = n.createSVGPoint(); return i.x = e.clientX, i.y = e.clientY, [(i = i.matrixTransform(t.getScreenCTM().inverse())).x, i.y] } var r = t.getBoundingClientRect(); return [e.clientX - r.left - t.clientLeft, e.clientY - r.top - t.clientTop] }(t, e)
        }

        function $(t) { return "string" == typeof t ? new I([document.querySelectorAll(t)], [document.documentElement]) : new I([null == t ? [] : t], B) } I.prototype = X.prototype = {
            constructor: I,
            select: function(t) {
                "function" != typeof t && (t = d(t));
                for (var e = this._groups, n = e.length, i = new Array(n), r = 0; r < n; ++r)
                    for (var o, a, s = e[r], l = s.length, u = i[r] = new Array(l), c = 0; c < l; ++c)(o = s[c]) && (a = t.call(o, o.__data__, c, s)) && ("__data__" in o && (a.__data__ = o.__data__), u[c] = a);
                return new I(i, this._parents)
            },
            selectAll: function(t) {
                "function" != typeof t && (t = y(t));
                for (var e = this._groups, n = e.length, i = [], r = [], o = 0; o < n; ++o)
                    for (var a, s = e[o], l = s.length, u = 0; u < l; ++u)(a = s[u]) && (i.push(t.call(a, a.__data__, u, s)), r.push(a));
                return new I(i, r)
            },
            filter: function(t) {
                "function" != typeof t && (t = c(t));
                for (var e = this._groups, n = e.length, i = new Array(n), r = 0; r < n; ++r)
                    for (var o, a = e[r], s = a.length, l = i[r] = [], u = 0; u < s; ++u)(o = a[u]) && t.call(o, o.__data__, u, a) && l.push(o);
                return new I(i, this._parents)
            },
            data: function(t, e) {
                if (!t) return d = new Array(this.size()), c = -1, this.each(function(t) { d[++c] = t }), d;
                var n, i = e ? k : w,
                    r = this._parents,
                    o = this._groups;
                "function" != typeof t && (n = t, t = function() { return n });
                for (var a = o.length, s = new Array(a), l = new Array(a), u = new Array(a), c = 0; c < a; ++c) {
                    var h = r[c],
                        f = o[c],
                        _ = f.length,
                        d = t.call(h, h && h.__data__, c, r),
                        p = d.length,
                        g = l[c] = new Array(p),
                        y = s[c] = new Array(p);
                    i(h, f, g, y, u[c] = new Array(_), d, e);
                    for (var m, v, x = 0, b = 0; x < p; ++x)
                        if (m = g[x]) {
                            for (b <= x && (b = x + 1); !(v = y[b]) && ++b < p;);
                            m._next = v || null
                        }
                }
                return (s = new I(s, r))._enter = l, s._exit = u, s
            },
            enter: function() { return new I(this._enter || this._groups.map(h), this._parents) },
            exit: function() { return new I(this._exit || this._groups.map(h), this._parents) },
            merge: function(t) {
                for (var e = this._groups, n = t._groups, i = e.length, r = n.length, o = Math.min(i, r), a = new Array(i), s = 0; s < o; ++s)
                    for (var l, u = e[s], c = n[s], h = u.length, f = a[s] = new Array(h), _ = 0; _ < h; ++_)(l = u[_] || c[_]) && (f[_] = l);
                for (; s < i; ++s) a[s] = e[s];
                return new I(a, this._parents)
            },
            order: function() {
                for (var t = this._groups, e = -1, n = t.length; ++e < n;)
                    for (var i, r = t[e], o = r.length - 1, a = r[o]; 0 <= --o;)(i = r[o]) && (a && a !== i.nextSibling && a.parentNode.insertBefore(i, a), a = i);
                return this
            },
            sort: function(n) {
                function t(t, e) { return t && e ? n(t.__data__, e.__data__) : !t - !e } n || (n = m);
                for (var e = this._groups, i = e.length, r = new Array(i), o = 0; o < i; ++o) {
                    for (var a, s = e[o], l = s.length, u = r[o] = new Array(l), c = 0; c < l; ++c)(a = s[c]) && (u[c] = a);
                    u.sort(t)
                }
                return new I(r, this._parents).order()
            },
            call: function() { var t = arguments[0]; return arguments[0] = this, t.apply(null, arguments), this },
            nodes: function() {
                var t = new Array(this.size()),
                    e = -1;
                return this.each(function() { t[++e] = this }), t
            },
            node: function() {
                for (var t = this._groups, e = 0, n = t.length; e < n; ++e)
                    for (var i = t[e], r = 0, o = i.length; r < o; ++r) { var a = i[r]; if (a) return a }
                return null
            },
            size: function() { var t = 0; return this.each(function() {++t }), t },
            empty: function() { return !this.node() },
            each: function(t) {
                for (var e = this._groups, n = 0, i = e.length; n < i; ++n)
                    for (var r, o = e[n], a = 0, s = o.length; a < s; ++a)(r = o[a]) && t.call(r, r.__data__, a, o);
                return this
            },
            attr: function(t, e) {
                var n = o(t);
                if (arguments.length < 2) { var i = this.node(); return n.local ? i.getAttributeNS(n.space, n.local) : i.getAttribute(n) }
                return this.each((null == e ? n.local ? function(t) { return function() { this.removeAttributeNS(t.space, t.local) } } : function(t) { return function() { this.removeAttribute(t) } } : "function" == typeof e ? n.local ? function(e, n) {
                    return function() {
                        var t = n.apply(this, arguments);
                        null == t ? this.removeAttributeNS(e.space, e.local) : this.setAttributeNS(e.space, e.local, t)
                    }
                } : function(e, n) {
                    return function() {
                        var t = n.apply(this, arguments);
                        null == t ? this.removeAttribute(e) : this.setAttribute(e, t)
                    }
                } : n.local ? function(t, e) { return function() { this.setAttributeNS(t.space, t.local, e) } } : function(t, e) { return function() { this.setAttribute(t, e) } })(n, e))
            },
            style: function(t, e, n) {
                return 1 < arguments.length ? this.each((null == e ? function(t) { return function() { this.style.removeProperty(t) } } : "function" == typeof e ? function(e, n, i) {
                    return function() {
                        var t = n.apply(this, arguments);
                        null == t ? this.style.removeProperty(e) : this.style.setProperty(e, t, i)
                    }
                } : function(t, e, n) { return function() { this.style.setProperty(t, e, n) } })(t, e, null == n ? "" : n)) : b(this.node(), t)
            },
            property: function(t, e) {
                return 1 < arguments.length ? this.each((null == e ? function(t) { return function() { delete this[t] } } : "function" == typeof e ? function(e, n) {
                    return function() {
                        var t = n.apply(this, arguments);
                        null == t ? delete this[e] : this[e] = t
                    }
                } : function(t, e) { return function() { this[t] = e } })(t, e)) : this.node()[t]
            },
            classed: function(t, e) {
                var n = x(t + "");
                if (arguments.length < 2) {
                    for (var i = M(this.node()), r = -1, o = n.length; ++r < o;)
                        if (!i.contains(n[r])) return !1;
                    return !0
                }
                return this.each(("function" == typeof e ? function(t, e) {
                    return function() {
                        (e.apply(this, arguments) ? z : C)(this, t)
                    }
                } : e ? function(t) { return function() { z(this, t) } } : function(t) { return function() { C(this, t) } })(n, e))
            },
            text: function(t) {
                return arguments.length ? this.each(null == t ? A : ("function" == typeof t ? function(e) {
                    return function() {
                        var t = e.apply(this, arguments);
                        this.textContent = null == t ? "" : t
                    }
                } : function(t) { return function() { this.textContent = t } })(t)) : this.node().textContent
            },
            html: function(t) {
                return arguments.length ? this.each(null == t ? N : ("function" == typeof t ? function(e) {
                    return function() {
                        var t = e.apply(this, arguments);
                        this.innerHTML = null == t ? "" : t
                    }
                } : function(t) { return function() { this.innerHTML = t } })(t)) : this.node().innerHTML
            },
            raise: function() { return this.each(S) },
            lower: function() { return this.each(E) },
            append: function(t) { var e = "function" == typeof t ? t : a(t); return this.select(function() { return this.appendChild(e.apply(this, arguments)) }) },
            insert: function(t, e) {
                var n = "function" == typeof t ? t : a(t),
                    i = null == e ? F : "function" == typeof e ? e : d(e);
                return this.select(function() { return this.insertBefore(n.apply(this, arguments), i.apply(this, arguments) || null) })
            },
            remove: function() { return this.each(L) },
            clone: function(t) { return this.select(t ? D : P) },
            datum: function(t) { return arguments.length ? this.property("__data__", t) : this.node().__data__ },
            on: function(t, e, n) {
                var i, r, o = (t + "").trim().split(/^|\s+/).map(function(t) {
                        var e = "",
                            n = t.indexOf(".");
                        return 0 <= n && (e = t.slice(n + 1), t = t.slice(0, n)), { type: t, name: e }
                    }),
                    a = o.length;
                if (!(arguments.length < 2)) { for (s = e ? q : Y, null == n && (n = !1), i = 0; i < a; ++i) this.each(s(o[i], e, n)); return this }
                var s = this.node().__on;
                if (s)
                    for (var l, u = 0, c = s.length; u < c; ++u)
                        for (i = 0, l = s[u]; i < a; ++i)
                            if ((r = o[i]).type === l.type && r.name === l.name) return l.value
            },
            dispatch: function(t, e) { return this.each(("function" == typeof e ? function(t, e) { return function() { return j(this, t, e.apply(this, arguments)) } } : function(t, e) { return function() { return j(this, t, e) } })(t, e)) }
        };
        var Z = { value: function() {} };

        function Q() {
            for (var t, e = 0, n = arguments.length, i = {}; e < n; ++e) {
                if (!(t = arguments[e] + "") || t in i) throw new Error("illegal type: " + t);
                i[t] = []
            }
            return new J(i)
        }

        function J(t) { this._ = t }

        function G(t, e) {
            for (var n, i = 0, r = t.length; i < r; ++i)
                if ((n = t[i]).name === e) return n.value
        }

        function K(t, e, n) {
            for (var i = 0, r = t.length; i < r; ++i)
                if (t[i].name === e) { t[i] = Z, t = t.slice(0, i).concat(t.slice(i + 1)); break } return null != n && t.push({ name: e, value: n }), t
        }
        J.prototype = Q.prototype = {
            constructor: J,
            on: function(t, e) {
                var n, i, r = this._,
                    o = (i = r, (t + "").trim().split(/^|\s+/).map(function(t) {
                        var e = "",
                            n = t.indexOf(".");
                        if (0 <= n && (e = t.slice(n + 1), t = t.slice(0, n)), t && !i.hasOwnProperty(t)) throw new Error("unknown type: " + t);
                        return { type: t, name: e }
                    })),
                    a = -1,
                    s = o.length;
                if (!(arguments.length < 2)) {
                    if (null != e && "function" != typeof e) throw new Error("invalid callback: " + e);
                    for (; ++a < s;)
                        if (n = (t = o[a]).type) r[n] = K(r[n], t.name, e);
                        else if (null == e)
                        for (n in r) r[n] = K(r[n], t.name, null);
                    return this
                }
                for (; ++a < s;)
                    if ((n = (t = o[a]).type) && (n = G(r[n], t.name))) return n
            },
            copy: function() {
                var t = {},
                    e = this._;
                for (var n in e) t[n] = e[n].slice();
                return new J(t)
            },
            call: function(t, e) {
                if (0 < (n = arguments.length - 2))
                    for (var n, i, r = new Array(n), o = 0; o < n; ++o) r[o] = arguments[o + 2];
                if (!this._.hasOwnProperty(t)) throw new Error("unknown type: " + t);
                for (o = 0, n = (i = this._[t]).length; o < n; ++o) i[o].value.apply(e, r)
            },
            apply: function(t, e, n) { if (!this._.hasOwnProperty(t)) throw new Error("unknown type: " + t); for (var i = this._[t], r = 0, o = i.length; r < o; ++r) i[r].value.apply(e, n) }
        };
        var tt, et, nt = 0,
            it = 0,
            rt = 0,
            ot = 1e3,
            at = 0,
            st = 0,
            lt = 0,
            ut = "object" == typeof performance && performance.now ? performance : Date,
            ct = "object" == typeof window && window.requestAnimationFrame ? window.requestAnimationFrame.bind(window) : function(t) { setTimeout(t, 17) };

        function ht() { return st || (ct(ft), st = ut.now() + lt) }

        function ft() { st = 0 }

        function _t() { this._call = this._time = this._next = null }

        function dt(t, e, n) { var i = new _t; return i.restart(t, e, n), i }

        function pt() {
            st = (at = ut.now()) + lt, nt = it = 0;
            try {! function() { ht(), ++nt; for (var t, e = tt; e;) 0 <= (t = st - e._time) && e._call.call(null, t), e = e._next;--nt }() } finally {
                nt = 0,
                    function() {
                        var t, e, n = tt,
                            i = 1 / 0;
                        for (; n;) n = n._call ? (i > n._time && (i = n._time), (t = n)._next) : (e = n._next, n._next = null, t ? t._next = e : tt = e);
                        et = t, yt(i)
                    }(), st = 0
            }
        }

        function gt() {
            var t = ut.now(),
                e = t - at;
            ot < e && (lt -= e, at = t)
        }

        function yt(t) { nt || (it && (it = clearTimeout(it)), 24 < t - st ? (t < 1 / 0 && (it = setTimeout(pt, t - ut.now() - lt)), rt && (rt = clearInterval(rt))) : (rt || (at = ut.now(), rt = setInterval(gt, ot)), nt = 1, ct(pt))) }

        function mt(e, n, t) { var i = new _t; return n = null == n ? 0 : +n, i.restart(function(t) { i.stop(), e(t + n) }, n, t), i } _t.prototype = dt.prototype = {
            constructor: _t,
            restart: function(t, e, n) {
                if ("function" != typeof t) throw new TypeError("callback is not a function");
                n = (null == n ? ht() : +n) + (null == e ? 0 : +e), this._next || et === this || (et ? et._next = this : tt = this, et = this), this._call = t, this._time = n, yt()
            },
            stop: function() { this._call && (this._call = null, this._time = 1 / 0, yt()) }
        };
        var vt = Q("start", "end", "interrupt"),
            xt = [],
            bt = 0,
            wt = 1,
            kt = 2,
            Mt = 3,
            Tt = 4,
            zt = 5,
            Ct = 6;

        function At(t, e, n, i, r, o) {
            var a = t.__transition;
            if (a) { if (n in a) return } else t.__transition = {};
            ! function(o, a, s) {
                var l, u = o.__transition;

                function c(t) {
                    var e, n, i, r;
                    if (s.state !== wt) return f();
                    for (e in u)
                        if ((r = u[e]).name === s.name) {
                            if (r.state === Mt) return mt(c);
                            r.state === Tt ? (r.state = Ct, r.timer.stop(), r.on.call("interrupt", o, o.__data__, r.index, r.group), delete u[e]) : +e < a && (r.state = Ct, r.timer.stop(), delete u[e])
                        } if (mt(function() { s.state === Mt && (s.state = Tt, s.timer.restart(h, s.delay, s.time), h(t)) }), s.state = kt, s.on.call("start", o, o.__data__, s.index, s.group), s.state === kt) {
                        for (s.state = Mt, l = new Array(i = s.tween.length), e = 0, n = -1; e < i; ++e)(r = s.tween[e].value.call(o, o.__data__, s.index, s.group)) && (l[++n] = r);
                        l.length = n + 1
                    }
                }

                function h(t) {
                    for (var e = t < s.duration ? s.ease.call(null, t / s.duration) : (s.timer.restart(f), s.state = zt, 1), n = -1, i = l.length; ++n < i;) l[n].call(null, e);
                    s.state === zt && (s.on.call("end", o, o.__data__, s.index, s.group), f())
                }

                function f() {
                    for (var t in s.state = Ct, s.timer.stop(), delete u[a], u) return;
                    delete o.__transition
                }(u[a] = s).timer = dt(function(t) { s.state = wt, s.timer.restart(c, s.delay, s.time), s.delay <= t && c(t - s.delay) }, 0, s.time)
            }(t, n, { name: e, index: i, group: r, on: vt, tween: xt, time: o.time, delay: o.delay, duration: o.duration, ease: o.ease, timer: null, state: bt })
        }

        function Nt(t, e) { var n = Et(t, e); if (n.state > bt) throw new Error("too late; already scheduled"); return n }

        function St(t, e) { var n = Et(t, e); if (n.state > kt) throw new Error("too late; already started"); return n }

        function Et(t, e) { var n = t.__transition; if (!n || !(n = n[e])) throw new Error("transition not found"); return n }

        function Ft(t, e, n) { t.prototype = e.prototype = n, n.constructor = t }

        function Lt(t, e) { var n = Object.create(t.prototype); for (var i in e) n[i] = e[i]; return n }

        function Pt() {}
        var Dt = 1 / .7,
            Ot = "\\s*([+-]?\\d+)\\s*",
            Ut = "\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",
            Ht = "\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",
            Rt = /^#([0-9a-f]{3})$/,
            Yt = /^#([0-9a-f]{6})$/,
            qt = new RegExp("^rgb\\(" + [Ot, Ot, Ot] + "\\)$"),
            jt = new RegExp("^rgb\\(" + [Ht, Ht, Ht] + "\\)$"),
            Bt = new RegExp("^rgba\\(" + [Ot, Ot, Ot, Ut] + "\\)$"),
            It = new RegExp("^rgba\\(" + [Ht, Ht, Ht, Ut] + "\\)$"),
            Xt = new RegExp("^hsl\\(" + [Ut, Ht, Ht] + "\\)$"),
            Vt = new RegExp("^hsla\\(" + [Ut, Ht, Ht, Ut] + "\\)$"),
            Wt = {
                aliceblue: 15792383,
                antiquewhite: 16444375,
                aqua: 65535,
                aquamarine: 8388564,
                azure: 15794175,
                beige: 16119260,
                bisque: 16770244,
                black: 0,
                blanchedalmond: 16772045,
                blue: 255,
                blueviolet: 9055202,
                brown: 10824234,
                burlywood: 14596231,
                cadetblue: 6266528,
                chartreuse: 8388352,
                chocolate: 13789470,
                coral: 16744272,
                cornflowerblue: 6591981,
                cornsilk: 16775388,
                crimson: 14423100,
                cyan: 65535,
                darkblue: 139,
                darkcyan: 35723,
                darkgoldenrod: 12092939,
                darkgray: 11119017,
                darkgreen: 25600,
                darkgrey: 11119017,
                darkkhaki: 12433259,
                darkmagenta: 9109643,
                darkolivegreen: 5597999,
                darkorange: 16747520,
                darkorchid: 10040012,
                darkred: 9109504,
                darksalmon: 15308410,
                darkseagreen: 9419919,
                darkslateblue: 4734347,
                darkslategray: 3100495,
                darkslategrey: 3100495,
                darkturquoise: 52945,
                darkviolet: 9699539,
                deeppink: 16716947,
                deepskyblue: 49151,
                dimgray: 6908265,
                dimgrey: 6908265,
                dodgerblue: 2003199,
                firebrick: 11674146,
                floralwhite: 16775920,
                forestgreen: 2263842,
                fuchsia: 16711935,
                gainsboro: 14474460,
                ghostwhite: 16316671,
                gold: 16766720,
                goldenrod: 14329120,
                gray: 8421504,
                green: 32768,
                greenyellow: 11403055,
                grey: 8421504,
                honeydew: 15794160,
                hotpink: 16738740,
                indianred: 13458524,
                indigo: 4915330,
                ivory: 16777200,
                khaki: 15787660,
                lavender: 15132410,
                lavenderblush: 16773365,
                lawngreen: 8190976,
                lemonchiffon: 16775885,
                lightblue: 11393254,
                lightcoral: 15761536,
                lightcyan: 14745599,
                lightgoldenrodyellow: 16448210,
                lightgray: 13882323,
                lightgreen: 9498256,
                lightgrey: 13882323,
                lightpink: 16758465,
                lightsalmon: 16752762,
                lightseagreen: 2142890,
                lightskyblue: 8900346,
                lightslategray: 7833753,
                lightslategrey: 7833753,
                lightsteelblue: 11584734,
                lightyellow: 16777184,
                lime: 65280,
                limegreen: 3329330,
                linen: 16445670,
                magenta: 16711935,
                maroon: 8388608,
                mediumaquamarine: 6737322,
                mediumblue: 205,
                mediumorchid: 12211667,
                mediumpurple: 9662683,
                mediumseagreen: 3978097,
                mediumslateblue: 8087790,
                mediumspringgreen: 64154,
                mediumturquoise: 4772300,
                mediumvioletred: 13047173,
                midnightblue: 1644912,
                mintcream: 16121850,
                mistyrose: 16770273,
                moccasin: 16770229,
                navajowhite: 16768685,
                navy: 128,
                oldlace: 16643558,
                olive: 8421376,
                olivedrab: 7048739,
                orange: 16753920,
                orangered: 16729344,
                orchid: 14315734,
                palegoldenrod: 15657130,
                palegreen: 10025880,
                paleturquoise: 11529966,
                palevioletred: 14381203,
                papayawhip: 16773077,
                peachpuff: 16767673,
                peru: 13468991,
                pink: 16761035,
                plum: 14524637,
                powderblue: 11591910,
                purple: 8388736,
                rebeccapurple: 6697881,
                red: 16711680,
                rosybrown: 12357519,
                royalblue: 4286945,
                saddlebrown: 9127187,
                salmon: 16416882,
                sandybrown: 16032864,
                seagreen: 3050327,
                seashell: 16774638,
                sienna: 10506797,
                silver: 12632256,
                skyblue: 8900331,
                slateblue: 6970061,
                slategray: 7372944,
                slategrey: 7372944,
                snow: 16775930,
                springgreen: 65407,
                steelblue: 4620980,
                tan: 13808780,
                teal: 32896,
                thistle: 14204888,
                tomato: 16737095,
                turquoise: 4251856,
                violet: 15631086,
                wheat: 16113331,
                white: 16777215,
                whitesmoke: 16119285,
                yellow: 16776960,
                yellowgreen: 10145074
            };

        function $t(t) { var e; return t = (t + "").trim().toLowerCase(), (e = Rt.exec(t)) ? new Kt((e = parseInt(e[1], 16)) >> 8 & 15 | e >> 4 & 240, e >> 4 & 15 | 240 & e, (15 & e) << 4 | 15 & e, 1) : (e = Yt.exec(t)) ? Zt(parseInt(e[1], 16)) : (e = qt.exec(t)) ? new Kt(e[1], e[2], e[3], 1) : (e = jt.exec(t)) ? new Kt(255 * e[1] / 100, 255 * e[2] / 100, 255 * e[3] / 100, 1) : (e = Bt.exec(t)) ? Qt(e[1], e[2], e[3], e[4]) : (e = It.exec(t)) ? Qt(255 * e[1] / 100, 255 * e[2] / 100, 255 * e[3] / 100, e[4]) : (e = Xt.exec(t)) ? ee(e[1], e[2] / 100, e[3] / 100, 1) : (e = Vt.exec(t)) ? ee(e[1], e[2] / 100, e[3] / 100, e[4]) : Wt.hasOwnProperty(t) ? Zt(Wt[t]) : "transparent" === t ? new Kt(NaN, NaN, NaN, 0) : null }

        function Zt(t) { return new Kt(t >> 16 & 255, t >> 8 & 255, 255 & t, 1) }

        function Qt(t, e, n, i) { return i <= 0 && (t = e = n = NaN), new Kt(t, e, n, i) }

        function Jt(t) { return t instanceof Pt || (t = $t(t)), t ? new Kt((t = t.rgb()).r, t.g, t.b, t.opacity) : new Kt }

        function Gt(t, e, n, i) { return 1 === arguments.length ? Jt(t) : new Kt(t, e, n, null == i ? 1 : i) }

        function Kt(t, e, n, i) { this.r = +t, this.g = +e, this.b = +n, this.opacity = +i }

        function te(t) { return ((t = Math.max(0, Math.min(255, Math.round(t) || 0))) < 16 ? "0" : "") + t.toString(16) }

        function ee(t, e, n, i) { return i <= 0 ? t = e = n = NaN : n <= 0 || 1 <= n ? t = e = NaN : e <= 0 && (t = NaN), new ne(t, e, n, i) }

        function ne(t, e, n, i) { this.h = +t, this.s = +e, this.l = +n, this.opacity = +i }

        function ie(t, e, n) { return 255 * (t < 60 ? e + (n - e) * t / 60 : t < 180 ? n : t < 240 ? e + (n - e) * (240 - t) / 60 : e) } Ft(Pt, $t, { displayable: function() { return this.rgb().displayable() }, hex: function() { return this.rgb().hex() }, toString: function() { return this.rgb() + "" } }), Ft(Kt, Gt, Lt(Pt, { brighter: function(t) { return t = null == t ? Dt : Math.pow(Dt, t), new Kt(this.r * t, this.g * t, this.b * t, this.opacity) }, darker: function(t) { return t = null == t ? .7 : Math.pow(.7, t), new Kt(this.r * t, this.g * t, this.b * t, this.opacity) }, rgb: function() { return this }, displayable: function() { return 0 <= this.r && this.r <= 255 && 0 <= this.g && this.g <= 255 && 0 <= this.b && this.b <= 255 && 0 <= this.opacity && this.opacity <= 1 }, hex: function() { return "#" + te(this.r) + te(this.g) + te(this.b) }, toString: function() { var t = this.opacity; return (1 === (t = isNaN(t) ? 1 : Math.max(0, Math.min(1, t))) ? "rgb(" : "rgba(") + Math.max(0, Math.min(255, Math.round(this.r) || 0)) + ", " + Math.max(0, Math.min(255, Math.round(this.g) || 0)) + ", " + Math.max(0, Math.min(255, Math.round(this.b) || 0)) + (1 === t ? ")" : ", " + t + ")") } })), Ft(ne, function(t, e, n, i) {
            return 1 === arguments.length ? function(t) {
                if (t instanceof ne) return new ne(t.h, t.s, t.l, t.opacity);
                if (t instanceof Pt || (t = $t(t)), !t) return new ne;
                if (t instanceof ne) return t;
                var e = (t = t.rgb()).r / 255,
                    n = t.g / 255,
                    i = t.b / 255,
                    r = Math.min(e, n, i),
                    o = Math.max(e, n, i),
                    a = NaN,
                    s = o - r,
                    l = (o + r) / 2;
                return s ? (a = e === o ? (n - i) / s + 6 * (n < i) : n === o ? (i - e) / s + 2 : (e - n) / s + 4, s /= l < .5 ? o + r : 2 - o - r, a *= 60) : s = 0 < l && l < 1 ? 0 : a, new ne(a, s, l, t.opacity)
            }(t) : new ne(t, e, n, null == i ? 1 : i)
        }, Lt(Pt, {
            brighter: function(t) { return t = null == t ? Dt : Math.pow(Dt, t), new ne(this.h, this.s, this.l * t, this.opacity) },
            darker: function(t) { return t = null == t ? .7 : Math.pow(.7, t), new ne(this.h, this.s, this.l * t, this.opacity) },
            rgb: function() {
                var t = this.h % 360 + 360 * (this.h < 0),
                    e = isNaN(t) || isNaN(this.s) ? 0 : this.s,
                    n = this.l,
                    i = n + (n < .5 ? n : 1 - n) * e,
                    r = 2 * n - i;
                return new Kt(ie(240 <= t ? t - 240 : t + 120, r, i), ie(t, r, i), ie(t < 120 ? t + 240 : t - 120, r, i), this.opacity)
            },
            displayable: function() { return (0 <= this.s && this.s <= 1 || isNaN(this.s)) && 0 <= this.l && this.l <= 1 && 0 <= this.opacity && this.opacity <= 1 }
        }));
        var re = Math.PI / 180,
            oe = 180 / Math.PI,
            ae = .96422,
            se = 1,
            le = .82521,
            ue = 4 / 29,
            ce = 6 / 29,
            he = 3 * ce * ce,
            fe = ce * ce * ce;

        function _e(t) {
            if (t instanceof de) return new de(t.l, t.a, t.b, t.opacity);
            if (t instanceof xe) { if (isNaN(t.h)) return new de(t.l, 0, 0, t.opacity); var e = t.h * re; return new de(t.l, Math.cos(e) * t.c, Math.sin(e) * t.c, t.opacity) } t instanceof Kt || (t = Jt(t));
            var n, i, r = me(t.r),
                o = me(t.g),
                a = me(t.b),
                s = pe((.2225045 * r + .7168786 * o + .0606169 * a) / se);
            return r === o && o === a ? n = i = s : (n = pe((.4360747 * r + .3850649 * o + .1430804 * a) / ae), i = pe((.0139322 * r + .0971045 * o + .7141733 * a) / le)), new de(116 * s - 16, 500 * (n - s), 200 * (s - i), t.opacity)
        }

        function de(t, e, n, i) { this.l = +t, this.a = +e, this.b = +n, this.opacity = +i }

        function pe(t) { return fe < t ? Math.pow(t, 1 / 3) : t / he + ue }

        function ge(t) { return ce < t ? t * t * t : he * (t - ue) }

        function ye(t) { return 255 * (t <= .0031308 ? 12.92 * t : 1.055 * Math.pow(t, 1 / 2.4) - .055) }

        function me(t) { return (t /= 255) <= .04045 ? t / 12.92 : Math.pow((t + .055) / 1.055, 2.4) }

        function ve(t, e, n, i) { return 1 === arguments.length ? function(t) { if (t instanceof xe) return new xe(t.h, t.c, t.l, t.opacity); if (t instanceof de || (t = _e(t)), 0 === t.a && 0 === t.b) return new xe(NaN, 0, t.l, t.opacity); var e = Math.atan2(t.b, t.a) * oe; return new xe(e < 0 ? e + 360 : e, Math.sqrt(t.a * t.a + t.b * t.b), t.l, t.opacity) }(t) : new xe(t, e, n, null == i ? 1 : i) }

        function xe(t, e, n, i) { this.h = +t, this.c = +e, this.l = +n, this.opacity = +i } Ft(de, function(t, e, n, i) { return 1 === arguments.length ? _e(t) : new de(t, e, n, null == i ? 1 : i) }, Lt(Pt, {
            brighter: function(t) { return new de(this.l + 18 * (null == t ? 1 : t), this.a, this.b, this.opacity) },
            darker: function(t) { return new de(this.l - 18 * (null == t ? 1 : t), this.a, this.b, this.opacity) },
            rgb: function() {
                var t = (this.l + 16) / 116,
                    e = isNaN(this.a) ? t : t + this.a / 500,
                    n = isNaN(this.b) ? t : t - this.b / 200;
                return new Kt(ye(3.1338561 * (e = ae * ge(e)) - 1.6168667 * (t = se * ge(t)) - .4906146 * (n = le * ge(n))), ye(-.9787684 * e + 1.9161415 * t + .033454 * n), ye(.0719453 * e - .2289914 * t + 1.4052427 * n), this.opacity)
            }
        })), Ft(xe, ve, Lt(Pt, { brighter: function(t) { return new xe(this.h, this.c, this.l + 18 * (null == t ? 1 : t), this.opacity) }, darker: function(t) { return new xe(this.h, this.c, this.l - 18 * (null == t ? 1 : t), this.opacity) }, rgb: function() { return _e(this).rgb() } }));
        var be = 1.78277,
            we = -.29227,
            ke = -.90649,
            Me = 1.97294,
            Te = Me * ke,
            ze = Me * be,
            Ce = be * we - -.14861 * ke;

        function Ae(t, e, n, i) { this.h = +t, this.s = +e, this.l = +n, this.opacity = +i }

        function Ne(t) { return function() { return t } }

        function Se(o) { return 1 == (o = +o) ? Ee : function(t, e) { return e - t ? (n = t, i = e, r = o, n = Math.pow(n, r), i = Math.pow(i, r) - n, r = 1 / r, function(t) { return Math.pow(n + t * i, r) }) : Ne(isNaN(t) ? e : t); var n, i, r } }

        function Ee(t, e) { var n, i, r = e - t; return r ? (n = t, i = r, function(t) { return n + t * i }) : Ne(isNaN(t) ? e : t) } Ft(Ae, function(t, e, n, i) {
            return 1 === arguments.length ? function(t) {
                if (t instanceof Ae) return new Ae(t.h, t.s, t.l, t.opacity);
                t instanceof Kt || (t = Jt(t));
                var e = t.r / 255,
                    n = t.g / 255,
                    i = t.b / 255,
                    r = (Ce * i + Te * e - ze * n) / (Ce + Te - ze),
                    o = i - r,
                    a = (Me * (n - r) - we * o) / ke,
                    s = Math.sqrt(a * a + o * o) / (Me * r * (1 - r)),
                    l = s ? Math.atan2(a, o) * oe - 120 : NaN;
                return new Ae(l < 0 ? l + 360 : l, s, r, t.opacity)
            }(t) : new Ae(t, e, n, null == i ? 1 : i)
        }, Lt(Pt, {
            brighter: function(t) { return t = null == t ? Dt : Math.pow(Dt, t), new Ae(this.h, this.s, this.l * t, this.opacity) },
            darker: function(t) { return t = null == t ? .7 : Math.pow(.7, t), new Ae(this.h, this.s, this.l * t, this.opacity) },
            rgb: function() {
                var t = isNaN(this.h) ? 0 : (this.h + 120) * re,
                    e = +this.l,
                    n = isNaN(this.s) ? 0 : this.s * e * (1 - e),
                    i = Math.cos(t),
                    r = Math.sin(t);
                return new Kt(255 * (e + n * (-.14861 * i + be * r)), 255 * (e + n * (we * i + ke * r)), 255 * (e + n * (Me * i)), this.opacity)
            }
        }));
        var Fe = function t(e) {
            var a = Se(e);

            function n(e, t) {
                var n = a((e = Gt(e)).r, (t = Gt(t)).r),
                    i = a(e.g, t.g),
                    r = a(e.b, t.b),
                    o = Ee(e.opacity, t.opacity);
                return function(t) { return e.r = n(t), e.g = i(t), e.b = r(t), e.opacity = o(t), e + "" }
            }
            return n.gamma = t, n
        }(1);

        function Le(e, n) {
            return n -= e = +e,
                function(t) { return e + n * t }
        }
        var Pe = /[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,
            De = new RegExp(Pe.source, "g");

        function Oe(t, i) {
            var e, n, r, o, a, s = Pe.lastIndex = De.lastIndex = 0,
                l = -1,
                u = [],
                c = [];
            for (t += "", i += "";
                (e = Pe.exec(t)) && (n = De.exec(i));)(r = n.index) > s && (r = i.slice(s, r), u[l] ? u[l] += r : u[++l] = r), (e = e[0]) === (n = n[0]) ? u[l] ? u[l] += n : u[++l] = n : (u[++l] = null, c.push({ i: l, x: Le(e, n) })), s = De.lastIndex;
            return s < i.length && (r = i.slice(s), u[l] ? u[l] += r : u[++l] = r), u.length < 2 ? c[0] ? (a = c[0].x, function(t) { return a(t) + "" }) : (o = i, function() { return o }) : (i = c.length, function(t) { for (var e, n = 0; n < i; ++n) u[(e = c[n]).i] = e.x(t); return u.join("") })
        }

        function Ue(t, e) {
            var n, i = typeof e;
            return null == e || "boolean" === i ? Ne(e) : ("number" === i ? Le : "string" === i ? (n = $t(e)) ? (e = n, Fe) : Oe : e instanceof $t ? Fe : e instanceof Date ? function(e, n) {
                var i = new Date;
                return n -= e = +e,
                    function(t) { return i.setTime(e + n * t), i }
            } : Array.isArray(e) ? function(t, e) {
                var n, i = e ? e.length : 0,
                    r = t ? Math.min(i, t.length) : 0,
                    o = new Array(r),
                    a = new Array(i);
                for (n = 0; n < r; ++n) o[n] = Ue(t[n], e[n]);
                for (; n < i; ++n) a[n] = e[n];
                return function(t) { for (n = 0; n < r; ++n) a[n] = o[n](t); return a }
            } : "function" != typeof e.valueOf && "function" != typeof e.toString || isNaN(e) ? function(t, e) {
                var n, i = {},
                    r = {};
                for (n in null !== t && "object" == typeof t || (t = {}), null !== e && "object" == typeof e || (e = {}), e) n in t ? i[n] = Ue(t[n], e[n]) : r[n] = e[n];
                return function(t) { for (n in i) r[n] = i[n](t); return r }
            } : Le)(t, e)
        }

        function He(e, n) {
            return n -= e = +e,
                function(t) { return Math.round(e + n * t) }
        }
        var Re, Ye, qe, je, Be = 180 / Math.PI,
            Ie = { translateX: 0, translateY: 0, rotate: 0, skewX: 0, scaleX: 1, scaleY: 1 };

        function Xe(t, e, n, i, r, o) { var a, s, l; return (a = Math.sqrt(t * t + e * e)) && (t /= a, e /= a), (l = t * n + e * i) && (n -= t * l, i -= e * l), (s = Math.sqrt(n * n + i * i)) && (n /= s, i /= s, l /= s), t * i < e * n && (t = -t, e = -e, l = -l, a = -a), { translateX: r, translateY: o, rotate: Math.atan2(e, t) * Be, skewX: Math.atan(l) * Be, scaleX: a, scaleY: s } }

        function Ve(f, _, d, p) {
            function g(t) { return t.length ? t.pop() + " " : "" }
            return function(t, e) {
                var n, i, r, o, a, s, l, u, c = [],
                    h = [];
                return t = f(t), e = f(e),
                    function(t, e, n, i, r, o) {
                        if (t !== n || e !== i) {
                            var a = r.push("translate(", null, _, null, d);
                            o.push({ i: a - 4, x: Le(t, n) }, { i: a - 2, x: Le(e, i) })
                        } else(n || i) && r.push("translate(" + n + _ + i + d)
                    }(t.translateX, t.translateY, e.translateX, e.translateY, c, h), n = t.rotate, i = e.rotate, r = c, o = h, n !== i ? (180 < n - i ? i += 360 : 180 < i - n && (n += 360), o.push({ i: r.push(g(r) + "rotate(", null, p) - 2, x: Le(n, i) })) : i && r.push(g(r) + "rotate(" + i + p), a = t.skewX, s = e.skewX, l = c, u = h, a !== s ? u.push({ i: l.push(g(l) + "skewX(", null, p) - 2, x: Le(a, s) }) : s && l.push(g(l) + "skewX(" + s + p),
                    function(t, e, n, i, r, o) {
                        if (t !== n || e !== i) {
                            var a = r.push(g(r) + "scale(", null, ",", null, ")");
                            o.push({ i: a - 4, x: Le(t, n) }, { i: a - 2, x: Le(e, i) })
                        } else 1 === n && 1 === i || r.push(g(r) + "scale(" + n + "," + i + ")")
                    }(t.scaleX, t.scaleY, e.scaleX, e.scaleY, c, h), t = e = null,
                    function(t) { for (var e, n = -1, i = h.length; ++n < i;) c[(e = h[n]).i] = e.x(t); return c.join("") }
            }
        }
        var We = Ve(function(t) { return "none" === t ? Ie : (Re || (Re = document.createElement("DIV"), Ye = document.documentElement, qe = document.defaultView), Re.style.transform = t, t = qe.getComputedStyle(Ye.appendChild(Re), null).getPropertyValue("transform"), Ye.removeChild(Re), Xe(+(t = t.slice(7, -1).split(","))[0], +t[1], +t[2], +t[3], +t[4], +t[5])) }, "px, ", "px)", "deg)"),
            $e = Ve(function(t) { return null == t ? Ie : (je || (je = document.createElementNS("http://www.w3.org/2000/svg", "g")), je.setAttribute("transform", t), (t = je.transform.baseVal.consolidate()) ? Xe((t = t.matrix).a, t.b, t.c, t.d, t.e, t.f) : Ie) }, ", ", ")", ")");
        Math.SQRT2;

        function Ze(t, e, n) {
            var i = t._id;
            return t.each(function() {
                    var t = St(this, i);
                    (t.value || (t.value = {}))[e] = n.apply(this, arguments)
                }),
                function(t) { return Et(t, i).value[e] }
        }

        function Qe(t, e) { var n; return ("number" == typeof e ? Le : e instanceof $t ? Fe : (n = $t(e)) ? (e = n, Fe) : Oe)(t, e) }
        var Je = X.prototype.constructor;
        var Ge = 0;

        function Ke(t, e, n, i) { this._groups = t, this._parents = e, this._name = n, this._id = i }

        function tn() { return ++Ge }
        var en = X.prototype;
        Ke.prototype = function(t) { return X().transition(t) }.prototype = {
            constructor: Ke,
            select: function(t) {
                var e = this._name,
                    n = this._id;
                "function" != typeof t && (t = d(t));
                for (var i = this._groups, r = i.length, o = new Array(r), a = 0; a < r; ++a)
                    for (var s, l, u = i[a], c = u.length, h = o[a] = new Array(c), f = 0; f < c; ++f)(s = u[f]) && (l = t.call(s, s.__data__, f, u)) && ("__data__" in s && (l.__data__ = s.__data__), h[f] = l, At(h[f], e, n, f, h, Et(s, n)));
                return new Ke(o, this._parents, e, n)
            },
            selectAll: function(t) {
                var e = this._name,
                    n = this._id;
                "function" != typeof t && (t = y(t));
                for (var i = this._groups, r = i.length, o = [], a = [], s = 0; s < r; ++s)
                    for (var l, u = i[s], c = u.length, h = 0; h < c; ++h)
                        if (l = u[h]) {
                            for (var f, _ = t.call(l, l.__data__, h, u), d = Et(l, n), p = 0, g = _.length; p < g; ++p)(f = _[p]) && At(f, e, n, p, _, d);
                            o.push(_), a.push(l)
                        } return new Ke(o, a, e, n)
            },
            filter: function(t) {
                "function" != typeof t && (t = c(t));
                for (var e = this._groups, n = e.length, i = new Array(n), r = 0; r < n; ++r)
                    for (var o, a = e[r], s = a.length, l = i[r] = [], u = 0; u < s; ++u)(o = a[u]) && t.call(o, o.__data__, u, a) && l.push(o);
                return new Ke(i, this._parents, this._name, this._id)
            },
            merge: function(t) {
                if (t._id !== this._id) throw new Error;
                for (var e = this._groups, n = t._groups, i = e.length, r = n.length, o = Math.min(i, r), a = new Array(i), s = 0; s < o; ++s)
                    for (var l, u = e[s], c = n[s], h = u.length, f = a[s] = new Array(h), _ = 0; _ < h; ++_)(l = u[_] || c[_]) && (f[_] = l);
                for (; s < i; ++s) a[s] = e[s];
                return new Ke(a, this._parents, this._name, this._id)
            },
            selection: function() { return new Je(this._groups, this._parents) },
            transition: function() {
                for (var t = this._name, e = this._id, n = tn(), i = this._groups, r = i.length, o = 0; o < r; ++o)
                    for (var a, s = i[o], l = s.length, u = 0; u < l; ++u)
                        if (a = s[u]) {
                            var c = Et(a, e);
                            At(a, t, n, u, s, { time: c.time + c.delay + c.duration, delay: 0, duration: c.duration, ease: c.ease })
                        } return new Ke(i, this._parents, t, n)
            },
            call: en.call,
            nodes: en.nodes,
            node: en.node,
            size: en.size,
            empty: en.empty,
            each: en.each,
            on: function(t, e) {
                var n, i, r, o, a, s, l = this._id;
                return arguments.length < 2 ? Et(this.node(), l).on.on(t) : this.each((n = l, r = e, s = ((i = t) + "").trim().split(/^|\s+/).every(function(t) { var e = t.indexOf("."); return 0 <= e && (t = t.slice(0, e)), !t || "start" === t }) ? Nt : St, function() {
                    var t = s(this, n),
                        e = t.on;
                    e !== o && (a = (o = e).copy()).on(i, r), t.on = a
                }))
            },
            attr: function(t, e) {
                var n = o(t),
                    i = "transform" === n ? $e : Qe;
                return this.attrTween(t, "function" == typeof e ? (n.local ? function(n, i, r) {
                    var o, a, s;
                    return function() {
                        var t, e = r(this);
                        if (null != e) return (t = this.getAttributeNS(n.space, n.local)) === e ? null : t === o && e === a ? s : s = i(o = t, a = e);
                        this.removeAttributeNS(n.space, n.local)
                    }
                } : function(n, i, r) {
                    var o, a, s;
                    return function() {
                        var t, e = r(this);
                        if (null != e) return (t = this.getAttribute(n)) === e ? null : t === o && e === a ? s : s = i(o = t, a = e);
                        this.removeAttribute(n)
                    }
                })(n, i, Ze(this, "attr." + t, e)) : null == e ? (n.local ? function(t) { return function() { this.removeAttributeNS(t.space, t.local) } } : function(t) { return function() { this.removeAttribute(t) } })(n) : (n.local ? function(e, n, i) { var r, o; return function() { var t = this.getAttributeNS(e.space, e.local); return t === i ? null : t === r ? o : o = n(r = t, i) } } : function(e, n, i) { var r, o; return function() { var t = this.getAttribute(e); return t === i ? null : t === r ? o : o = n(r = t, i) } })(n, i, e + ""))
            },
            attrTween: function(t, e) {
                var n = "attr." + t;
                if (arguments.length < 2) return (n = this.tween(n)) && n._value;
                if (null == e) return this.tween(n, null);
                if ("function" != typeof e) throw new Error;
                var i = o(t);
                return this.tween(n, (i.local ? function(i, t) {
                    function e() {
                        var e = this,
                            n = t.apply(e, arguments);
                        return n && function(t) { e.setAttributeNS(i.space, i.local, n(t)) }
                    }
                    return e._value = t, e
                } : function(i, t) {
                    function e() {
                        var e = this,
                            n = t.apply(e, arguments);
                        return n && function(t) { e.setAttribute(i, n(t)) }
                    }
                    return e._value = t, e
                })(i, e))
            },
            style: function(t, e, n) {
                var i, r, o, a, s, l, u, c, h, f, _, d, p, g, y, m, v, x = "transform" == (t += "") ? We : Qe;
                return null == e ? this.styleTween(t, (p = t, g = x, function() {
                    var t = b(this, p),
                        e = (this.style.removeProperty(p), b(this, p));
                    return t === e ? null : t === y && e === m ? v : v = g(y = t, m = e)
                })).on("end.style." + t, (d = t, function() { this.style.removeProperty(d) })) : this.styleTween(t, "function" == typeof e ? (u = x, c = Ze(this, "style." + (l = t), e), function() {
                    var t = b(this, l),
                        e = c(this);
                    return null == e && (this.style.removeProperty(l), e = b(this, l)), t === e ? null : t === h && e === f ? _ : _ = u(h = t, f = e)
                }) : (i = t, r = x, o = e + "", function() { var t = b(this, i); return t === o ? null : t === a ? s : s = r(a = t, o) }), n)
            },
            styleTween: function(t, e, n) {
                var i = "style." + (t += "");
                if (arguments.length < 2) return (i = this.tween(i)) && i._value;
                if (null == e) return this.tween(i, null);
                if ("function" != typeof e) throw new Error;
                return this.tween(i, function(i, t, r) {
                    function e() {
                        var e = this,
                            n = t.apply(e, arguments);
                        return n && function(t) { e.style.setProperty(i, n(t), r) }
                    }
                    return e._value = t, e
                }(t, e, null == n ? "" : n))
            },
            text: function(t) {
                return this.tween("text", "function" == typeof t ? (n = Ze(this, "text", t), function() {
                    var t = n(this);
                    this.textContent = null == t ? "" : t
                }) : (e = null == t ? "" : t + "", function() { this.textContent = e }));
                var e, n
            },
            remove: function() {
                return this.on("end.remove", (n = this._id, function() {
                    var t = this.parentNode;
                    for (var e in this.__transition)
                        if (+e !== n) return;
                    t && t.removeChild(this)
                }));
                var n
            },
            tween: function(t, e) {
                var n = this._id;
                if (t += "", arguments.length < 2) {
                    for (var i, r = Et(this.node(), n).tween, o = 0, a = r.length; o < a; ++o)
                        if ((i = r[o]).name === t) return i.value;
                    return null
                }
                return this.each((null == e ? function(r, o) {
                    var a, s;
                    return function() {
                        var t = St(this, r),
                            e = t.tween;
                        if (e !== a)
                            for (var n = 0, i = (s = a = e).length; n < i; ++n)
                                if (s[n].name === o) {
                                    (s = s.slice()).splice(n, 1);
                                    break
                                } t.tween = s
                    }
                } : function(o, a, s) {
                    var l, u;
                    if ("function" != typeof s) throw new Error;
                    return function() {
                        var t = St(this, o),
                            e = t.tween;
                        if (e !== l) {
                            u = (l = e).slice();
                            for (var n = { name: a, value: s }, i = 0, r = u.length; i < r; ++i)
                                if (u[i].name === a) { u[i] = n; break } i === r && u.push(n)
                        }
                        t.tween = u
                    }
                })(n, t, e))
            },
            delay: function(t) {
                var e = this._id;
                return arguments.length ? this.each(("function" == typeof t ? function(t, e) { return function() { Nt(this, t).delay = +e.apply(this, arguments) } } : function(t, e) {
                    return e = +e,
                        function() { Nt(this, t).delay = e }
                })(e, t)) : Et(this.node(), e).delay
            },
            duration: function(t) {
                var e = this._id;
                return arguments.length ? this.each(("function" == typeof t ? function(t, e) { return function() { St(this, t).duration = +e.apply(this, arguments) } } : function(t, e) {
                    return e = +e,
                        function() { St(this, t).duration = e }
                })(e, t)) : Et(this.node(), e).duration
            },
            ease: function(t) { var e = this._id; return arguments.length ? this.each(function(t, e) { if ("function" != typeof e) throw new Error; return function() { St(this, t).ease = e } }(e, t)) : Et(this.node(), e).ease }
        };
        Math.PI, Math.PI;
        var nn = { time: null, delay: 0, duration: 250, ease: function(t) { return ((t *= 2) <= 1 ? t * t * t : (t -= 2) * t * t + 2) / 2 } };

        function rn(t, e) {
            for (var n; !(n = t.__transition) || !(n = n[e]);)
                if (!(t = t.parentNode)) return nn.time = ht(), nn;
            return n
        }

        function on(t, e) { return t < e ? -1 : e < t ? 1 : e <= t ? 0 : NaN } X.prototype.interrupt = function(t) {
            return this.each(function() {
                ! function(t, e) {
                    var n, i, r, o = t.__transition,
                        a = !0;
                    if (o) {
                        for (r in e = null == e ? null : e + "", o)(n = o[r]).name === e ? (i = n.state > kt && n.state < zt, n.state = Ct, n.timer.stop(), i && n.on.call("interrupt", t, t.__data__, n.index, n.group), delete o[r]) : a = !1;
                        a && delete t.__transition
                    }
                }(this, t)
            })
        }, X.prototype.transition = function(t) {
            var e, n;
            t = t instanceof Ke ? (e = t._id, t._name) : (e = tn(), (n = nn).time = ht(), null == t ? null : t + "");
            for (var i = this._groups, r = i.length, o = 0; o < r; ++o)
                for (var a, s = i[o], l = s.length, u = 0; u < l; ++u)(a = s[u]) && At(a, t, e, u, s, n || rn(a, e));
            return new Ke(i, this._parents, t, e)
        };
        var an, sn, ln = (1 === (an = on).length && (sn = an, an = function(t, e) { return on(sn(t), e) }), {
            left: function(t, e, n, i) {
                for (null == n && (n = 0), null == i && (i = t.length); n < i;) {
                    var r = n + i >>> 1;
                    an(t[r], e) < 0 ? n = r + 1 : i = r
                }
                return n
            },
            right: function(t, e, n, i) {
                for (null == n && (n = 0), null == i && (i = t.length); n < i;) {
                    var r = n + i >>> 1;
                    0 < an(t[r], e) ? i = r : n = r + 1
                }
                return n
            }
        }).right;
        var un = Math.sqrt(50),
            cn = Math.sqrt(10),
            hn = Math.sqrt(2);

        function fn(t, e, n) {
            var i, r, o, a, s = -1;
            if (n = +n, (t = +t) === (e = +e) && 0 < n) return [t];
            if ((i = e < t) && (r = t, t = e, e = r), 0 === (a = _n(t, e, n)) || !isFinite(a)) return [];
            if (0 < a)
                for (t = Math.ceil(t / a), e = Math.floor(e / a), o = new Array(r = Math.ceil(e - t + 1)); ++s < r;) o[s] = (t + s) * a;
            else
                for (t = Math.floor(t * a), e = Math.ceil(e * a), o = new Array(r = Math.ceil(t - e + 1)); ++s < r;) o[s] = (t - s) / a;
            return i && o.reverse(), o
        }

        function _n(t, e, n) {
            var i = (e - t) / Math.max(0, n),
                r = Math.floor(Math.log(i) / Math.LN10),
                o = i / Math.pow(10, r);
            return 0 <= r ? (un <= o ? 10 : cn <= o ? 5 : hn <= o ? 2 : 1) * Math.pow(10, r) : -Math.pow(10, -r) / (un <= o ? 10 : cn <= o ? 5 : hn <= o ? 2 : 1)
        }

        function dn(t, e, n) {
            var i = Math.abs(e - t) / Math.max(0, n),
                r = Math.pow(10, Math.floor(Math.log(i) / Math.LN10)),
                o = i / r;
            return un <= o ? r *= 10 : cn <= o ? r *= 5 : hn <= o && (r *= 2), e < t ? -r : r
        }

        function pn(t, e) {
            var n, i, r = t.length,
                o = -1;
            if (null == e) {
                for (; ++o < r;)
                    if (null != (n = t[o]) && n <= n)
                        for (i = n; ++o < r;) null != (n = t[o]) && i < n && (i = n)
            } else
                for (; ++o < r;)
                    if (null != (n = e(t[o], o, t)) && n <= n)
                        for (i = n; ++o < r;) null != (n = e(t[o], o, t)) && i < n && (i = n);
            return i
        }

        function gn(t, e) {
            var n, i, r = t.length,
                o = -1;
            if (null == e) {
                for (; ++o < r;)
                    if (null != (n = t[o]) && n <= n)
                        for (i = n; ++o < r;) null != (n = t[o]) && n < i && (i = n)
            } else
                for (; ++o < r;)
                    if (null != (n = e(t[o], o, t)) && n <= n)
                        for (i = n; ++o < r;) null != (n = e(t[o], o, t)) && n < i && (i = n);
            return i
        }
        var yn = Math.PI,
            mn = 2 * yn,
            vn = 1e-6,
            xn = mn - vn;

        function bn() { this._x0 = this._y0 = this._x1 = this._y1 = null, this._ = "" }

        function wn() { return new bn }

        function kn(t) { return function() { return t } } bn.prototype = wn.prototype = {
            constructor: bn,
            moveTo: function(t, e) { this._ += "M" + (this._x0 = this._x1 = +t) + "," + (this._y0 = this._y1 = +e) },
            closePath: function() { null !== this._x1 && (this._x1 = this._x0, this._y1 = this._y0, this._ += "Z") },
            lineTo: function(t, e) { this._ += "L" + (this._x1 = +t) + "," + (this._y1 = +e) },
            quadraticCurveTo: function(t, e, n, i) { this._ += "Q" + +t + "," + +e + "," + (this._x1 = +n) + "," + (this._y1 = +i) },
            bezierCurveTo: function(t, e, n, i, r, o) { this._ += "C" + +t + "," + +e + "," + +n + "," + +i + "," + (this._x1 = +r) + "," + (this._y1 = +o) },
            arcTo: function(t, e, n, i, r) {
                t = +t, e = +e, n = +n, i = +i, r = +r;
                var o = this._x1,
                    a = this._y1,
                    s = n - t,
                    l = i - e,
                    u = o - t,
                    c = a - e,
                    h = u * u + c * c;
                if (r < 0) throw new Error("negative radius: " + r);
                if (null === this._x1) this._ += "M" + (this._x1 = t) + "," + (this._y1 = e);
                else if (vn < h)
                    if (Math.abs(c * s - l * u) > vn && r) {
                        var f = n - o,
                            _ = i - a,
                            d = s * s + l * l,
                            p = f * f + _ * _,
                            g = Math.sqrt(d),
                            y = Math.sqrt(h),
                            m = r * Math.tan((yn - Math.acos((d + h - p) / (2 * g * y))) / 2),
                            v = m / y,
                            x = m / g;
                        Math.abs(v - 1) > vn && (this._ += "L" + (t + v * u) + "," + (e + v * c)), this._ += "A" + r + "," + r + ",0,0," + +(u * _ < c * f) + "," + (this._x1 = t + x * s) + "," + (this._y1 = e + x * l)
                    } else this._ += "L" + (this._x1 = t) + "," + (this._y1 = e);
                else;
            },
            arc: function(t, e, n, i, r, o) {
                t = +t, e = +e;
                var a = (n = +n) * Math.cos(i),
                    s = n * Math.sin(i),
                    l = t + a,
                    u = e + s,
                    c = 1 ^ o,
                    h = o ? i - r : r - i;
                if (n < 0) throw new Error("negative radius: " + n);
                null === this._x1 ? this._ += "M" + l + "," + u : (Math.abs(this._x1 - l) > vn || Math.abs(this._y1 - u) > vn) && (this._ += "L" + l + "," + u), n && (h < 0 && (h = h % mn + mn), xn < h ? this._ += "A" + n + "," + n + ",0,1," + c + "," + (t - a) + "," + (e - s) + "A" + n + "," + n + ",0,1," + c + "," + (this._x1 = l) + "," + (this._y1 = u) : vn < h && (this._ += "A" + n + "," + n + ",0," + +(yn <= h) + "," + c + "," + (this._x1 = t + n * Math.cos(r)) + "," + (this._y1 = e + n * Math.sin(r))))
            },
            rect: function(t, e, n, i) { this._ += "M" + (this._x0 = this._x1 = +t) + "," + (this._y0 = this._y1 = +e) + "h" + +n + "v" + +i + "h" + -n + "Z" },
            toString: function() { return this._ }
        };
        var Mn = Math.abs,
            Tn = Math.atan2,
            zn = Math.cos,
            Cn = Math.max,
            An = Math.min,
            Nn = Math.sin,
            Sn = Math.sqrt,
            En = 1e-12,
            Fn = Math.PI,
            Ln = Fn / 2,
            Pn = 2 * Fn;

        function Dn(t) { return 1 <= t ? Ln : t <= -1 ? -Ln : Math.asin(t) }

        function On(t) { return t.innerRadius }

        function Un(t) { return t.outerRadius }

        function Hn(t) { return t.startAngle }

        function Rn(t) { return t.endAngle }

        function Yn(t) { return t && t.padAngle }

        function qn(t, e, n, i, r, o, a) {
            var s = t - n,
                l = e - i,
                u = (a ? o : -o) / Sn(s * s + l * l),
                c = u * l,
                h = -u * s,
                f = t + c,
                _ = e + h,
                d = n + c,
                p = i + h,
                g = (f + d) / 2,
                y = (_ + p) / 2,
                m = d - f,
                v = p - _,
                x = m * m + v * v,
                b = r - o,
                w = f * p - d * _,
                k = (v < 0 ? -1 : 1) * Sn(Cn(0, b * b * x - w * w)),
                M = (w * v - m * k) / x,
                T = (-w * m - v * k) / x,
                z = (w * v + m * k) / x,
                C = (-w * m + v * k) / x,
                A = M - g,
                N = T - y,
                S = z - g,
                E = C - y;
            return S * S + E * E < A * A + N * N && (M = z, T = C), { cx: M, cy: T, x01: -c, y01: -h, x11: M * (r / b - 1), y11: T * (r / b - 1) }
        }

        function jn(t) { this._context = t }

        function Bn(t) { return new jn(t) }

        function In(t) { return t[0] }

        function Xn(t) { return t[1] }

        function Vn() {
            var a = In,
                s = Xn,
                l = kn(!0),
                u = null,
                c = Bn,
                h = null;

            function e(t) {
                var e, n, i, r = t.length,
                    o = !1;
                for (null == u && (h = c(i = wn())), e = 0; e <= r; ++e) !(e < r && l(n = t[e], e, t)) === o && ((o = !o) ? h.lineStart() : h.lineEnd()), o && h.point(+a(n, e, t), +s(n, e, t));
                if (i) return h = null, i + "" || null
            }
            return e.x = function(t) { return arguments.length ? (a = "function" == typeof t ? t : kn(+t), e) : a }, e.y = function(t) { return arguments.length ? (s = "function" == typeof t ? t : kn(+t), e) : s }, e.defined = function(t) { return arguments.length ? (l = "function" == typeof t ? t : kn(!!t), e) : l }, e.curve = function(t) { return arguments.length ? (c = t, null != u && (h = c(u)), e) : c }, e.context = function(t) { return arguments.length ? (null == t ? u = h = null : h = c(u = t), e) : u }, e
        }

        function Wn() {
            var c = In,
                h = null,
                f = kn(0),
                _ = Xn,
                d = kn(!0),
                p = null,
                g = Bn,
                y = null;

            function e(t) {
                var e, n, i, r, o, a = t.length,
                    s = !1,
                    l = new Array(a),
                    u = new Array(a);
                for (null == p && (y = g(o = wn())), e = 0; e <= a; ++e) {
                    if (!(e < a && d(r = t[e], e, t)) === s)
                        if (s = !s) n = e, y.areaStart(), y.lineStart();
                        else {
                            for (y.lineEnd(), y.lineStart(), i = e - 1; n <= i; --i) y.point(l[i], u[i]);
                            y.lineEnd(), y.areaEnd()
                        } s && (l[e] = +c(r, e, t), u[e] = +f(r, e, t), y.point(h ? +h(r, e, t) : l[e], _ ? +_(r, e, t) : u[e]))
                }
                if (o) return y = null, o + "" || null
            }

            function t() { return Vn().defined(d).curve(g).context(p) }
            return e.x = function(t) { return arguments.length ? (c = "function" == typeof t ? t : kn(+t), h = null, e) : c }, e.x0 = function(t) { return arguments.length ? (c = "function" == typeof t ? t : kn(+t), e) : c }, e.x1 = function(t) { return arguments.length ? (h = null == t ? null : "function" == typeof t ? t : kn(+t), e) : h }, e.y = function(t) { return arguments.length ? (f = "function" == typeof t ? t : kn(+t), _ = null, e) : f }, e.y0 = function(t) { return arguments.length ? (f = "function" == typeof t ? t : kn(+t), e) : f }, e.y1 = function(t) { return arguments.length ? (_ = null == t ? null : "function" == typeof t ? t : kn(+t), e) : _ }, e.lineX0 = e.lineY0 = function() { return t().x(c).y(f) }, e.lineY1 = function() { return t().x(c).y(_) }, e.lineX1 = function() { return t().x(h).y(f) }, e.defined = function(t) { return arguments.length ? (d = "function" == typeof t ? t : kn(!!t), e) : d }, e.curve = function(t) { return arguments.length ? (g = t, null != p && (y = g(p)), e) : g }, e.context = function(t) { return arguments.length ? (null == t ? p = y = null : y = g(p = t), e) : p }, e
        }

        function $n(t, e) { return e < t ? -1 : t < e ? 1 : t <= e ? 0 : NaN }

        function Zn(t) { return t } jn.prototype = {
            areaStart: function() { this._line = 0 },
            areaEnd: function() { this._line = NaN },
            lineStart: function() { this._point = 0 },
            lineEnd: function() {
                (this._line || 0 !== this._line && 1 === this._point) && this._context.closePath(), this._line = 1 - this._line
            },
            point: function(t, e) {
                switch (t = +t, e = +e, this._point) {
                    case 0:
                        this._point = 1, this._line ? this._context.lineTo(t, e) : this._context.moveTo(t, e);
                        break;
                    case 1:
                        this._point = 2;
                    default:
                        this._context.lineTo(t, e)
                }
            }
        };
        var Qn = Gn(Bn);

        function Jn(t) { this._curve = t }

        function Gn(e) {
            function t(t) { return new Jn(e(t)) }
            return t._curve = e, t
        }

        function Kn(t) { var e = t.curve; return t.angle = t.x, delete t.x, t.radius = t.y, delete t.y, t.curve = function(t) { return arguments.length ? e(Gn(t)) : e()._curve }, t }

        function ti() { return Kn(Vn().curve(Qn)) }

        function ei() {
            var t = Wn().curve(Qn),
                e = t.curve,
                n = t.lineX0,
                i = t.lineX1,
                r = t.lineY0,
                o = t.lineY1;
            return t.angle = t.x, delete t.x, t.startAngle = t.x0, delete t.x0, t.endAngle = t.x1, delete t.x1, t.radius = t.y, delete t.y, t.innerRadius = t.y0, delete t.y0, t.outerRadius = t.y1, delete t.y1, t.lineStartAngle = function() { return Kn(n()) }, delete t.lineX0, t.lineEndAngle = function() { return Kn(i()) }, delete t.lineX1, t.lineInnerRadius = function() { return Kn(r()) }, delete t.lineY0, t.lineOuterRadius = function() { return Kn(o()) }, delete t.lineY1, t.curve = function(t) { return arguments.length ? e(Gn(t)) : e()._curve }, t
        }

        function ni(t, e) { return [(e = +e) * Math.cos(t -= Math.PI / 2), e * Math.sin(t)] } Jn.prototype = { areaStart: function() { this._curve.areaStart() }, areaEnd: function() { this._curve.areaEnd() }, lineStart: function() { this._curve.lineStart() }, lineEnd: function() { this._curve.lineEnd() }, point: function(t, e) { this._curve.point(e * Math.sin(t), e * -Math.cos(t)) } };
        var ii = Array.prototype.slice;

        function ri(t) { return t.source }

        function oi(t) { return t.target }

        function ai(r) {
            var o = ri,
                a = oi,
                s = In,
                l = Xn,
                u = null;

            function e() {
                var t, e = ii.call(arguments),
                    n = o.apply(this, e),
                    i = a.apply(this, e);
                if (u || (u = t = wn()), r(u, +s.apply(this, (e[0] = n, e)), +l.apply(this, e), +s.apply(this, (e[0] = i, e)), +l.apply(this, e)), t) return u = null, t + "" || null
            }
            return e.source = function(t) { return arguments.length ? (o = t, e) : o }, e.target = function(t) { return arguments.length ? (a = t, e) : a }, e.x = function(t) { return arguments.length ? (s = "function" == typeof t ? t : kn(+t), e) : s }, e.y = function(t) { return arguments.length ? (l = "function" == typeof t ? t : kn(+t), e) : l }, e.context = function(t) { return arguments.length ? (u = null == t ? null : t, e) : u }, e
        }

        function si(t, e, n, i, r) { t.moveTo(e, n), t.bezierCurveTo(e = (e + i) / 2, n, e, r, i, r) }

        function li(t, e, n, i, r) { t.moveTo(e, n), t.bezierCurveTo(e, n = (n + r) / 2, i, n, i, r) }

        function ui(t, e, n, i, r) {
            var o = ni(e, n),
                a = ni(e, n = (n + r) / 2),
                s = ni(i, n),
                l = ni(i, r);
            t.moveTo(o[0], o[1]), t.bezierCurveTo(a[0], a[1], s[0], s[1], l[0], l[1])
        }
        var ci = {
                draw: function(t, e) {
                    var n = Math.sqrt(e / Fn);
                    t.moveTo(n, 0), t.arc(0, 0, n, 0, Pn)
                }
            },
            hi = {
                draw: function(t, e) {
                    var n = Math.sqrt(e / 5) / 2;
                    t.moveTo(-3 * n, -n), t.lineTo(-n, -n), t.lineTo(-n, -3 * n), t.lineTo(n, -3 * n), t.lineTo(n, -n), t.lineTo(3 * n, -n), t.lineTo(3 * n, n), t.lineTo(n, n), t.lineTo(n, 3 * n), t.lineTo(-n, 3 * n), t.lineTo(-n, n), t.lineTo(-3 * n, n), t.closePath()
                }
            },
            fi = Math.sqrt(1 / 3),
            _i = 2 * fi,
            di = {
                draw: function(t, e) {
                    var n = Math.sqrt(e / _i),
                        i = n * fi;
                    t.moveTo(0, -n), t.lineTo(i, 0), t.lineTo(0, n), t.lineTo(-i, 0), t.closePath()
                }
            },
            pi = Math.sin(Fn / 10) / Math.sin(7 * Fn / 10),
            gi = Math.sin(Pn / 10) * pi,
            yi = -Math.cos(Pn / 10) * pi,
            mi = {
                draw: function(t, e) {
                    var n = Math.sqrt(.8908130915292852 * e),
                        i = gi * n,
                        r = yi * n;
                    t.moveTo(0, -n), t.lineTo(i, r);
                    for (var o = 1; o < 5; ++o) {
                        var a = Pn * o / 5,
                            s = Math.cos(a),
                            l = Math.sin(a);
                        t.lineTo(l * n, -s * n), t.lineTo(s * i - l * r, l * i + s * r)
                    }
                    t.closePath()
                }
            },
            vi = {
                draw: function(t, e) {
                    var n = Math.sqrt(e),
                        i = -n / 2;
                    t.rect(i, i, n, n)
                }
            },
            xi = Math.sqrt(3),
            bi = {
                draw: function(t, e) {
                    var n = -Math.sqrt(e / (3 * xi));
                    t.moveTo(0, 2 * n), t.lineTo(-xi * n, -n), t.lineTo(xi * n, -n), t.closePath()
                }
            },
            wi = -.5,
            ki = Math.sqrt(3) / 2,
            Mi = 1 / Math.sqrt(12),
            Ti = 3 * (Mi / 2 + 1),
            zi = {
                draw: function(t, e) {
                    var n = Math.sqrt(e / Ti),
                        i = n / 2,
                        r = n * Mi,
                        o = i,
                        a = n * Mi + n,
                        s = -o,
                        l = a;
                    t.moveTo(i, r), t.lineTo(o, a), t.lineTo(s, l), t.lineTo(wi * i - ki * r, ki * i + wi * r), t.lineTo(wi * o - ki * a, ki * o + wi * a), t.lineTo(wi * s - ki * l, ki * s + wi * l), t.lineTo(wi * i + ki * r, wi * r - ki * i), t.lineTo(wi * o + ki * a, wi * a - ki * o), t.lineTo(wi * s + ki * l, wi * l - ki * s), t.closePath()
                }
            },
            Ci = [ci, hi, di, vi, mi, bi, zi];

        function Ai() {}

        function Ni(t, e, n) { t._context.bezierCurveTo((2 * t._x0 + t._x1) / 3, (2 * t._y0 + t._y1) / 3, (t._x0 + 2 * t._x1) / 3, (t._y0 + 2 * t._y1) / 3, (t._x0 + 4 * t._x1 + e) / 6, (t._y0 + 4 * t._y1 + n) / 6) }

        function Si(t) { this._context = t }

        function Ei(t) { this._context = t }

        function Fi(t) { this._context = t }

        function Li(t, e) { this._basis = new Si(t), this._beta = e } Si.prototype = {
            areaStart: function() { this._line = 0 },
            areaEnd: function() { this._line = NaN },
            lineStart: function() { this._x0 = this._x1 = this._y0 = this._y1 = NaN, this._point = 0 },
            lineEnd: function() {
                switch (this._point) {
                    case 3:
                        Ni(this, this._x1, this._y1);
                    case 2:
                        this._context.lineTo(this._x1, this._y1)
                }(this._line || 0 !== this._line && 1 === this._point) && this._context.closePath(), this._line = 1 - this._line
            },
            point: function(t, e) {
                switch (t = +t, e = +e, this._point) {
                    case 0:
                        this._point = 1, this._line ? this._context.lineTo(t, e) : this._context.moveTo(t, e);
                        break;
                    case 1:
                        this._point = 2;
                        break;
                    case 2:
                        this._point = 3, this._context.lineTo((5 * this._x0 + this._x1) / 6, (5 * this._y0 + this._y1) / 6);
                    default:
                        Ni(this, t, e)
                }
                this._x0 = this._x1, this._x1 = t, this._y0 = this._y1, this._y1 = e
            }
        }, Ei.prototype = {
            areaStart: Ai,
            areaEnd: Ai,
            lineStart: function() { this._x0 = this._x1 = this._x2 = this._x3 = this._x4 = this._y0 = this._y1 = this._y2 = this._y3 = this._y4 = NaN, this._point = 0 },
            lineEnd: function() {
                switch (this._point) {
                    case 1:
                        this._context.moveTo(this._x2, this._y2), this._context.closePath();
                        break;
                    case 2:
                        this._context.moveTo((this._x2 + 2 * this._x3) / 3, (this._y2 + 2 * this._y3) / 3), this._context.lineTo((this._x3 + 2 * this._x2) / 3, (this._y3 + 2 * this._y2) / 3), this._context.closePath();
                        break;
                    case 3:
                        this.point(this._x2, this._y2), this.point(this._x3, this._y3), this.point(this._x4, this._y4)
                }
            },
            point: function(t, e) {
                switch (t = +t, e = +e, this._point) {
                    case 0:
                        this._point = 1, this._x2 = t, this._y2 = e;
                        break;
                    case 1:
                        this._point = 2, this._x3 = t, this._y3 = e;
                        break;
                    case 2:
                        this._point = 3, this._x4 = t, this._y4 = e, this._context.moveTo((this._x0 + 4 * this._x1 + t) / 6, (this._y0 + 4 * this._y1 + e) / 6);
                        break;
                    default:
                        Ni(this, t, e)
                }
                this._x0 = this._x1, this._x1 = t, this._y0 = this._y1, this._y1 = e
            }
        }, Fi.prototype = {
            areaStart: function() { this._line = 0 },
            areaEnd: function() { this._line = NaN },
            lineStart: function() { this._x0 = this._x1 = this._y0 = this._y1 = NaN, this._point = 0 },
            lineEnd: function() {
                (this._line || 0 !== this._line && 3 === this._point) && this._context.closePath(), this._line = 1 - this._line
            },
            point: function(t, e) {
                switch (t = +t, e = +e, this._point) {
                    case 0:
                        this._point = 1;
                        break;
                    case 1:
                        this._point = 2;
                        break;
                    case 2:
                        this._point = 3;
                        var n = (this._x0 + 4 * this._x1 + t) / 6,
                            i = (this._y0 + 4 * this._y1 + e) / 6;
                        this._line ? this._context.lineTo(n, i) : this._context.moveTo(n, i);
                        break;
                    case 3:
                        this._point = 4;
                    default:
                        Ni(this, t, e)
                }
                this._x0 = this._x1, this._x1 = t, this._y0 = this._y1, this._y1 = e
            }
        }, Li.prototype = {
            lineStart: function() { this._x = [], this._y = [], this._basis.lineStart() },
            lineEnd: function() {
                var t = this._x,
                    e = this._y,
                    n = t.length - 1;
                if (0 < n)
                    for (var i, r = t[0], o = e[0], a = t[n] - r, s = e[n] - o, l = -1; ++l <= n;) i = l / n, this._basis.point(this._beta * t[l] + (1 - this._beta) * (r + i * a), this._beta * e[l] + (1 - this._beta) * (o + i * s));
                this._x = this._y = null, this._basis.lineEnd()
            },
            point: function(t, e) { this._x.push(+t), this._y.push(+e) }
        };
        var Pi = function e(n) {
            function t(t) { return 1 === n ? new Si(t) : new Li(t, n) }
            return t.beta = function(t) { return e(+t) }, t
        }(.85);

        function Di(t, e, n) { t._context.bezierCurveTo(t._x1 + t._k * (t._x2 - t._x0), t._y1 + t._k * (t._y2 - t._y0), t._x2 + t._k * (t._x1 - e), t._y2 + t._k * (t._y1 - n), t._x2, t._y2) }

        function Oi(t, e) { this._context = t, this._k = (1 - e) / 6 } Oi.prototype = {
            areaStart: function() { this._line = 0 },
            areaEnd: function() { this._line = NaN },
            lineStart: function() { this._x0 = this._x1 = this._x2 = this._y0 = this._y1 = this._y2 = NaN, this._point = 0 },
            lineEnd: function() {
                switch (this._point) {
                    case 2:
                        this._context.lineTo(this._x2, this._y2);
                        break;
                    case 3:
                        Di(this, this._x1, this._y1)
                }(this._line || 0 !== this._line && 1 === this._point) && this._context.closePath(), this._line = 1 - this._line
            },
            point: function(t, e) {
                switch (t = +t, e = +e, this._point) {
                    case 0:
                        this._point = 1, this._line ? this._context.lineTo(t, e) : this._context.moveTo(t, e);
                        break;
                    case 1:
                        this._point = 2, this._x1 = t, this._y1 = e;
                        break;
                    case 2:
                        this._point = 3;
                    default:
                        Di(this, t, e)
                }
                this._x0 = this._x1, this._x1 = this._x2, this._x2 = t, this._y0 = this._y1, this._y1 = this._y2, this._y2 = e
            }
        };
        var Ui = function e(n) {
            function t(t) { return new Oi(t, n) }
            return t.tension = function(t) { return e(+t) }, t
        }(0);

        function Hi(t, e) { this._context = t, this._k = (1 - e) / 6 } Hi.prototype = {
            areaStart: Ai,
            areaEnd: Ai,
            lineStart: function() { this._x0 = this._x1 = this._x2 = this._x3 = this._x4 = this._x5 = this._y0 = this._y1 = this._y2 = this._y3 = this._y4 = this._y5 = NaN, this._point = 0 },
            lineEnd: function() {
                switch (this._point) {
                    case 1:
                        this._context.moveTo(this._x3, this._y3), this._context.closePath();
                        break;
                    case 2:
                        this._context.lineTo(this._x3, this._y3), this._context.closePath();
                        break;
                    case 3:
                        this.point(this._x3, this._y3), this.point(this._x4, this._y4), this.point(this._x5, this._y5)
                }
            },
            point: function(t, e) {
                switch (t = +t, e = +e, this._point) {
                    case 0:
                        this._point = 1, this._x3 = t, this._y3 = e;
                        break;
                    case 1:
                        this._point = 2, this._context.moveTo(this._x4 = t, this._y4 = e);
                        break;
                    case 2:
                        this._point = 3, this._x5 = t, this._y5 = e;
                        break;
                    default:
                        Di(this, t, e)
                }
                this._x0 = this._x1, this._x1 = this._x2, this._x2 = t, this._y0 = this._y1, this._y1 = this._y2, this._y2 = e
            }
        };
        var Ri = function e(n) {
            function t(t) { return new Hi(t, n) }
            return t.tension = function(t) { return e(+t) }, t
        }(0);

        function Yi(t, e) { this._context = t, this._k = (1 - e) / 6 } Yi.prototype = {
            areaStart: function() { this._line = 0 },
            areaEnd: function() { this._line = NaN },
            lineStart: function() { this._x0 = this._x1 = this._x2 = this._y0 = this._y1 = this._y2 = NaN, this._point = 0 },
            lineEnd: function() {
                (this._line || 0 !== this._line && 3 === this._point) && this._context.closePath(), this._line = 1 - this._line
            },
            point: function(t, e) {
                switch (t = +t, e = +e, this._point) {
                    case 0:
                        this._point = 1;
                        break;
                    case 1:
                        this._point = 2;
                        break;
                    case 2:
                        this._point = 3, this._line ? this._context.lineTo(this._x2, this._y2) : this._context.moveTo(this._x2, this._y2);
                        break;
                    case 3:
                        this._point = 4;
                    default:
                        Di(this, t, e)
                }
                this._x0 = this._x1, this._x1 = this._x2, this._x2 = t, this._y0 = this._y1, this._y1 = this._y2, this._y2 = e
            }
        };
        var qi = function e(n) {
            function t(t) { return new Yi(t, n) }
            return t.tension = function(t) { return e(+t) }, t
        }(0);

        function ji(t, e, n) {
            var i = t._x1,
                r = t._y1,
                o = t._x2,
                a = t._y2;
            if (t._l01_a > En) {
                var s = 2 * t._l01_2a + 3 * t._l01_a * t._l12_a + t._l12_2a,
                    l = 3 * t._l01_a * (t._l01_a + t._l12_a);
                i = (i * s - t._x0 * t._l12_2a + t._x2 * t._l01_2a) / l, r = (r * s - t._y0 * t._l12_2a + t._y2 * t._l01_2a) / l
            }
            if (t._l23_a > En) {
                var u = 2 * t._l23_2a + 3 * t._l23_a * t._l12_a + t._l12_2a,
                    c = 3 * t._l23_a * (t._l23_a + t._l12_a);
                o = (o * u + t._x1 * t._l23_2a - e * t._l12_2a) / c, a = (a * u + t._y1 * t._l23_2a - n * t._l12_2a) / c
            }
            t._context.bezierCurveTo(i, r, o, a, t._x2, t._y2)
        }

        function Bi(t, e) { this._context = t, this._alpha = e } Bi.prototype = {
            areaStart: function() { this._line = 0 },
            areaEnd: function() { this._line = NaN },
            lineStart: function() { this._x0 = this._x1 = this._x2 = this._y0 = this._y1 = this._y2 = NaN, this._l01_a = this._l12_a = this._l23_a = this._l01_2a = this._l12_2a = this._l23_2a = this._point = 0 },
            lineEnd: function() {
                switch (this._point) {
                    case 2:
                        this._context.lineTo(this._x2, this._y2);
                        break;
                    case 3:
                        this.point(this._x2, this._y2)
                }(this._line || 0 !== this._line && 1 === this._point) && this._context.closePath(), this._line = 1 - this._line
            },
            point: function(t, e) {
                if (t = +t, e = +e, this._point) {
                    var n = this._x2 - t,
                        i = this._y2 - e;
                    this._l23_a = Math.sqrt(this._l23_2a = Math.pow(n * n + i * i, this._alpha))
                }
                switch (this._point) {
                    case 0:
                        this._point = 1, this._line ? this._context.lineTo(t, e) : this._context.moveTo(t, e);
                        break;
                    case 1:
                        this._point = 2;
                        break;
                    case 2:
                        this._point = 3;
                    default:
                        ji(this, t, e)
                }
                this._l01_a = this._l12_a, this._l12_a = this._l23_a, this._l01_2a = this._l12_2a, this._l12_2a = this._l23_2a, this._x0 = this._x1, this._x1 = this._x2, this._x2 = t, this._y0 = this._y1, this._y1 = this._y2, this._y2 = e
            }
        };
        var Ii = function e(n) {
            function t(t) { return n ? new Bi(t, n) : new Oi(t, 0) }
            return t.alpha = function(t) { return e(+t) }, t
        }(.5);

        function Xi(t, e) { this._context = t, this._alpha = e } Xi.prototype = {
            areaStart: Ai,
            areaEnd: Ai,
            lineStart: function() { this._x0 = this._x1 = this._x2 = this._x3 = this._x4 = this._x5 = this._y0 = this._y1 = this._y2 = this._y3 = this._y4 = this._y5 = NaN, this._l01_a = this._l12_a = this._l23_a = this._l01_2a = this._l12_2a = this._l23_2a = this._point = 0 },
            lineEnd: function() {
                switch (this._point) {
                    case 1:
                        this._context.moveTo(this._x3, this._y3), this._context.closePath();
                        break;
                    case 2:
                        this._context.lineTo(this._x3, this._y3), this._context.closePath();
                        break;
                    case 3:
                        this.point(this._x3, this._y3), this.point(this._x4, this._y4), this.point(this._x5, this._y5)
                }
            },
            point: function(t, e) {
                if (t = +t, e = +e, this._point) {
                    var n = this._x2 - t,
                        i = this._y2 - e;
                    this._l23_a = Math.sqrt(this._l23_2a = Math.pow(n * n + i * i, this._alpha))
                }
                switch (this._point) {
                    case 0:
                        this._point = 1, this._x3 = t, this._y3 = e;
                        break;
                    case 1:
                        this._point = 2, this._context.moveTo(this._x4 = t, this._y4 = e);
                        break;
                    case 2:
                        this._point = 3, this._x5 = t, this._y5 = e;
                        break;
                    default:
                        ji(this, t, e)
                }
                this._l01_a = this._l12_a, this._l12_a = this._l23_a, this._l01_2a = this._l12_2a, this._l12_2a = this._l23_2a, this._x0 = this._x1, this._x1 = this._x2, this._x2 = t, this._y0 = this._y1, this._y1 = this._y2, this._y2 = e
            }
        };
        var Vi = function e(n) {
            function t(t) { return n ? new Xi(t, n) : new Hi(t, 0) }
            return t.alpha = function(t) { return e(+t) }, t
        }(.5);

        function Wi(t, e) { this._context = t, this._alpha = e } Wi.prototype = {
            areaStart: function() { this._line = 0 },
            areaEnd: function() { this._line = NaN },
            lineStart: function() { this._x0 = this._x1 = this._x2 = this._y0 = this._y1 = this._y2 = NaN, this._l01_a = this._l12_a = this._l23_a = this._l01_2a = this._l12_2a = this._l23_2a = this._point = 0 },
            lineEnd: function() {
                (this._line || 0 !== this._line && 3 === this._point) && this._context.closePath(), this._line = 1 - this._line
            },
            point: function(t, e) {
                if (t = +t, e = +e, this._point) {
                    var n = this._x2 - t,
                        i = this._y2 - e;
                    this._l23_a = Math.sqrt(this._l23_2a = Math.pow(n * n + i * i, this._alpha))
                }
                switch (this._point) {
                    case 0:
                        this._point = 1;
                        break;
                    case 1:
                        this._point = 2;
                        break;
                    case 2:
                        this._point = 3, this._line ? this._context.lineTo(this._x2, this._y2) : this._context.moveTo(this._x2, this._y2);
                        break;
                    case 3:
                        this._point = 4;
                    default:
                        ji(this, t, e)
                }
                this._l01_a = this._l12_a, this._l12_a = this._l23_a, this._l01_2a = this._l12_2a, this._l12_2a = this._l23_2a, this._x0 = this._x1, this._x1 = this._x2, this._x2 = t, this._y0 = this._y1, this._y1 = this._y2, this._y2 = e
            }
        };
        var $i = function e(n) {
            function t(t) { return n ? new Wi(t, n) : new Yi(t, 0) }
            return t.alpha = function(t) { return e(+t) }, t
        }(.5);

        function Zi(t) { this._context = t }

        function Qi(t) { return t < 0 ? -1 : 1 }

        function Ji(t, e, n) {
            var i = t._x1 - t._x0,
                r = e - t._x1,
                o = (t._y1 - t._y0) / (i || r < 0 && -0),
                a = (n - t._y1) / (r || i < 0 && -0),
                s = (o * r + a * i) / (i + r);
            return (Qi(o) + Qi(a)) * Math.min(Math.abs(o), Math.abs(a), .5 * Math.abs(s)) || 0
        }

        function Gi(t, e) { var n = t._x1 - t._x0; return n ? (3 * (t._y1 - t._y0) / n - e) / 2 : e }

        function Ki(t, e, n) {
            var i = t._x0,
                r = t._y0,
                o = t._x1,
                a = t._y1,
                s = (o - i) / 3;
            t._context.bezierCurveTo(i + s, r + s * e, o - s, a - s * n, o, a)
        }

        function tr(t) { this._context = t }

        function er(t) { this._context = new nr(t) }

        function nr(t) { this._context = t }

        function ir(t) { this._context = t }

        function rr(t) {
            var e, n, i = t.length - 1,
                r = new Array(i),
                o = new Array(i),
                a = new Array(i);
            for (o[r[0] = 0] = 2, a[0] = t[0] + 2 * t[1], e = 1; e < i - 1; ++e) r[e] = 1, o[e] = 4, a[e] = 4 * t[e] + 2 * t[e + 1];
            for (r[i - 1] = 2, o[i - 1] = 7, a[i - 1] = 8 * t[i - 1] + t[i], e = 1; e < i; ++e) n = r[e] / o[e - 1], o[e] -= n, a[e] -= n * a[e - 1];
            for (r[i - 1] = a[i - 1] / o[i - 1], e = i - 2; 0 <= e; --e) r[e] = (a[e] - r[e + 1]) / o[e];
            for (o[i - 1] = (t[i] + r[i - 1]) / 2, e = 0; e < i - 1; ++e) o[e] = 2 * t[e + 1] - r[e + 1];
            return [r, o]
        }

        function or(t, e) { this._context = t, this._t = e }

        function ar(t, e) {
            if (1 < (r = t.length))
                for (var n, i, r, o = 1, a = t[e[0]], s = a.length; o < r; ++o)
                    for (i = a, a = t[e[o]], n = 0; n < s; ++n) a[n][1] += a[n][0] = isNaN(i[n][1]) ? i[n][0] : i[n][1]
        }

        function sr(t) { for (var e = t.length, n = new Array(e); 0 <= --e;) n[e] = e; return n }

        function lr(t, e) { return t[e] }

        function ur(t) { var n = t.map(cr); return sr(t).sort(function(t, e) { return n[t] - n[e] }) }

        function cr(t) { for (var e, n = 0, i = -1, r = t.length; ++i < r;)(e = +t[i][1]) && (n += e); return n } Zi.prototype = { areaStart: Ai, areaEnd: Ai, lineStart: function() { this._point = 0 }, lineEnd: function() { this._point && this._context.closePath() }, point: function(t, e) { t = +t, e = +e, this._point ? this._context.lineTo(t, e) : (this._point = 1, this._context.moveTo(t, e)) } }, tr.prototype = {
            areaStart: function() { this._line = 0 },
            areaEnd: function() { this._line = NaN },
            lineStart: function() { this._x0 = this._x1 = this._y0 = this._y1 = this._t0 = NaN, this._point = 0 },
            lineEnd: function() {
                switch (this._point) {
                    case 2:
                        this._context.lineTo(this._x1, this._y1);
                        break;
                    case 3:
                        Ki(this, this._t0, Gi(this, this._t0))
                }(this._line || 0 !== this._line && 1 === this._point) && this._context.closePath(), this._line = 1 - this._line
            },
            point: function(t, e) {
                var n = NaN;
                if (e = +e, (t = +t) !== this._x1 || e !== this._y1) {
                    switch (this._point) {
                        case 0:
                            this._point = 1, this._line ? this._context.lineTo(t, e) : this._context.moveTo(t, e);
                            break;
                        case 1:
                            this._point = 2;
                            break;
                        case 2:
                            this._point = 3, Ki(this, Gi(this, n = Ji(this, t, e)), n);
                            break;
                        default:
                            Ki(this, this._t0, n = Ji(this, t, e))
                    }
                    this._x0 = this._x1, this._x1 = t, this._y0 = this._y1, this._y1 = e, this._t0 = n
                }
            }
        }, (er.prototype = Object.create(tr.prototype)).point = function(t, e) { tr.prototype.point.call(this, e, t) }, nr.prototype = { moveTo: function(t, e) { this._context.moveTo(e, t) }, closePath: function() { this._context.closePath() }, lineTo: function(t, e) { this._context.lineTo(e, t) }, bezierCurveTo: function(t, e, n, i, r, o) { this._context.bezierCurveTo(e, t, i, n, o, r) } }, ir.prototype = {
            areaStart: function() { this._line = 0 },
            areaEnd: function() { this._line = NaN },
            lineStart: function() { this._x = [], this._y = [] },
            lineEnd: function() {
                var t = this._x,
                    e = this._y,
                    n = t.length;
                if (n)
                    if (this._line ? this._context.lineTo(t[0], e[0]) : this._context.moveTo(t[0], e[0]), 2 === n) this._context.lineTo(t[1], e[1]);
                    else
                        for (var i = rr(t), r = rr(e), o = 0, a = 1; a < n; ++o, ++a) this._context.bezierCurveTo(i[0][o], r[0][o], i[1][o], r[1][o], t[a], e[a]);
                (this._line || 0 !== this._line && 1 === n) && this._context.closePath(), this._line = 1 - this._line, this._x = this._y = null
            },
            point: function(t, e) { this._x.push(+t), this._y.push(+e) }
        }, or.prototype = {
            areaStart: function() { this._line = 0 },
            areaEnd: function() { this._line = NaN },
            lineStart: function() { this._x = this._y = NaN, this._point = 0 },
            lineEnd: function() { 0 < this._t && this._t < 1 && 2 === this._point && this._context.lineTo(this._x, this._y), (this._line || 0 !== this._line && 1 === this._point) && this._context.closePath(), 0 <= this._line && (this._t = 1 - this._t, this._line = 1 - this._line) },
            point: function(t, e) {
                switch (t = +t, e = +e, this._point) {
                    case 0:
                        this._point = 1, this._line ? this._context.lineTo(t, e) : this._context.moveTo(t, e);
                        break;
                    case 1:
                        this._point = 2;
                    default:
                        if (this._t <= 0) this._context.lineTo(this._x, e), this._context.lineTo(t, e);
                        else {
                            var n = this._x * (1 - this._t) + t * this._t;
                            this._context.lineTo(n, this._y), this._context.lineTo(n, e)
                        }
                }
                this._x = t, this._y = e
            }
        };
        var hr = Object.freeze({
                arc: function() {
                    var $ = On,
                        Z = Un,
                        Q = kn(0),
                        J = null,
                        G = Hn,
                        K = Rn,
                        tt = Yn,
                        et = null;

                    function e() {
                        var t, e, n, i, r, o, a, s, l, u, c, h, f = +$.apply(this, arguments),
                            _ = +Z.apply(this, arguments),
                            d = G.apply(this, arguments) - Ln,
                            p = K.apply(this, arguments) - Ln,
                            g = Mn(p - d),
                            y = d < p;
                        if (et || (et = t = wn()), _ < f && (e = _, _ = f, f = e), En < _)
                            if (Pn - En < g) et.moveTo(_ * zn(d), _ * Nn(d)), et.arc(0, 0, _, d, p, !y), En < f && (et.moveTo(f * zn(p), f * Nn(p)), et.arc(0, 0, f, p, d, y));
                            else {
                                var m, v, x = d,
                                    b = p,
                                    w = d,
                                    k = p,
                                    M = g,
                                    T = g,
                                    z = tt.apply(this, arguments) / 2,
                                    C = En < z && (J ? +J.apply(this, arguments) : Sn(f * f + _ * _)),
                                    A = An(Mn(_ - f) / 2, +Q.apply(this, arguments)),
                                    N = A,
                                    S = A;
                                if (En < C) {
                                    var E = Dn(C / f * Nn(z)),
                                        F = Dn(C / _ * Nn(z));
                                    (M -= 2 * E) > En ? (w += E *= y ? 1 : -1, k -= E) : (M = 0, w = k = (d + p) / 2), (T -= 2 * F) > En ? (x += F *= y ? 1 : -1, b -= F) : (T = 0, x = b = (d + p) / 2)
                                }
                                var L = _ * zn(x),
                                    P = _ * Nn(x),
                                    D = f * zn(k),
                                    O = f * Nn(k);
                                if (En < A) {
                                    var U = _ * zn(b),
                                        H = _ * Nn(b),
                                        R = f * zn(w),
                                        Y = f * Nn(w);
                                    if (g < Fn) {
                                        var q = En < M ? [(i = L) + (h = ((u = D - (o = U)) * ((r = P) - (a = H)) - (c = O - a) * (i - o)) / (c * (s = R - i) - u * (l = Y - r))) * s, r + h * l] : [D, O],
                                            j = L - q[0],
                                            B = P - q[1],
                                            I = U - q[0],
                                            X = H - q[1],
                                            V = 1 / Nn((1 < (n = (j * I + B * X) / (Sn(j * j + B * B) * Sn(I * I + X * X))) ? 0 : n < -1 ? Fn : Math.acos(n)) / 2),
                                            W = Sn(q[0] * q[0] + q[1] * q[1]);
                                        N = An(A, (f - W) / (V - 1)), S = An(A, (_ - W) / (V + 1))
                                    }
                                }
                                En < T ? En < S ? (m = qn(R, Y, L, P, _, S, y), v = qn(U, H, D, O, _, S, y), et.moveTo(m.cx + m.x01, m.cy + m.y01), S < A ? et.arc(m.cx, m.cy, S, Tn(m.y01, m.x01), Tn(v.y01, v.x01), !y) : (et.arc(m.cx, m.cy, S, Tn(m.y01, m.x01), Tn(m.y11, m.x11), !y), et.arc(0, 0, _, Tn(m.cy + m.y11, m.cx + m.x11), Tn(v.cy + v.y11, v.cx + v.x11), !y), et.arc(v.cx, v.cy, S, Tn(v.y11, v.x11), Tn(v.y01, v.x01), !y))) : (et.moveTo(L, P), et.arc(0, 0, _, x, b, !y)) : et.moveTo(L, P), En < f && En < M ? En < N ? (m = qn(D, O, U, H, f, -N, y), v = qn(L, P, R, Y, f, -N, y), et.lineTo(m.cx + m.x01, m.cy + m.y01), N < A ? et.arc(m.cx, m.cy, N, Tn(m.y01, m.x01), Tn(v.y01, v.x01), !y) : (et.arc(m.cx, m.cy, N, Tn(m.y01, m.x01), Tn(m.y11, m.x11), !y), et.arc(0, 0, f, Tn(m.cy + m.y11, m.cx + m.x11), Tn(v.cy + v.y11, v.cx + v.x11), y), et.arc(v.cx, v.cy, N, Tn(v.y11, v.x11), Tn(v.y01, v.x01), !y))) : et.arc(0, 0, f, k, w, y) : et.lineTo(D, O)
                            }
                        else et.moveTo(0, 0);
                        if (et.closePath(), t) return et = null, t + "" || null
                    }
                    return e.centroid = function() {
                        var t = (+$.apply(this, arguments) + +Z.apply(this, arguments)) / 2,
                            e = (+G.apply(this, arguments) + +K.apply(this, arguments)) / 2 - Fn / 2;
                        return [zn(e) * t, Nn(e) * t]
                    }, e.innerRadius = function(t) { return arguments.length ? ($ = "function" == typeof t ? t : kn(+t), e) : $ }, e.outerRadius = function(t) { return arguments.length ? (Z = "function" == typeof t ? t : kn(+t), e) : Z }, e.cornerRadius = function(t) { return arguments.length ? (Q = "function" == typeof t ? t : kn(+t), e) : Q }, e.padRadius = function(t) { return arguments.length ? (J = null == t ? null : "function" == typeof t ? t : kn(+t), e) : J }, e.startAngle = function(t) { return arguments.length ? (G = "function" == typeof t ? t : kn(+t), e) : G }, e.endAngle = function(t) { return arguments.length ? (K = "function" == typeof t ? t : kn(+t), e) : K }, e.padAngle = function(t) { return arguments.length ? (tt = "function" == typeof t ? t : kn(+t), e) : tt }, e.context = function(t) { return arguments.length ? (et = null == t ? null : t, e) : et }, e
                },
                area: Wn,
                line: Vn,
                pie: function() {
                    var d = Zn,
                        p = $n,
                        g = null,
                        y = kn(0),
                        m = kn(Pn),
                        v = kn(0);

                    function e(n) {
                        var t, e, i, r, o, a = n.length,
                            s = 0,
                            l = new Array(a),
                            u = new Array(a),
                            c = +y.apply(this, arguments),
                            h = Math.min(Pn, Math.max(-Pn, m.apply(this, arguments) - c)),
                            f = Math.min(Math.abs(h) / a, v.apply(this, arguments)),
                            _ = f * (h < 0 ? -1 : 1);
                        for (t = 0; t < a; ++t) 0 < (o = u[l[t] = t] = +d(n[t], t, n)) && (s += o);
                        for (null != p ? l.sort(function(t, e) { return p(u[t], u[e]) }) : null != g && l.sort(function(t, e) { return g(n[t], n[e]) }), t = 0, i = s ? (h - a * _) / s : 0; t < a; ++t, c = r) e = l[t], r = c + (0 < (o = u[e]) ? o * i : 0) + _, u[e] = { data: n[e], index: t, value: o, startAngle: c, endAngle: r, padAngle: f };
                        return u
                    }
                    return e.value = function(t) { return arguments.length ? (d = "function" == typeof t ? t : kn(+t), e) : d }, e.sortValues = function(t) { return arguments.length ? (p = t, g = null, e) : p }, e.sort = function(t) { return arguments.length ? (g = t, p = null, e) : g }, e.startAngle = function(t) { return arguments.length ? (y = "function" == typeof t ? t : kn(+t), e) : y }, e.endAngle = function(t) { return arguments.length ? (m = "function" == typeof t ? t : kn(+t), e) : m }, e.padAngle = function(t) { return arguments.length ? (v = "function" == typeof t ? t : kn(+t), e) : v }, e
                },
                areaRadial: ei,
                radialArea: ei,
                lineRadial: ti,
                radialLine: ti,
                pointRadial: ni,
                linkHorizontal: function() { return ai(si) },
                linkVertical: function() { return ai(li) },
                linkRadial: function() { var t = ai(ui); return t.angle = t.x, delete t.x, t.radius = t.y, delete t.y, t },
                symbol: function() {
                    var e = kn(ci),
                        n = kn(64),
                        i = null;

                    function r() { var t; if (i || (i = t = wn()), e.apply(this, arguments).draw(i, +n.apply(this, arguments)), t) return i = null, t + "" || null }
                    return r.type = function(t) { return arguments.length ? (e = "function" == typeof t ? t : kn(t), r) : e }, r.size = function(t) { return arguments.length ? (n = "function" == typeof t ? t : kn(+t), r) : n }, r.context = function(t) { return arguments.length ? (i = null == t ? null : t, r) : i }, r
                },
                symbols: Ci,
                symbolCircle: ci,
                symbolCross: hi,
                symbolDiamond: di,
                symbolSquare: vi,
                symbolStar: mi,
                symbolTriangle: bi,
                symbolWye: zi,
                curveBasisClosed: function(t) { return new Ei(t) },
                curveBasisOpen: function(t) { return new Fi(t) },
                curveBasis: function(t) { return new Si(t) },
                curveBundle: Pi,
                curveCardinalClosed: Ri,
                curveCardinalOpen: qi,
                curveCardinal: Ui,
                curveCatmullRomClosed: Vi,
                curveCatmullRomOpen: $i,
                curveCatmullRom: Ii,
                curveLinearClosed: function(t) { return new Zi(t) },
                curveLinear: Bn,
                curveMonotoneX: function(t) { return new tr(t) },
                curveMonotoneY: function(t) { return new er(t) },
                curveNatural: function(t) { return new ir(t) },
                curveStep: function(t) { return new or(t, .5) },
                curveStepAfter: function(t) { return new or(t, 1) },
                curveStepBefore: function(t) { return new or(t, 0) },
                stack: function() {
                    var h = kn([]),
                        f = sr,
                        _ = ar,
                        d = lr;

                    function e(t) {
                        var e, n, i = h.apply(this, arguments),
                            r = t.length,
                            o = i.length,
                            a = new Array(o);
                        for (e = 0; e < o; ++e) {
                            for (var s, l = i[e], u = a[e] = new Array(r), c = 0; c < r; ++c) u[c] = s = [0, +d(t[c], l, c, t)], s.data = t[c];
                            u.key = l
                        }
                        for (e = 0, n = f(a); e < o; ++e) a[n[e]].index = e;
                        return _(a, n), a
                    }
                    return e.keys = function(t) { return arguments.length ? (h = "function" == typeof t ? t : kn(ii.call(t)), e) : h }, e.value = function(t) { return arguments.length ? (d = "function" == typeof t ? t : kn(+t), e) : d }, e.order = function(t) { return arguments.length ? (f = null == t ? sr : "function" == typeof t ? t : kn(ii.call(t)), e) : f }, e.offset = function(t) { return arguments.length ? (_ = null == t ? ar : t, e) : _ }, e
                },
                stackOffsetExpand: function(t, e) {
                    if (0 < (i = t.length)) {
                        for (var n, i, r, o = 0, a = t[0].length; o < a; ++o) {
                            for (r = n = 0; n < i; ++n) r += t[n][o][1] || 0;
                            if (r)
                                for (n = 0; n < i; ++n) t[n][o][1] /= r
                        }
                        ar(t, e)
                    }
                },
                stackOffsetDiverging: function(t, e) {
                    if (1 < (s = t.length))
                        for (var n, i, r, o, a, s, l = 0, u = t[e[0]].length; l < u; ++l)
                            for (o = a = 0, n = 0; n < s; ++n) 0 <= (r = (i = t[e[n]][l])[1] - i[0]) ? (i[0] = o, i[1] = o += r) : i[0] = r < 0 ? (i[1] = a, a += r) : o
                },
                stackOffsetNone: ar,
                stackOffsetSilhouette: function(t, e) {
                    if (0 < (n = t.length)) {
                        for (var n, i = 0, r = t[e[0]], o = r.length; i < o; ++i) {
                            for (var a = 0, s = 0; a < n; ++a) s += t[a][i][1] || 0;
                            r[i][1] += r[i][0] = -s / 2
                        }
                        ar(t, e)
                    }
                },
                stackOffsetWiggle: function(t, e) {
                    if (0 < (r = t.length) && 0 < (i = (n = t[e[0]]).length)) {
                        for (var n, i, r, o = 0, a = 1; a < i; ++a) {
                            for (var s = 0, l = 0, u = 0; s < r; ++s) {
                                for (var c = t[e[s]], h = c[a][1] || 0, f = (h - (c[a - 1][1] || 0)) / 2, _ = 0; _ < s; ++_) {
                                    var d = t[e[_]];
                                    f += (d[a][1] || 0) - (d[a - 1][1] || 0)
                                }
                                l += h, u += f * h
                            }
                            n[a - 1][1] += n[a - 1][0] = o, l && (o -= u / l)
                        }
                        n[a - 1][1] += n[a - 1][0] = o, ar(t, e)
                    }
                },
                stackOrderAscending: ur,
                stackOrderDescending: function(t) { return ur(t).reverse() },
                stackOrderInsideOut: function(t) {
                    var e, n, i = t.length,
                        r = t.map(cr),
                        o = sr(t).sort(function(t, e) { return r[e] - r[t] }),
                        a = 0,
                        s = 0,
                        l = [],
                        u = [];
                    for (e = 0; e < i; ++e) n = o[e], a < s ? (a += r[n], l.push(n)) : (s += r[n], u.push(n));
                    return u.reverse().concat(l)
                },
                stackOrderNone: sr,
                stackOrderReverse: function(t) { return sr(t).reverse() }
            }),
            fr = Object.freeze({ transform_labels: !1, transform: "multiply", multiply_divide_constant: 1, exponentiate_constant: 0, multiplier: 1, prefix: "", n_dec: 2, suffix: "", strip_zeros: !0, strip_separator: !0 });

        function _r(r, t) {
            var e, n, o = 0 <= r.n_dec ? Math.floor(r.n_dec) : Math.ceil(r.n_dec),
                a = t(",." + (0 < o ? o : "0") + "f"),
                i = t.decimal,
                s = t.thousands,
                l = r.strip_zeros && 0 < o ? new RegExp("\\" + i + "?0+$") : null,
                u = r.strip_separator && s,
                c = (n = 1, (e = r).transform_labels && (n = "multiply" === e.transform ? e.multiply_divide_constant : "divide" === e.transform ? 1 / e.multiply_divide_constant : Math.pow(10, e.exponentiate_constant)), function(t) { return t * n });
            return o < 0 ? function(t) {
                var e = function(t, e) {
                        if (!e) return Math.round(t);
                        e = 0 < e ? Math.floor(e) : Math.ceil(e);
                        var n = Math.pow(10, e);
                        return Math.round(t * n) / n
                    }(c(t), o),
                    n = u && 1e3 <= e && e < 1e4,
                    i = a(e);
                return n && (i = i.replace(s, "")), r.prefix + i + r.suffix
            } : function(t) {
                var e = c(t),
                    n = u && s && 1e3 <= e && e < 1e4,
                    i = a(e);
                return l && (i = i.replace(l, "")), n && (i = i.replace(s, "")), r.prefix + i + r.suffix
            }
        }

        function dr(e) { for (var t in fr) void 0 === e[t] && (e[t] = fr[t]); return function(t) { return _r(e, t) } }

        function pr(t, e) { if ((n = (t = e ? t.toExponential(e - 1) : t.toExponential()).indexOf("e")) < 0) return null; var n, i = t.slice(0, n); return [1 < i.length ? i[0] + i.slice(2) : i, +t.slice(n + 1)] }

        function gr(t) { return (t = pr(Math.abs(t))) ? t[1] : NaN }
        var yr, mr = /^(?:(.)?([<>=^]))?([+\-\( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;

        function vr(t) { return new xr(t) }

        function xr(t) {
            if (!(e = mr.exec(t))) throw new Error("invalid format: " + t);
            var e;
            this.fill = e[1] || " ", this.align = e[2] || ">", this.sign = e[3] || "-", this.symbol = e[4] || "", this.zero = !!e[5], this.width = e[6] && +e[6], this.comma = !!e[7], this.precision = e[8] && +e[8].slice(1), this.trim = !!e[9], this.type = e[10] || ""
        }

        function br(t, e) {
            var n = pr(t, e);
            if (!n) return t + "";
            var i = n[0],
                r = n[1];
            return r < 0 ? "0." + new Array(-r).join("0") + i : i.length > r + 1 ? i.slice(0, r + 1) + "." + i.slice(r + 1) : i + new Array(r - i.length + 2).join("0")
        }
        vr.prototype = xr.prototype, xr.prototype.toString = function() { return this.fill + this.align + this.sign + this.symbol + (this.zero ? "0" : "") + (null == this.width ? "" : Math.max(1, 0 | this.width)) + (this.comma ? "," : "") + (null == this.precision ? "" : "." + Math.max(0, 0 | this.precision)) + (this.trim ? "~" : "") + this.type };
        var wr = {
            "%": function(t, e) { return (100 * t).toFixed(e) },
            b: function(t) { return Math.round(t).toString(2) },
            c: function(t) { return t + "" },
            d: function(t) { return Math.round(t).toString(10) },
            e: function(t, e) { return t.toExponential(e) },
            f: function(t, e) { return t.toFixed(e) },
            g: function(t, e) { return t.toPrecision(e) },
            o: function(t) { return Math.round(t).toString(8) },
            p: function(t, e) { return br(100 * t, e) },
            r: br,
            s: function(t, e) {
                var n = pr(t, e);
                if (!n) return t + "";
                var i = n[0],
                    r = n[1],
                    o = r - (yr = 3 * Math.max(-8, Math.min(8, Math.floor(r / 3)))) + 1,
                    a = i.length;
                return o === a ? i : a < o ? i + new Array(o - a + 1).join("0") : 0 < o ? i.slice(0, o) + "." + i.slice(o) : "0." + new Array(1 - o).join("0") + pr(t, Math.max(0, e + o - 1))[0]
            },
            X: function(t) { return Math.round(t).toString(16).toUpperCase() },
            x: function(t) { return Math.round(t).toString(16) }
        };

        function kr(t) { return t }
        var Mr, Tr, zr, Cr = ["y", "z", "a", "f", "p", "n", "µ", "m", "", "k", "M", "G", "T", "P", "E", "Z", "Y"];

        function Ar(t) {
            var e, s, l, w = t.grouping && t.thousands ? (s = t.grouping, l = t.thousands, function(t, e) { for (var n = t.length, i = [], r = 0, o = s[0], a = 0; 0 < n && 0 < o && (e < a + o + 1 && (o = Math.max(1, e - a)), i.push(t.substring(n -= o, n + o)), !((a += o + 1) > e));) o = s[r = (r + 1) % s.length]; return i.reverse().join(l) }) : kr,
                i = t.currency,
                k = t.decimal,
                M = t.numerals ? (e = t.numerals, function(t) { return t.replace(/[0-9]/g, function(t) { return e[+t] }) }) : kr,
                r = t.percent || "%";

            function a(t) {
                var u = (t = vr(t)).fill,
                    c = t.align,
                    h = t.sign,
                    e = t.symbol,
                    f = t.zero,
                    _ = t.width,
                    d = t.comma,
                    p = t.precision,
                    g = t.trim,
                    y = t.type;
                "n" === y ? (d = !0, y = "g") : wr[y] || (null == p && (p = 12), g = !0, y = "g"), (f || "0" === u && "=" === c) && (f = !0, u = "0", c = "=");
                var m = "$" === e ? i[0] : "#" === e && /[boxX]/.test(y) ? "0" + y.toLowerCase() : "",
                    v = "$" === e ? i[1] : /[%p]/.test(y) ? r : "",
                    x = wr[y],
                    b = /[defgprs%]/.test(y);

                function n(t) {
                    var e, n, i, r = m,
                        o = v;
                    if ("c" === y) o = x(t) + o, t = "";
                    else {
                        var a = (t = +t) < 0;
                        if (t = x(Math.abs(t), p), g && (t = function(t) {
                                t: for (var e, n = t.length, i = 1, r = -1; i < n; ++i) switch (t[i]) {
                                    case ".":
                                        r = e = i;
                                        break;
                                    case "0":
                                        0 === r && (r = i), e = i;
                                        break;
                                    default:
                                        if (0 < r) {
                                            if (!+t[i]) break t;
                                            r = 0
                                        }
                                }
                                return 0 < r ? t.slice(0, r) + t.slice(e + 1) : t
                            }(t)), a && 0 == +t && (a = !1), r = (a ? "(" === h ? h : "-" : "-" === h || "(" === h ? "" : h) + r, o = ("s" === y ? Cr[8 + yr / 3] : "") + o + (a && "(" === h ? ")" : ""), b)
                            for (e = -1, n = t.length; ++e < n;)
                                if ((i = t.charCodeAt(e)) < 48 || 57 < i) { o = (46 === i ? k + t.slice(e + 1) : t.slice(e)) + o, t = t.slice(0, e); break }
                    }
                    d && !f && (t = w(t, 1 / 0));
                    var s = r.length + t.length + o.length,
                        l = s < _ ? new Array(_ - s + 1).join(u) : "";
                    switch (d && f && (t = w(l + t, l.length ? _ - o.length : 1 / 0), l = ""), c) {
                        case "<":
                            t = r + t + o + l;
                            break;
                        case "=":
                            t = r + l + t + o;
                            break;
                        case "^":
                            t = l.slice(0, s = l.length >> 1) + r + t + o + l.slice(s);
                            break;
                        default:
                            t = l + r + t + o
                    }
                    return M(t)
                }
                return p = null == p ? 6 : /[gprs]/.test(y) ? Math.max(1, Math.min(21, p)) : Math.max(0, Math.min(20, p)), n.toString = function() { return t + "" }, n
            }
            return {
                format: a,
                formatPrefix: function(t, e) {
                    var n = a(((t = vr(t)).type = "f", t)),
                        i = 3 * Math.max(-8, Math.min(8, Math.floor(gr(e) / 3))),
                        r = Math.pow(10, -i),
                        o = Cr[8 + i / 3];
                    return function(t) { return n(r * t) + o }
                }
            }
        }

        function Nr(t) { return Math.max(0, -gr(Math.abs(t))) }

        function Sr(t, e) { return Math.max(0, 3 * Math.max(-8, Math.min(8, Math.floor(gr(e) / 3))) - gr(Math.abs(t))) }

        function Er(t, e) { return t = Math.abs(t), e = Math.abs(e) - t, Math.max(0, gr(e) - gr(t)) + 1 } Mr = Ar({ decimal: ".", thousands: ",", grouping: [3], currency: ["$", ""] }), Tr = Mr.format, zr = Mr.formatPrefix;
        var Fr = Object.freeze({ input_decimal_separator: ".", output_separators: ",." });
        var Lr, Pr, Dr, Or, Ur, Hr = function(s) {
            for (var t in Fr) void 0 === s[t] && (s[t] = Fr[t]);
            return {
                getParser: function() {
                    return e = s.input_decimal_separator, n = new RegExp("[^-0-9eE" + e + "]", "g"),
                        function(t) { return "number" == typeof t ? t : "" === t || void 0 === t ? NaN : parseFloat(t.replace(n, "").replace(e, ".")) };
                    var e, n
                },
                getFormatterFunction: function() { return t = s.output_separators, i = 1 < t.length, r = i ? t.charAt(1) : t.charAt(0), o = i ? t.charAt(0) : "", (a = Ar((e = r, n = o, { decimal: e, thousands: n, grouping: [3], currency: ["", ""] })).format).decimal = r, a.thousands = o, a; var t, e, n, i, r, o, a }
            }
        }(_.localization);

        function Rr() {
            Lr = Hr.getParser();
            var i, a = [];
            Pr = 0, f.horserace.forEach(function(t, e) { t.unfiltered_index = e }), i = null === _.filter || _.filter === _.filter_all_label ? f.horserace : f.horserace.filter(function(t) { return t.filter === _.filter });
            f.horserace.column_names.stages.forEach(function(t, r) {
                var o = [];
                i.forEach(function(t, e) {
                    if (void 0 !== t.stages[r]) {
                        var n = t.stages[r],
                            i = "" == n || isNaN(Lr(n)) ? null : Lr(n);
                        t.index = e, o.push({ name: t.name, index: e, score: i })
                    }
                }), o.sort(function(t, e) { return _.higher_scores_win ? (n = t.score, (i = e.score) < n ? -1 : n < i ? 1 : n <= i ? 0 : NaN) : on(t.score, e.score); var n, i }), ("dense" === _.ties_mode ? function(t) {
                    var e = void 0,
                        n = 0;
                    t.forEach(function(t) { null == t.score ? t.rank = null : t.score == e ? t.rank = n : t.rank = ++n, e = t.score, Pr = Math.max(Pr, t.rank) })
                } : function(t) {
                    var e = void 0,
                        n = 0,
                        i = 0;
                    t.forEach(function(t) { null == t.score ? t.rank = null : t.score == e ? (t.rank = n, i++) : (t.rank = n + i + 1, n = t.rank, i = 0), e = t.score, Pr = Math.max(Pr, t.rank) })
                })(o);
                var e = {};
                o.forEach(function(t) { e[t.index] = t }), a.push(e);
                var n = function(t, e) {
                    var n, i, r, o = t.length,
                        a = -1;
                    if (null == e) {
                        for (; ++a < o;)
                            if (null != (n = t[a]) && n <= n)
                                for (i = r = n; ++a < o;) null != (n = t[a]) && (n < i && (i = n), r < n && (r = n))
                    } else
                        for (; ++a < o;)
                            if (null != (n = e(t[a], a, t)) && n <= n)
                                for (i = r = n; ++a < o;) null != (n = e(t[a], a, t)) && (n < i && (i = n), r < n && (r = n));
                    return [i, r]
                }(o.map(function(t) { return t.score }));
                a[r].min_score = Math.min(1 / 0, n[0]), a[r].max_score = Math.max(-1 / 0, n[1])
            });
            var t = i.map(function(n, i) { var r = null; return n.ranks = n.stages.map(function(t, e) { return a[e][i].rank }), n.line = n.stages.map(function(t, e) { return { i: e, value: "ranks" == _.value_type ? a[e][i].rank : a[e][i].score } }), n.missing_line = n.line.map(function(t, e) { return null !== t.value || 0 === e ? null !== t.value && r ? (r = null, t) : { i: t.i, value: null } : r ? void 0 : (r = !0, { i: t.i - 1, value: n.line[e - 1].value }) }).filter(function(t) { return void 0 !== t }), n.start_circle = n.line.filter(function(t) { return null != t.value })[0], n }).filter(function(t) { return t.start_circle });
            return t.max_rank = Pr, t.timeslices = a, t
        }
        var Yr, qr, jr, Br, Ir, Xr, Vr, Wr, $r, Zr, Qr = Object.freeze({ "stack-default": ["header", "controls", "primary", "footer"], "stack-2": ["primary", "header", "controls", "footer"], "stack-3": ["header", "primary", "controls", "footer"], "stack-4": ["controls", "primary", "header", "footer"] });
        var Jr = !1;

        function Gr(t) { return 0 !== t.indexOf("http://") && 0 !== t.indexOf("https://") ? "http://" + t : t }

        function Kr() { var t; return (t = document.createElement("style")).type = "text/css", t.innerHTML = ".flourish-footer { margin: 0; } .flourish-footer p { margin: 0; display: inline; } .flourish-footer p:empty { height: 0; } .flourish-footer a { color: inherit; } .flourish-footer-note { padding-left: 3px; } .flourish-footer-source:empty > .flourish-footer-note { padding-left: 0; }", document.head.appendChild(t), (Ir = document.createElement("footer")).className = "flourish-footer", (Xr = document.createElement("div")).className = "flourish-footer-text", (Vr = document.createElement("p")).className = "flourish-footer-source", (Wr = document.createElement("p")).className = "flourish-footer-note", (Zr = document.createElement("a")).target = "_blank", ($r = document.createElement("img")).className = "flourish-footer-logo", Zr.appendChild($r), Xr.appendChild(Vr), Xr.appendChild(Wr), Ir.appendChild(Xr), Ir.appendChild(Zr), Ir }

        function to() {
            var t;
            ! function() {
                if (no.body_font && no.body_font.url !== Or) {
                    Or = no.body_font.url, Ur.setAttribute("href", Or), document.body.style.fontFamily = no.body_font.name;
                    var r = "";
                    ["mobile_small", "mobile_big", "tablet", "desktop", "big_screen"].forEach(function(t, e) {
                        var n = "@media(min-width: " + no["breakpoint_" + t] + "px) {\n",
                            i = "html { font-size:" + no["font_size_" + t] + "%; }";
                        r += (0 == e ? "" : n) + i + (0 == e ? "" : "\n}") + "\n\n"
                    }), Dr.innerHTML = r
                }
            }(), Yr.style.textAlign = no.header_align, Yr.style.margin = 0, Yr.style.paddingBottom = (t = no).title || t.subtitle ? t.text ? ("custom" != t.text_size ? t.text_size / 2 : t.text_size_custom / 2) + "rem" : t.subtitle ? ("custom" != t.subtitle_size ? t.subtitle_size / 2 : t.subtitle_size_custom / 2) + "rem" : t.title ? ("custom" != t.title_size ? t.title_size / 2 : t.title_size_custom / 2) + "rem" : void 0 : null, qr.innerHTML = no.title ? no.title : "", qr.style.fontSize = ("custom" != no.title_size ? no.title_size : no.title_size_custom) + "rem", qr.style.lineHeight = no.title_line_height, qr.style.fontWeight = no.title_weight, qr.style.color = no.title_color, qr.style.margin = 0, qr.style.lineHeight = no.title_color, jr.innerHTML = no.subtitle ? no.subtitle : "", jr.style.fontSize = ("custom" != no.subtitle_size ? no.subtitle_size : no.subtitle_size_custom) + "rem", jr.style.lineHeight = no.subtitle_line_height, jr.style.fontWeight = no.subtitle_weight, jr.style.color = no.subtitle_color, jr.style.margin = 0, jr.style.paddingTop = no.subtitle ? ("custom" == no.subtitle_space_above ? no.subtitle_space_above_custom : no.subtitle_space_above) + "rem" : 0, Br.innerHTML = no.text ? no.text : "", Br.style.fontSize = ("custom" != no.text_size ? no.text_size : no.text_size_custom) + "rem", Br.style.lineHeight = no.text_line_height, Br.style.fontWeight = no.text_weight, Br.style.margin = 0, Br.style.color = no.text_color, Br.style.paddingTop = no.text ? ("custom" == no.text_space_above ? no.text_space_above_custom : no.text_space_above) + "rem" : 0,
                function() {
                    var t = [{ name: no.source_name, url: no.source_url }, { name: no.multiple_sources ? no.source_name_2 : "", url: no.multiple_sources ? no.source_url_2 : "" }, { name: no.multiple_sources ? no.source_name_3 : "", url: no.multiple_sources ? no.source_url_3 : "" }].filter(function(t) { return t.name || t.url });
                    Jr = 0 < t.length || no.note || no.logo_url, Ir.style.display = "flex", Ir.style.height = Jr ? null : 0, Ir.style.width = "100%", "justify" == no.footer_align ? Ir.style.justifyContent = "space-between" : "left" == no.footer_align ? Ir.style.justifyContent = "flex-start" : "right" == no.footer_align ? Ir.style.justifyContent = "flex-end" : "center" == no.footer_align && (Ir.style.justifyContent = "center"), Ir.style.fontSize = no.size + "px", Ir.style.color = no.color;
                    var r = document.createElement("span");
                    t.forEach(function(t, e) {
                        var n = document.createElement("p");
                        if (0 < e && (n.innerText = ", "), t.url) {
                            var i = document.createElement("a");
                            i.innerText = t.name || t.url, i.href = Gr(t.url), i.target = "_blank", n.appendChild(i)
                        } else n.innerText += t.name || t.url;
                        r.appendChild(n)
                    }), Xr.style.order = "left" == no.logo_order ? 2 : null, Xr.style.display = "flex", Xr.style.alignItems = no.footer_align_vertical, Vr.innerHTML = "" !== r.innerHTML ? no.source_label + " " + r.outerHTML : "", Wr.innerHTML = no.note ? ("" !== r.innerHTML ? "• " : "") + no.note : "", $r.src = no.logo_url, $r.style.height = no.logo_height + "px", $r.style.marginLeft = "justify" != no.footer_align && "right" == no.logo_order ? no.logo_margin + "px" : null, $r.style.marginRight = "justify" != no.footer_align && "left" == no.logo_order ? no.logo_margin + "px" : null, $r.style.verticalAlign = no.footer_align_vertical, Zr.href = "" == no.logo_link_url ? "" : Gr(no.logo_link_url), Zr.style.cursor = "" == no.logo_link_url ? "default" : "pointer"
                }(), document.body.style.backgroundColor = no.background_color_enabled ? no.background_color : "transparent", document.body.style.backgroundImage = no.background_image_enabled ? "url(" + no.background_image_src + ")" : null, document.body.style.backgroundSize = no.background_image_size, document.body.style.backgroundRepeat = "no-repeat", document.body.style.backgroundPosition = no.background_image_position;
            var e = ro.wrapper.style;
            e.height = "100vh", e.maxWidth = no.max_width ? no.max_width + "px" : null, e.padding = no.margin + "px";
            var n = ro.primary.outer.style,
                i = ro.legend.outer.style,
                r = parseFloat(n.order) > parseFloat(i.order) ? "above" : "below";
            Qr[no.layout_order].forEach(function(t, e) { ro[t].outer.style.order = 10 * e }), n.flex = "1 1 auto", n.height = null, vo(r), i.textAlign = no.header_align, ro.controls.outer.style.textAlign = no.header_align, ro.primary.inner.style.height = "100%";
            var o = ("custom" == no.space_between_sections ? no.space_between_sections_custom : no.space_between_sections) / 2 + "rem";
            io.map(function(t) {
                var e = ro[t],
                    n = e.outer.style;
                return { name: t, height: ao(e.inner), order: parseFloat(n.order), style: n }
            }).sort(function(t, e) { return t.order - e.order }).filter(function(t) {
                if (t.height) return !0;
                t.style.paddingBottom = null, t.style.paddingTop = null
            }).forEach(function(t, e, n) { t.style.paddingTop = e ? o : null, t.style.paddingBottom = e < n.length - 1 ? o : null })
        }
        var eo = Object.freeze({ body_font: { name: "Source Sans Pro", url: "https://fonts.googleapis.com/css?family=Source+Sans+Pro:400,700" }, layout_order: "stack-default", margin: 10, space_between_sections: 0, space_between_sections_custom: 1, background_color_enabled: !0, background_color: "#ffffff", background_image_enabled: !1, background_image_src: "", background_image_size: "cover", background_image_position: "center center", max_width: null, breakpoint_mobile_small: 0, breakpoint_mobile_big: 380, breakpoint_tablet: 580, breakpoint_desktop: 1080, breakpoint_big_screen: 1280, font_size_mobile_small: 62.5, font_size_mobile_big: 75, font_size_tablet: 87.5, font_size_desktop: 100, font_size_big_screen: 120, header_align: "left", title: "", title_size: 1.6, title_size_custom: 1.6, title_line_height: 1.2, title_color: "#333333", title_weight: "bold", subtitle: "", subtitle_size: 1.6, subtitle_size_custom: 1.6, subtitle_line_height: 1.2, subtitle_color: "#666666", subtitle_weight: "normal", subtitle_space_above: 0, subtitle_space_above_custom: 1.5, text: "", text_size: 1.2, text_size_custom: 1.2, text_line_height: 1.2, text_color: "#666666", text_weight: "normal", text_space_above: .5, text_space_above_custom: 1.5, source_label: "Source: ", source_name: "", source_url: "", source_name_2: "", source_url_2: "", source_name_3: "", source_url_3: "", note: "", size: "12", color: "#aaaaaa", footer_align: "justify", footer_align_vertical: "center", logo_url: "", logo_link_url: "", logo_height: 20, logo_margin: 5, logo_order: "right" });
        var no, io = ["header", "controls", "legend", "primary", "footer"],
            ro = {};

        function oo(t) { return t.getBoundingClientRect().width }

        function ao(t) { return t.getBoundingClientRect().height }

        function so() { return ro.wrapper }

        function lo(t) { return -1 !== io.indexOf(t) ? ro[t].inner : null }

        function uo(t) { return ro[t] || void 0 === t ? oo("wrapper" == t || void 0 === t ? ro.wrapper : ro[t].outer) : null }

        function co(t) { return ro[t] || void 0 === t ? "wrapper" == t || void 0 === t ? oo(ro.wrapper) - 2 * no.margin : oo(ro[t].inner) : null }

        function ho(t) { return ro[t] || void 0 === t ? ao("wrapper" == t || void 0 === t ? ro.wrapper : ro[t].outer) : null }

        function fo(t) { return ro[t] || void 0 === t ? "wrapper" == t || void 0 === t ? ao(ro.wrapper) - 2 * no.margin : ao(ro[t].inner) : null }

        function _o() { return ao(ro.primary.outer) - go(ro.primary.outer) }

        function po() { return oo(ro.primary.inner) }

        function go(t) { return (parseFloat(getComputedStyle(t).paddingTop) || 0) + (parseFloat(getComputedStyle(t).paddingBottom) || 0) }

        function yo() { return function() { if (Flourish.fixed_height) return window.innerHeight; var t = window.innerWidth; return 999 < t ? 650 : 599 < t ? 575 : 400 }() - 2 * no.margin - ["header", "controls", "legend", "footer"].reduce(function(t, e) { return t + ho(e) }, 0) - go(ro.primary.outer) }

        function mo(t) {
            if (!Flourish.fixed_height && void 0 !== Flourish.fixed_height) {
                var e = null === t,
                    n = ro.primary,
                    i = e ? yo() : t;
                i + go(ro.primary.outer) !== parseFloat(n.outer.style.height) && (ro.wrapper.style.height = null, n.outer.style.flex = null, n.inner.style.height = i + "px", Flourish.setHeight(e ? null : ho()))
            }
        }

        function vo(t) {
            var e = parseFloat(ro.primary.outer.style.order);
            ro.legend.outer.style.order = e + 1 * ("below" === t.trim().toLowerCase() ? 1 : -1)
        }
        var xo = "$";

        function bo() {}

        function wo(t, e) {
            var n = new bo;
            if (t instanceof bo) t.each(function(t, e) { n.set(e, t) });
            else if (Array.isArray(t)) {
                var i, r = -1,
                    o = t.length;
                if (null == e)
                    for (; ++r < o;) n.set(r, t[r]);
                else
                    for (; ++r < o;) n.set(e(i = t[r], r, t), i)
            } else if (t)
                for (var a in t) n.set(a, t[a]);
            return n
        }

        function ko() {} bo.prototype = wo.prototype = {
            constructor: bo,
            has: function(t) { return xo + t in this },
            get: function(t) { return this[xo + t] },
            set: function(t, e) { return this[xo + t] = e, this },
            remove: function(t) { var e = xo + t; return e in this && delete this[e] },
            clear: function() { for (var t in this) t[0] === xo && delete this[t] },
            keys: function() { var t = []; for (var e in this) e[0] === xo && t.push(e.slice(1)); return t },
            values: function() { var t = []; for (var e in this) e[0] === xo && t.push(this[e]); return t },
            entries: function() { var t = []; for (var e in this) e[0] === xo && t.push({ key: e.slice(1), value: this[e] }); return t },
            size: function() { var t = 0; for (var e in this) e[0] === xo && ++t; return t },
            empty: function() {
                for (var t in this)
                    if (t[0] === xo) return !1;
                return !0
            },
            each: function(t) { for (var e in this) e[0] === xo && t(this[e], e.slice(1), this) }
        };
        var Mo = wo.prototype;

        function To(t, e) {
            var n = new ko;
            if (t instanceof ko) t.each(function(t) { n.add(t) });
            else if (t) {
                var i = -1,
                    r = t.length;
                if (null == e)
                    for (; ++i < r;) n.add(t[i]);
                else
                    for (; ++i < r;) n.add(e(t[i], i, t))
            }
            return n
        }
        ko.prototype = To.prototype = { constructor: ko, has: Mo.has, add: function(t) { return this[xo + (t += "")] = t, this }, remove: Mo.remove, clear: Mo.clear, values: Mo.keys, size: Mo.size, empty: Mo.empty, each: Mo.each };
        var zo = Array.prototype,
            Co = zo.map,
            Ao = zo.slice;

        function No(t) { return +t }
        var So = [0, 1];

        function Eo(e, n) { return (n -= e = +e) ? function(t) { return (t - e) / n } : (t = n, function() { return t }); var t }

        function Fo(t, e, n, i) {
            var r = t[0],
                o = t[1],
                a = e[0],
                s = e[1];
            return a = o < r ? (r = n(o, r), i(s, a)) : (r = n(r, o), i(a, s)),
                function(t) { return a(r(t)) }
        }

        function Lo(n, t, e, i) {
            var r = Math.min(n.length, t.length) - 1,
                o = new Array(r),
                a = new Array(r),
                s = -1;
            for (n[r] < n[0] && (n = n.slice().reverse(), t = t.slice().reverse()); ++s < r;) o[s] = e(n[s], n[s + 1]), a[s] = i(t[s], t[s + 1]);
            return function(t) { var e = ln(n, t, 1, r) - 1; return a[e](o[e](t)) }
        }

        function Po(s) {
            var l = s.domain;
            return s.ticks = function(t) { var e = l(); return fn(e[0], e[e.length - 1], null == t ? 10 : t) }, s.tickFormat = function(t, e) {
                return function(t, e, n) {
                    var i, r = t[0],
                        o = t[t.length - 1],
                        a = dn(r, o, null == e ? 10 : e);
                    switch ((n = vr(null == n ? ",f" : n)).type) {
                        case "s":
                            var s = Math.max(Math.abs(r), Math.abs(o));
                            return null != n.precision || isNaN(i = Sr(a, s)) || (n.precision = i), zr(n, s);
                        case "":
                        case "e":
                        case "g":
                        case "p":
                        case "r":
                            null != n.precision || isNaN(i = Er(a, Math.max(Math.abs(r), Math.abs(o)))) || (n.precision = i - ("e" === n.type));
                            break;
                        case "f":
                        case "%":
                            null != n.precision || isNaN(i = Nr(a)) || (n.precision = i - 2 * ("%" === n.type))
                    }
                    return Tr(n)
                }(l(), t, e)
            }, s.nice = function(t) {
                null == t && (t = 10);
                var e, n = l(),
                    i = 0,
                    r = n.length - 1,
                    o = n[i],
                    a = n[r];
                return a < o && (e = o, o = a, a = e, e = i, i = r, r = e), 0 < (e = _n(o, a, t)) ? e = _n(o = Math.floor(o / e) * e, a = Math.ceil(a / e) * e, t) : e < 0 && (e = _n(o = Math.ceil(o * e) / e, a = Math.floor(a * e) / e, t)), 0 < e ? (n[i] = Math.floor(o / e) * e, n[r] = Math.ceil(a / e) * e, l(n)) : e < 0 && (n[i] = Math.ceil(o * e) / e, n[r] = Math.floor(a * e) / e, l(n)), s
            }, s
        }

        function Do() {
            var e = function(e, n) {
                var i, o, a, s = So,
                    l = So,
                    u = Ue,
                    c = !1;

                function r() { return i = 2 < Math.min(s.length, l.length) ? Lo : Fo, o = a = null, t }

                function t(t) { return (o || (o = i(s, l, c ? (r = e, function(e, n) { var i = r(e = +e, n = +n); return function(t) { return t <= e ? 0 : n <= t ? 1 : i(t) } }) : e, u)))(+t); var r }
                return t.invert = function(t) { return (a || (a = i(l, s, Eo, c ? (r = n, function(e, n) { var i = r(e = +e, n = +n); return function(t) { return t <= 0 ? e : 1 <= t ? n : i(t) } }) : n)))(+t); var r }, t.domain = function(t) { return arguments.length ? (s = Co.call(t, No), r()) : s.slice() }, t.range = function(t) { return arguments.length ? (l = Ao.call(t), r()) : l.slice() }, t.rangeRound = function(t) { return l = Ao.call(t), u = He, r() }, t.clamp = function(t) { return arguments.length ? (c = !!t, r()) : c }, t.interpolate = function(t) { return arguments.length ? (u = t, r()) : u }, r()
            }(Eo, Le);
            return e.copy = function() { return t = e, Do().domain(t.domain()).range(t.range()).interpolate(t.interpolate()).clamp(t.clamp()); var t }, Po(e)
        }
        var Oo = new Date,
            Uo = new Date;

        function Ho(o, a, n, i) {
            function s(t) { return o(t = new Date(+t)), t }
            return (s.floor = s).ceil = function(t) { return o(t = new Date(t - 1)), a(t, 1), o(t), t }, s.round = function(t) {
                var e = s(t),
                    n = s.ceil(t);
                return t - e < n - t ? e : n
            }, s.offset = function(t, e) { return a(t = new Date(+t), null == e ? 1 : Math.floor(e)), t }, s.range = function(t, e, n) { var i, r = []; if (t = s.ceil(t), n = null == n ? 1 : Math.floor(n), !(t < e && 0 < n)) return r; for (; r.push(i = new Date(+t)), a(t, n), o(t), i < t && t < e;); return r }, s.filter = function(n) {
                return Ho(function(t) {
                    if (t <= t)
                        for (; o(t), !n(t);) t.setTime(t - 1)
                }, function(t, e) {
                    if (t <= t)
                        if (e < 0)
                            for (; ++e <= 0;)
                                for (; a(t, -1), !n(t););
                        else
                            for (; 0 <= --e;)
                                for (; a(t, 1), !n(t););
                })
            }, n && (s.count = function(t, e) { return Oo.setTime(+t), Uo.setTime(+e), o(Oo), o(Uo), Math.floor(n(Oo, Uo)) }, s.every = function(e) { return e = Math.floor(e), isFinite(e) && 0 < e ? 1 < e ? s.filter(i ? function(t) { return i(t) % e == 0 } : function(t) { return s.count(0, t) % e == 0 }) : s : null }), s
        }
        var Ro = Ho(function() {}, function(t, e) { t.setTime(+t + e) }, function(t, e) { return e - t });
        Ro.every = function(n) { return n = Math.floor(n), isFinite(n) && 0 < n ? 1 < n ? Ho(function(t) { t.setTime(Math.floor(t / n) * n) }, function(t, e) { t.setTime(+t + e * n) }, function(t, e) { return (e - t) / n }) : Ro : null };
        Ro.range;
        var Yo = 6e4,
            qo = 36e5,
            jo = (Ho(function(t) { t.setTime(1e3 * Math.floor(t / 1e3)) }, function(t, e) { t.setTime(+t + 1e3 * e) }, function(t, e) { return (e - t) / 1e3 }, function(t) { return t.getUTCSeconds() }).range, Ho(function(t) { t.setTime(Math.floor(t / Yo) * Yo) }, function(t, e) { t.setTime(+t + e * Yo) }, function(t, e) { return (e - t) / Yo }, function(t) { return t.getMinutes() }).range, Ho(function(t) {
                var e = t.getTimezoneOffset() * Yo % qo;
                e < 0 && (e += qo), t.setTime(Math.floor((+t - e) / qo) * qo + e)
            }, function(t, e) { t.setTime(+t + e * qo) }, function(t, e) { return (e - t) / qo }, function(t) { return t.getHours() }).range, Ho(function(t) { t.setHours(0, 0, 0, 0) }, function(t, e) { t.setDate(t.getDate() + e) }, function(t, e) { return (e - t - (e.getTimezoneOffset() - t.getTimezoneOffset()) * Yo) / 864e5 }, function(t) { return t.getDate() - 1 }));
        jo.range;

        function Bo(e) { return Ho(function(t) { t.setDate(t.getDate() - (t.getDay() + 7 - e) % 7), t.setHours(0, 0, 0, 0) }, function(t, e) { t.setDate(t.getDate() + 7 * e) }, function(t, e) { return (e - t - (e.getTimezoneOffset() - t.getTimezoneOffset()) * Yo) / 6048e5 }) }
        var Io = Bo(0),
            Xo = Bo(1),
            Vo = (Bo(2), Bo(3), Bo(4)),
            Wo = (Bo(5), Bo(6), Io.range, Ho(function(t) { t.setDate(1), t.setHours(0, 0, 0, 0) }, function(t, e) { t.setMonth(t.getMonth() + e) }, function(t, e) { return e.getMonth() - t.getMonth() + 12 * (e.getFullYear() - t.getFullYear()) }, function(t) { return t.getMonth() }).range, Ho(function(t) { t.setMonth(0, 1), t.setHours(0, 0, 0, 0) }, function(t, e) { t.setFullYear(t.getFullYear() + e) }, function(t, e) { return e.getFullYear() - t.getFullYear() }, function(t) { return t.getFullYear() }));
        Wo.every = function(n) { return isFinite(n = Math.floor(n)) && 0 < n ? Ho(function(t) { t.setFullYear(Math.floor(t.getFullYear() / n) * n), t.setMonth(0, 1), t.setHours(0, 0, 0, 0) }, function(t, e) { t.setFullYear(t.getFullYear() + e * n) }) : null };
        Wo.range, Ho(function(t) { t.setUTCSeconds(0, 0) }, function(t, e) { t.setTime(+t + e * Yo) }, function(t, e) { return (e - t) / Yo }, function(t) { return t.getUTCMinutes() }).range, Ho(function(t) { t.setUTCMinutes(0, 0, 0) }, function(t, e) { t.setTime(+t + e * qo) }, function(t, e) { return (e - t) / qo }, function(t) { return t.getUTCHours() }).range;
        var $o = Ho(function(t) { t.setUTCHours(0, 0, 0, 0) }, function(t, e) { t.setUTCDate(t.getUTCDate() + e) }, function(t, e) { return (e - t) / 864e5 }, function(t) { return t.getUTCDate() - 1 });
        $o.range;

        function Zo(e) { return Ho(function(t) { t.setUTCDate(t.getUTCDate() - (t.getUTCDay() + 7 - e) % 7), t.setUTCHours(0, 0, 0, 0) }, function(t, e) { t.setUTCDate(t.getUTCDate() + 7 * e) }, function(t, e) { return (e - t) / 6048e5 }) }
        var Qo = Zo(0),
            Jo = Zo(1),
            Go = (Zo(2), Zo(3), Zo(4)),
            Ko = (Zo(5), Zo(6), Qo.range, Ho(function(t) { t.setUTCDate(1), t.setUTCHours(0, 0, 0, 0) }, function(t, e) { t.setUTCMonth(t.getUTCMonth() + e) }, function(t, e) { return e.getUTCMonth() - t.getUTCMonth() + 12 * (e.getUTCFullYear() - t.getUTCFullYear()) }, function(t) { return t.getUTCMonth() }).range, Ho(function(t) { t.setUTCMonth(0, 1), t.setUTCHours(0, 0, 0, 0) }, function(t, e) { t.setUTCFullYear(t.getUTCFullYear() + e) }, function(t, e) { return e.getUTCFullYear() - t.getUTCFullYear() }, function(t) { return t.getUTCFullYear() }));
        Ko.every = function(n) { return isFinite(n = Math.floor(n)) && 0 < n ? Ho(function(t) { t.setUTCFullYear(Math.floor(t.getUTCFullYear() / n) * n), t.setUTCMonth(0, 1), t.setUTCHours(0, 0, 0, 0) }, function(t, e) { t.setUTCFullYear(t.getUTCFullYear() + e * n) }) : null };
        Ko.range;

        function ta(t) { if (0 <= t.y && t.y < 100) { var e = new Date(-1, t.m, t.d, t.H, t.M, t.S, t.L); return e.setFullYear(t.y), e } return new Date(t.y, t.m, t.d, t.H, t.M, t.S, t.L) }

        function ea(t) { if (0 <= t.y && t.y < 100) { var e = new Date(Date.UTC(-1, t.m, t.d, t.H, t.M, t.S, t.L)); return e.setUTCFullYear(t.y), e } return new Date(Date.UTC(t.y, t.m, t.d, t.H, t.M, t.S, t.L)) }

        function na(t) { return { y: t, m: 0, d: 1, H: 0, M: 0, S: 0, L: 0 } }
        var ia, ra, oa, aa = { "-": "", _: " ", 0: "0" },
            sa = /^\s*\d+/,
            la = /^%/,
            ua = /[\\^$*+?|[\]().{}]/g;

        function ca(t, e, n) {
            var i = t < 0 ? "-" : "",
                r = (i ? -t : t) + "",
                o = r.length;
            return i + (o < n ? new Array(n - o + 1).join(e) + r : r)
        }

        function ha(t) { return t.replace(ua, "\\$&") }

        function fa(t) { return new RegExp("^(?:" + t.map(ha).join("|") + ")", "i") }

        function _a(t) { for (var e = {}, n = -1, i = t.length; ++n < i;) e[t[n].toLowerCase()] = n; return e }

        function da(t, e, n) { var i = sa.exec(e.slice(n, n + 1)); return i ? (t.w = +i[0], n + i[0].length) : -1 }

        function pa(t, e, n) { var i = sa.exec(e.slice(n, n + 1)); return i ? (t.u = +i[0], n + i[0].length) : -1 }

        function ga(t, e, n) { var i = sa.exec(e.slice(n, n + 2)); return i ? (t.U = +i[0], n + i[0].length) : -1 }

        function ya(t, e, n) { var i = sa.exec(e.slice(n, n + 2)); return i ? (t.V = +i[0], n + i[0].length) : -1 }

        function ma(t, e, n) { var i = sa.exec(e.slice(n, n + 2)); return i ? (t.W = +i[0], n + i[0].length) : -1 }

        function va(t, e, n) { var i = sa.exec(e.slice(n, n + 4)); return i ? (t.y = +i[0], n + i[0].length) : -1 }

        function xa(t, e, n) { var i = sa.exec(e.slice(n, n + 2)); return i ? (t.y = +i[0] + (68 < +i[0] ? 1900 : 2e3), n + i[0].length) : -1 }

        function ba(t, e, n) { var i = /^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(e.slice(n, n + 6)); return i ? (t.Z = i[1] ? 0 : -(i[2] + (i[3] || "00")), n + i[0].length) : -1 }

        function wa(t, e, n) { var i = sa.exec(e.slice(n, n + 2)); return i ? (t.m = i[0] - 1, n + i[0].length) : -1 }

        function ka(t, e, n) { var i = sa.exec(e.slice(n, n + 2)); return i ? (t.d = +i[0], n + i[0].length) : -1 }

        function Ma(t, e, n) { var i = sa.exec(e.slice(n, n + 3)); return i ? (t.m = 0, t.d = +i[0], n + i[0].length) : -1 }

        function Ta(t, e, n) { var i = sa.exec(e.slice(n, n + 2)); return i ? (t.H = +i[0], n + i[0].length) : -1 }

        function za(t, e, n) { var i = sa.exec(e.slice(n, n + 2)); return i ? (t.M = +i[0], n + i[0].length) : -1 }

        function Ca(t, e, n) { var i = sa.exec(e.slice(n, n + 2)); return i ? (t.S = +i[0], n + i[0].length) : -1 }

        function Aa(t, e, n) { var i = sa.exec(e.slice(n, n + 3)); return i ? (t.L = +i[0], n + i[0].length) : -1 }

        function Na(t, e, n) { var i = sa.exec(e.slice(n, n + 6)); return i ? (t.L = Math.floor(i[0] / 1e3), n + i[0].length) : -1 }

        function Sa(t, e, n) { var i = la.exec(e.slice(n, n + 1)); return i ? n + i[0].length : -1 }

        function Ea(t, e, n) { var i = sa.exec(e.slice(n)); return i ? (t.Q = +i[0], n + i[0].length) : -1 }

        function Fa(t, e, n) { var i = sa.exec(e.slice(n)); return i ? (t.Q = 1e3 * +i[0], n + i[0].length) : -1 }

        function La(t, e) { return ca(t.getDate(), e, 2) }

        function Pa(t, e) { return ca(t.getHours(), e, 2) }

        function Da(t, e) { return ca(t.getHours() % 12 || 12, e, 2) }

        function Oa(t, e) { return ca(1 + jo.count(Wo(t), t), e, 3) }

        function Ua(t, e) { return ca(t.getMilliseconds(), e, 3) }

        function Ha(t, e) { return Ua(t, e) + "000" }

        function Ra(t, e) { return ca(t.getMonth() + 1, e, 2) }

        function Ya(t, e) { return ca(t.getMinutes(), e, 2) }

        function qa(t, e) { return ca(t.getSeconds(), e, 2) }

        function ja(t) { var e = t.getDay(); return 0 === e ? 7 : e }

        function Ba(t, e) { return ca(Io.count(Wo(t), t), e, 2) }

        function Ia(t, e) { var n = t.getDay(); return t = 4 <= n || 0 === n ? Vo(t) : Vo.ceil(t), ca(Vo.count(Wo(t), t) + (4 === Wo(t).getDay()), e, 2) }

        function Xa(t) { return t.getDay() }

        function Va(t, e) { return ca(Xo.count(Wo(t), t), e, 2) }

        function Wa(t, e) { return ca(t.getFullYear() % 100, e, 2) }

        function $a(t, e) { return ca(t.getFullYear() % 1e4, e, 4) }

        function Za(t) { var e = t.getTimezoneOffset(); return (0 < e ? "-" : (e *= -1, "+")) + ca(e / 60 | 0, "0", 2) + ca(e % 60, "0", 2) }

        function Qa(t, e) { return ca(t.getUTCDate(), e, 2) }

        function Ja(t, e) { return ca(t.getUTCHours(), e, 2) }

        function Ga(t, e) { return ca(t.getUTCHours() % 12 || 12, e, 2) }

        function Ka(t, e) { return ca(1 + $o.count(Ko(t), t), e, 3) }

        function ts(t, e) { return ca(t.getUTCMilliseconds(), e, 3) }

        function es(t, e) { return ts(t, e) + "000" }

        function ns(t, e) { return ca(t.getUTCMonth() + 1, e, 2) }

        function is(t, e) { return ca(t.getUTCMinutes(), e, 2) }

        function rs(t, e) { return ca(t.getUTCSeconds(), e, 2) }

        function os(t) { var e = t.getUTCDay(); return 0 === e ? 7 : e }

        function as(t, e) { return ca(Qo.count(Ko(t), t), e, 2) }

        function ss(t, e) { var n = t.getUTCDay(); return t = 4 <= n || 0 === n ? Go(t) : Go.ceil(t), ca(Go.count(Ko(t), t) + (4 === Ko(t).getUTCDay()), e, 2) }

        function ls(t) { return t.getUTCDay() }

        function us(t, e) { return ca(Jo.count(Ko(t), t), e, 2) }

        function cs(t, e) { return ca(t.getUTCFullYear() % 100, e, 2) }

        function hs(t, e) { return ca(t.getUTCFullYear() % 1e4, e, 4) }

        function fs() { return "+0000" }

        function _s() { return "%" }

        function ds(t) { return +t }

        function ps(t) { return Math.floor(+t / 1e3) } ia = function(t) {
            var i = t.dateTime,
                r = t.date,
                o = t.time,
                e = t.periods,
                n = t.days,
                a = t.shortDays,
                s = t.months,
                l = t.shortMonths,
                u = fa(e),
                c = _a(e),
                h = fa(n),
                f = _a(n),
                _ = fa(a),
                d = _a(a),
                p = fa(s),
                g = _a(s),
                y = fa(l),
                m = _a(l),
                v = { a: function(t) { return a[t.getDay()] }, A: function(t) { return n[t.getDay()] }, b: function(t) { return l[t.getMonth()] }, B: function(t) { return s[t.getMonth()] }, c: null, d: La, e: La, f: Ha, H: Pa, I: Da, j: Oa, L: Ua, m: Ra, M: Ya, p: function(t) { return e[+(12 <= t.getHours())] }, Q: ds, s: ps, S: qa, u: ja, U: Ba, V: Ia, w: Xa, W: Va, x: null, X: null, y: Wa, Y: $a, Z: Za, "%": _s },
                x = { a: function(t) { return a[t.getUTCDay()] }, A: function(t) { return n[t.getUTCDay()] }, b: function(t) { return l[t.getUTCMonth()] }, B: function(t) { return s[t.getUTCMonth()] }, c: null, d: Qa, e: Qa, f: es, H: Ja, I: Ga, j: Ka, L: ts, m: ns, M: is, p: function(t) { return e[+(12 <= t.getUTCHours())] }, Q: ds, s: ps, S: rs, u: os, U: as, V: ss, w: ls, W: us, x: null, X: null, y: cs, Y: hs, Z: fs, "%": _s },
                b = { a: function(t, e, n) { var i = _.exec(e.slice(n)); return i ? (t.w = d[i[0].toLowerCase()], n + i[0].length) : -1 }, A: function(t, e, n) { var i = h.exec(e.slice(n)); return i ? (t.w = f[i[0].toLowerCase()], n + i[0].length) : -1 }, b: function(t, e, n) { var i = y.exec(e.slice(n)); return i ? (t.m = m[i[0].toLowerCase()], n + i[0].length) : -1 }, B: function(t, e, n) { var i = p.exec(e.slice(n)); return i ? (t.m = g[i[0].toLowerCase()], n + i[0].length) : -1 }, c: function(t, e, n) { return M(t, i, e, n) }, d: ka, e: ka, f: Na, H: Ta, I: Ta, j: Ma, L: Aa, m: wa, M: za, p: function(t, e, n) { var i = u.exec(e.slice(n)); return i ? (t.p = c[i[0].toLowerCase()], n + i[0].length) : -1 }, Q: Ea, s: Fa, S: Ca, u: pa, U: ga, V: ya, w: da, W: ma, x: function(t, e, n) { return M(t, r, e, n) }, X: function(t, e, n) { return M(t, o, e, n) }, y: xa, Y: va, Z: ba, "%": Sa };

            function w(l, u) {
                return function(t) {
                    var e, n, i, r = [],
                        o = -1,
                        a = 0,
                        s = l.length;
                    for (t instanceof Date || (t = new Date(+t)); ++o < s;) 37 === l.charCodeAt(o) && (r.push(l.slice(a, o)), null != (n = aa[e = l.charAt(++o)]) ? e = l.charAt(++o) : n = "e" === e ? " " : "0", (i = u[e]) && (e = i(t, n)), r.push(e), a = o + 1);
                    return r.push(l.slice(a, o)), r.join("")
                }
            }

            function k(r, o) { return function(t) { var e, n, i = na(1900); if (M(i, r, t += "", 0) != t.length) return null; if ("Q" in i) return new Date(i.Q); if ("p" in i && (i.H = i.H % 12 + 12 * i.p), "V" in i) { if (i.V < 1 || 53 < i.V) return null; "w" in i || (i.w = 1), i.d = "Z" in i ? (e = 4 < (n = (e = ea(na(i.y))).getUTCDay()) || 0 === n ? Jo.ceil(e) : Jo(e), e = $o.offset(e, 7 * (i.V - 1)), i.y = e.getUTCFullYear(), i.m = e.getUTCMonth(), e.getUTCDate() + (i.w + 6) % 7) : (e = 4 < (n = (e = o(na(i.y))).getDay()) || 0 === n ? Xo.ceil(e) : Xo(e), e = jo.offset(e, 7 * (i.V - 1)), i.y = e.getFullYear(), i.m = e.getMonth(), e.getDate() + (i.w + 6) % 7) } else("W" in i || "U" in i) && ("w" in i || (i.w = "u" in i ? i.u % 7 : "W" in i ? 1 : 0), n = "Z" in i ? ea(na(i.y)).getUTCDay() : o(na(i.y)).getDay(), i.m = 0, i.d = "W" in i ? (i.w + 6) % 7 + 7 * i.W - (n + 5) % 7 : i.w + 7 * i.U - (n + 6) % 7); return "Z" in i ? (i.H += i.Z / 100 | 0, i.M += i.Z % 100, ea(i)) : o(i) } }

            function M(t, e, n, i) { for (var r, o, a = 0, s = e.length, l = n.length; a < s;) { if (l <= i) return -1; if (37 === (r = e.charCodeAt(a++))) { if (r = e.charAt(a++), !(o = b[r in aa ? e.charAt(a++) : r]) || (i = o(t, n, i)) < 0) return -1 } else if (r != n.charCodeAt(i++)) return -1 } return i }
            return v.x = w(r, v), v.X = w(o, v), v.c = w(i, v), x.x = w(r, x), x.X = w(o, x), x.c = w(i, x), { format: function(t) { var e = w(t += "", v); return e.toString = function() { return t }, e }, parse: function(t) { var e = k(t += "", ta); return e.toString = function() { return t }, e }, utcFormat: function(t) { var e = w(t += "", x); return e.toString = function() { return t }, e }, utcParse: function(t) { var e = k(t, ea); return e.toString = function() { return t }, e } }
        }({ dateTime: "%x, %X", date: "%-m/%-d/%Y", time: "%-I:%M:%S %p", periods: ["AM", "PM"], days: ["Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday"], shortDays: ["Sun", "Mon", "Tue", "Wed", "Thu", "Fri", "Sat"], months: ["January", "February", "March", "April", "May", "June", "July", "August", "September", "October", "November", "December"], shortMonths: ["Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec"] }), ia.format, ia.parse, ra = ia.utcFormat, oa = ia.utcParse;
        var gs = "%Y-%m-%dT%H:%M:%S.%LZ";
        Date.prototype.toISOString || ra(gs); + new Date("2000-01-01T00:00:00.000Z") || oa(gs);
        var ys, ms, vs, xs, bs, ws, ks, Ms, Ts, zs, Cs, As = { x_axis: {}, line: {} };

        function Ns(t, e, n) {
            var i;
            As = { x: { size: 0 }, line: { size: 0 } }, f.horserace.forEach(function(t) { t.name.length > As.line.size && (As.line.text = t.name, As.line.size = t.name.length) }), As.line.el = Ml.append("text").text(As.line.text).style("font-size", _.label_font_size + "px"), As.line.width = As.line.el.node().getBoundingClientRect().width, As.line.el.remove(), f.horserace.column_names.stages.forEach(function(t) { t.length > As.x.size && (As.x.text = t, As.x.size = t.length) }), As.x.el = Ml.append("text").text(As.x.text).style("font-size", _.x_axis_label_size + "px").attr("transform", function() { return "tilted" == _.x_axis_rotate ? "rotate(-45)" : "vertical" == _.x_axis_rotate ? "rotate(-90)" : "rotate(0)" }), As.x.height = As.x.el.node().getBoundingClientRect().height, As.x.el.remove(), Cs = Cs || document.getElementById("viz-ui");
            var r, o = Hl.getInnerWidth();
            vs = Il ? Math.min(_.start_circle_r, 28) / 2 : _.start_circle_r, ys = Il ? Math.min(_.end_circle_r, 28) / 2 : _.end_circle_r, ms = Il ? _.end_circle_stroke / 2 : _.end_circle_stroke, bs = Il ? Math.max(Math.round(_.shade_width / 2), 1) : _.shade_width, xs = Il ? Math.max(Math.round(_.line_width / 2), 1) : _.line_width, ws = Math.max(2 * ys + ms, 2 * vs, xs, bs), r = _.zoom_enabled ? Il ? _.margin_right_mobile : _.margin_right : Il ? ys + _.margin_right_mobile : _.margin_right + As.line.width + (_.rank_outside_picture ? 15 : 0) + ys + ms;
            var a = ws / 2 + _.margin_bottom,
                s = ws / 2 + As.x.height + _.margin_top,
                l = Math.max(ws / 2, 5) + _.margin_left + ("ranks" == _.value_type ? 0 : (_.y_axis_format.suffix.length + _.y_axis_format.prefix.length) * (.5 * _.y_axis_label_size)),
                u = null != _.y_axis_max_rank && "" != _.y_axis_max_rank ? _.y_axis_max_rank : f.horserace.length,
                c = u * ws + (u - 1) * (.1 * ws);
            "flexible" == _.height_mode || "auto" == _.height_mode && c > Hl.getDefaultPrimaryHeight() ? (i = c + (s + a - ws), Hl.setHeight(i)) : (Hl.setHeight(null), i = Hl.getPrimaryHeight()), Ml.attr("width", o).attr("height", i), Tl.attr("transform", "translate(" + l + "," + s + ")"), ks = Math.max(0, o - l - r), Ms = Math.max(0, i - s - a), Ts = Do().range([0, ks]), Ss(t), zs = Do().range([Ms, 0]), Es(t);
            var h = _.zoom_enabled ? 0 : Math.max(_.start_circle_r, _.line_width / 2, _.shade_width / 2) + _.margin_left;
            V("#clip rect").transition().duration(n).attr("transform", "translate(0,-" + s + ")").attr("height", Ms + s + a).attr("width", Ts(t) + h).attr("x", -h)
        }

        function Ss(t) {
            var e = f.horserace.column_names.stages.length,
                n = _.zoom_enabled ? Math.max(0, t - _.zoom_steps_to_show) : 0,
                i = Math.min(e, _.zoom_steps_to_show),
                r = [n, _.zoom_enabled ? Math.max(t + i, 2 * i) : e - 1];
            Ts.domain(r)
        }

        function Es(t) {
            var e, n, i;
            if ("ranks" == _.value_type) e = [_.y_axis_max_rank || Bl.max_rank, _.y_axis_min_rank || 1];
            else {
                if (_.zoom_enabled && _.zoom_y_axis) {
                    var r = Math.floor(t),
                        o = Math.ceil(t),
                        a = Bl.timeslices[r].min_score,
                        s = Bl.timeslices[r].max_score;
                    n = a + (Bl.timeslices[o].min_score - a) * (t - r);
                    var l = (i = s + (Bl.timeslices[o].max_score - s) * (t - r)) - n,
                        u = _.zoom_y_padding / 100;
                    n -= l * u, i += l * u
                } else n = gn(f.horserace, function(t) { return gn(t.stages, function(t) { return Lr(t) }) }), i = pn(f.horserace, function(t) { return pn(t.stages, function(t) { return Lr(t) }) });
                "" !== _.y_axis_min && null !== _.y_axis_min && (n = _.y_axis_min), "" !== _.y_axis_max && null !== _.y_axis_max && (i = _.y_axis_max), e = _.higher_scores_win ? [n, i] : [i, n]
            }
            zs.domain(e)
        }
        var Fs = Array.prototype.slice;

        function Ls(t) { return t }
        var Ps = 1,
            Ds = 2,
            Os = 3,
            Us = 4,
            Hs = 1e-6;

        function Rs(t) { return "translate(" + (t + .5) + ",0)" }

        function Ys(t) { return "translate(0," + (t + .5) + ")" }

        function qs() { return !this.__axis }

        function js(p, g) {
            var y = [],
                m = null,
                v = null,
                x = 6,
                b = 6,
                w = 3,
                k = p === Ps || p === Us ? -1 : 1,
                M = p === Us || p === Ds ? "x" : "y",
                T = p === Ps || p === Os ? Rs : Ys;

            function e(t) {
                var e = null == m ? g.ticks ? g.ticks.apply(g, y) : g.domain() : m,
                    n = null == v ? g.tickFormat ? g.tickFormat.apply(g, y) : Ls : v,
                    i = Math.max(x, 0) + w,
                    r = g.range(),
                    o = +r[0] + .5,
                    a = +r[r.length - 1] + .5,
                    s = (g.bandwidth ? function(e) {
                        var n = Math.max(0, e.bandwidth() - 1) / 2;
                        return e.round() && (n = Math.round(n)),
                            function(t) { return +e(t) + n }
                    } : function(e) { return function(t) { return +e(t) } })(g.copy()),
                    l = t.selection ? t.selection() : t,
                    u = l.selectAll(".domain").data([null]),
                    c = l.selectAll(".tick").data(e, g).order(),
                    h = c.exit(),
                    f = c.enter().append("g").attr("class", "tick"),
                    _ = c.select("line"),
                    d = c.select("text");
                u = u.merge(u.enter().insert("path", ".tick").attr("class", "domain").attr("stroke", "currentColor")), c = c.merge(f), _ = _.merge(f.append("line").attr("stroke", "currentColor").attr(M + "2", k * x)), d = d.merge(f.append("text").attr("fill", "currentColor").attr(M, k * i).attr("dy", p === Ps ? "0em" : p === Os ? "0.71em" : "0.32em")), t !== l && (u = u.transition(t), c = c.transition(t), _ = _.transition(t), d = d.transition(t), h = h.transition(t).attr("opacity", Hs).attr("transform", function(t) { return isFinite(t = s(t)) ? T(t) : this.getAttribute("transform") }), f.attr("opacity", Hs).attr("transform", function(t) { var e = this.parentNode.__axis; return T(e && isFinite(e = e(t)) ? e : s(t)) })), h.remove(), u.attr("d", p === Us || p == Ds ? b ? "M" + k * b + "," + o + "H0.5V" + a + "H" + k * b : "M0.5," + o + "V" + a : b ? "M" + o + "," + k * b + "V0.5H" + a + "V" + k * b : "M" + o + ",0.5H" + a), c.attr("opacity", 1).attr("transform", function(t) { return T(s(t)) }), _.attr(M + "2", k * x), d.attr(M, k * i).text(n), l.filter(qs).attr("fill", "none").attr("font-size", 10).attr("font-family", "sans-serif").attr("text-anchor", p === Ds ? "start" : p === Us ? "end" : "middle"), l.each(function() { this.__axis = s })
            }
            return e.scale = function(t) { return arguments.length ? (g = t, e) : g }, e.ticks = function() { return y = Fs.call(arguments), e }, e.tickArguments = function(t) { return arguments.length ? (y = null == t ? [] : Fs.call(t), e) : y.slice() }, e.tickValues = function(t) { return arguments.length ? (m = null == t ? null : Fs.call(t), e) : m && m.slice() }, e.tickFormat = function(t) { return arguments.length ? (v = t, e) : v }, e.tickSize = function(t) { return arguments.length ? (x = b = +t, e) : x }, e.tickSizeInner = function(t) { return arguments.length ? (x = +t, e) : x }, e.tickSizeOuter = function(t) { return arguments.length ? (b = +t, e) : b }, e.tickPadding = function(t) { return arguments.length ? (w = +t, e) : w }, e
        }
        var Bs = dr(_.y_axis_format);

        function Is(t) {
            var e, n = (e = t, js(Ps, e)).tickFormat(function(t) { return f.horserace.column_names.stages[t] || "" }),
                i = "tilted" == _.x_axis_rotate ? 30 : "vertical" == _.x_axis_rotate ? _.x_axis_label_size : 80,
                r = Math.floor(ks / i),
                o = ws / 2;
            V(".x.axis").call(n), $(".x.axis .tick").size() > r && n.ticks(r), V(".x.axis").call(n).selectAll(".tick text").style("text-anchor", "horizontal" == _.x_axis_rotate ? "middle" : "start").attr("dx", function() { return "tilted" == _.x_axis_rotate ? .68 * o + 2 : "horizontal" == _.x_axis_rotate ? 0 : "vertical" == _.x_axis_rotate ? o : void 0 }).attr("dy", function() { return "tilted" == _.x_axis_rotate ? .68 * -o - 2 : "horizontal" == _.x_axis_rotate ? -o : "0.25em" }).attr("y", 0).attr("transform", function() { return "tilted" == _.x_axis_rotate ? "rotate(-45)" : "vertical" == _.x_axis_rotate ? "rotate(-90)" : "rotate(0)" }).style("font-size", _.x_axis_label_size + "px").style("fill", _.x_axis_label_color)
        }

        function Xs(t, e, n) {
            var i, r = Hr.getFormatterFunction(),
                o = Bs(r),
                a = (i = t, js(Us, i)).tickSize(-e).tickFormat(function(t) { return "ranks" == _.value_type ? t % 1 == 0 ? t : "" : o(t) }).tickPadding(5);
            "ranks" == _.value_type && a.ticks(Math.min(f.horserace.length, _.y_axis_max_rank || 1 / 0)), V(".y.axis").transition().duration(n).call(a), $(".y.axis text").style("font-size", _.y_axis_label_size + "px").style("fill", _.y_axis_label_colors), $(".y.axis line").style("stroke", _.y_axis_stroke_color), $(".y.axis path").style("stroke", _.y_axis_stroke_color)
        }

        function Vs(t, e, n, i) { Is(t), Xs(e, n, i) }
        var Ws = 0;

        function $s() {
            var n = {},
                i = hu();
            for (var t in $(".labels-group").each(function(t) {
                    var e = t.ranks[i];
                    null != e && (e in n ? n[e].push(this) : n[e] = [this])
                }), n) {
                var e = n[t].sort(function(t, e) { return on(t.__data__.index, e.__data__.index) });
                if (1 < e.length)
                    for (var r = 0; r < e.length; r++) {
                        var o = .5 * (ys + ms) * (r - .5);
                        V(e[r]).select(".end-circle-container").attr("transform", "translate(" + o + ",0)"), V(e[r]).classed("tied", !0), V(e[r]).selectAll(".name-bg, .name-fg").attr("x", function() { if (!Il || _.zoom_enabled) return e.length * (.5 * (ys + ms)) + ys / 2; var t = this.getBBox().width; return -(ys + ms) - t })
                    }
            }
        }

        function Zs() { _.target_position = 0, Ws = 0, _.target_position = f.horserace.column_names.stages.length, tl() }
        var Qs, Js, Gs = null;

        function Ks(t) {
            var e, n = hu();
            if (!Qs) return Qs = t, Gs = requestAnimationFrame(Ks), void(Js = Ws < n);
            (e = Js ? n < (Ws += (t - Qs) / _.stage_duration) : (Ws -= (t - Qs) / _.stage_duration) < n) && (Ws = n), _.zoom_enabled && (Ss(Ws), Es(Ws));
            var i = e ? null : Js ? "ahead" : "behind",
                r = _.zoom_enabled ? 0 : Math.max(_.start_circle_r, _.line_width / 2, _.shade_width / 2) + _.margin_left;
            if (V("#clip rect").attr("width", Ts(Ws) + r).attr("x", -r), $l.interrupt().attr("transform", ru).selectAll(".rank-number").text(function(t) { return _.rank_outside_picture ? "" : nu(t, i) + " " }), _.zoom_enabled) {
                ou(), tu(0), eu(0);
                var o = Math.min(Ts(f.horserace.column_names.stages.length - 1), ks);
                Vs(Ts, zs, o, 0)
            }
            $l.selectAll(".name-rank").text(function(t) { return _.rank_outside_picture ? nu(t, i) + " " : "" }).each(function() { V(this.parentNode).attr("x", function() { if (!Il || _.zoom_enabled) return ys + ms / 2 + 4; var t = this.getBBox().width; return -ys - 4 - t }) }), e ? (Gs = null, $s()) : (Gs = requestAnimationFrame(Ks), Qs = t)
        }

        function tl() { Qs = null, Gs && cancelAnimationFrame(Gs), Gs = requestAnimationFrame(Ks) }
        var el = ".controls-container {\tdisplay: inline-block;}.controls-container, .controls-container * {\tbox-sizing: border-box;\ttext-align: left;\tvertical-align: bottom;}.button-container .button, .dropdown .current {\toverflow: hidden;\ttext-overflow: ellipsis;\theight: 100%;\twhite-space: nowrap;\ttext-align: left;\tfont-size: 12px;\tline-height: 21px;}.button-container .button, .dropdown .current, .dropdown .list .list-item {\twhite-space: nowrap;}.slider, .slider-play {\tpointer-events: all;\tvertical-align: bottom}.button {\tdisplay: inline-block;\tcursor: pointer}.button:hover {\topacity: .5}.button.selected, .button.selected:hover {\tcolor: #fff;\tcursor: default;\topacity: 1;\tbackground-image: linear-gradient(transparent, rgba(0, 0, 0, .05) 40%, rgba(0, 0, 0, .1))}.button-container {\tpointer-events: all;\twidth: auto;\tline-height: 0;\tmargin-bottom: 18px;\twidth: 100%;\ttext-align: center;}.button-container.button-group {\tdisplay: table;\tborder: 1px solid #ccc;\twidth: 100%;\ttable-layout: fixed;\tborder-radius: 3px;\tmargin-bottom: 20px;\toverflow: hidden;}.button-container .button {\tfont-size: 12px;\tborder: 1px solid #ccc;\tbackground: #fff;\tpadding: 0.1em 0.6em 0;\tcolor: #333;\tfont-weight: 400;\ttext-align: center;\theight: 24px;\tborder-radius: 3px;\tmargin: 0 1px 2px;}.button-container.button-group .button {\tborder: none;\tborder-left: 1px solid #ccc;\tborder-radius: 0;\tdisplay: table-cell;\ttext-align: center;\tvertical-align: middle;\tmargin: 0;\theight: 22px;}.button-container .button:hover {\tbackground: #eee;\topacity: .8}.button-container.button-group .button:first-child {\tborder: none}.button-container .button.selected, .button-container .button.selected:hover {\topacity: 1;\tbackground: #ececec;\tcolor: #333}.dropdown {\tpointer-events: all;\tdisplay: inline-table;\tcolor: #333;\tfont-weight: 400;\tfont-size: 16px;\tposition: relative}.dropdown .heading {\tmargin-bottom: .4em;\tfont-weight: 300}.dropdown .main {\tbackground: #fff;\tpadding: 0 20px 0 6px;\tcursor: pointer;\tposition: relative;\tborder: 1px solid #ccc;\tborder-radius: 3px;\theight: 24px;\tline-height: 26px}.dropdown .list, .dropdown .symbol {\tposition: absolute}.dropdown .current {\theight: 100%;\twidth: 100%;\tdisplay: inline-block;\tvertical-align: top;\tpadding: 0.1em 0 0;}.dropdown .symbol {\twidth: 30px;\theight: 100%;\tright: 0;\ttop: 0;\tbackground: 80% 40% no-repeat;\tbackground-size: auto 50%;\tdisplay: inline-block}.dropdown .list {\ttop: 100%;\tleft: 2px;\tmin-width: calc(100% - 4px);\tbackground: rgba(255, 255, 255, 1);\tpadding: 0 2px;\ttext-align: left;\tdisplay: none;\tline-height: 1.4em;\tmax-height: 160px;\toverflow-y: scroll;\tcolor: #333;\tbox-shadow: 0 1px 2px rgba(0, 0, 0, .2)}.dropdown .list .list-item {\tfont-size: 12px;\theight: 24px;\tpadding: 0 5px}.dropdown .list .list-item:hover {\tcursor: pointer;\tbackground: #eee}.dropdown.open .list {\tdisplay: block;\tz-index: 1}.dropdown .list .list-item.selected, .dropdown .list .list-item.selected:hover {\tcolor: #57c1fc;\tcursor: default;\topacity: 1}.dropdown .list .list-item.header, .dropdown .list .list-item.header:hover {\tfont-size: .66em;\tletter-spacing: 1px;\ttext-transform: uppercase;\tcolor: #888;\topacity: 1;\tcursor: default;\tfont-weight: 300;\tmargin-top: .5em}.dropdown .list .list-item.header:first-child {\tmargin-top: 0}.controls-container .dropdown {\tmargin: 0 0 20px;}.controls-container .dropdown .heading {\tcolor: #333}.slider-holder {\tmargin-bottom: 20px}.slider-play {\twidth: 24px;\theight: 24px;\tbackground-repeat: no-repeat;\tbackground-size: 100% 100%;\tbackground-position: center;\tcursor: pointer;\tdisplay: none;\tmargin-right: 2px}.slider, .slider-holder.animatable .slider-play {\tdisplay: inline-block}.slider-play:hover {\topacity: .7}.slider {\theight: 46px;\twidth: 100%;\tbottom: 0}.slider-holder.animatable .slider {\twidth: calc(100% - 37px)}.slider-holder.playing .slider {\tpointer-events: none}.slider .tick line {\tstroke: #333}.slider text {\tfill: #333}.slider .slider-end-labels {\tfont-size: 11px;\tfill: #9e9e9e}@media(min-width:520px) {\t.dropdown .main {\t\theight: 30px;\t}\t.slider-play {\t\twidth: 30px;\t\theight: 30px\t}\t.button-container .button, .dropdown .current {\t\tfont-size: 14px;\t\tline-height: 26px;\t\theight: 30px;\t}\t.button-container.button-group .button {\t\theight: 28px;\t}\t.dropdown .list .list-item {\t\theight: 30px;\t\tfont-size: 14px;\t\tline-height: 27px;\t}}";

        function nl(t) { return "url('data:image/svg+xml;base64," + window.btoa(t) + "')" }
        var il = !1;
        var rl = Object.freeze(["auto-buttons", "grouped-buttons", "floating-buttons", "dropdown", "slider", "none"]);

        function ol(t) {
            ! function(t) {
                if (!il && "undefined" != typeof document) {
                    var e = document.head || document.getElementsByTagName("head")[0],
                        n = document.createElement("style");
                    n.type = "text/css", e.appendChild(n), n.styleSheet ? n.styleSheet.cssText = t : n.appendChild(document.createTextNode(t)), il = !0
                }
            }(el);
            var n = {},
                i = { slider_step_time: 2, slider_loop: !0, slider_loop_pause: 0, slider_play_button: !0, slider_handle_colour: "#333", slider_label: !0, dropdown_icon_colour: "#333333" };
            Object.keys(i).forEach(function(e) {
                var t = e.replace(/_\w/g, function(t) { return t.charAt(1).toUpperCase() });
                n[t] = function(t) { return void 0 === t ? i[e] : (i[e] = t, n) }
            }), i.type = "auto_buttons", n.type = function(t) { return void 0 === t ? i.type : (i.type = -1 !== rl.indexOf(t) ? t : "auto-buttons", n) }, Object.defineProperty(i, "control", { get: function() { var t = i.type; return "dropdown" === t || "slider" === t || "none" === t ? i.type : "buttons" }, set: function() { console.warn("Nothing changed: control is read only") } }), Object.defineProperty(i, "buttons_type", { get: function() { if ("buttons" === i.control) return "auto-buttons" === i.type ? "auto" : "grouped-buttons" === i.type ? "grouped" : "floating" }, set: function() { console.warn("Nothing changed: button_type is read only") } }), i.index = 0, n.index = function(t) {
                if (void 0 === t) return i.n_options ? i.index : null;
                if (null !== t) {
                    if (!Number.isFinite(t)) throw TypeError("index must be a number greater than or equal to 0.");
                    if (t < 0) throw RangeError("index must be greater than or equal to 0.");
                    i.index = Math.floor(t)
                }
                return n
            }, i.options = [], Object.defineProperty(i, "n_options", { get: function() { return i.options.length }, set: function() { console.warn("Nothing changed: n_options is read only") } }), n.options = function(t) { if (void 0 === t) return i.options.slice(); if (!Array.isArray(t)) throw TypeError("opts must be an array."); return i.options = Object.freeze(t.slice()), n }, Object.defineProperty(i, "value", { get: function() { return i.n_options ? i.options[i.index] : null }, set: function() { console.warn("Nothing changed: value is read only") } }), n.value = function(t) { if (void 0 === t) return i.value; if (null !== t) { var e = i.options.indexOf(t); - 1 !== e ? i.index = e : console.warn("Nothing changed: value not in options list") } return n }, Object.defineProperty(i, "width", { get: function() { return o.getBoundingClientRect().width + "px" }, set: function() { console.warn("Nothing changed: width is read only") } }), i.changeHandlers = [], n.on = function(t, e) { return "change" === t && i.changeHandlers.push(e.bind(n)), n };
            Object.seal(i);
            var e, r = V(t);
            e = !r.classed("controls-container") && (r.classed("controls-container", !0), !0);
            var o = r.node();
            return n.container = r, {
                output_obj: n,
                props: i,
                onChangeCallbacks: function() {
                    var e = i.value,
                        n = i.index;
                    i.changeHandlers.forEach(function(t) { t(e, n) })
                },
                container: r,
                container_node: o,
                container_selector: t,
                added_class: e
            }
        }

        function al(t) {
            var e = t.container,
                n = t.props,
                i = t.onChangeCallbacks,
                r = e.append("div").attr("class", "dropdown"),
                o = r.append("div").attr("class", "main"),
                a = o.append("span").attr("class", "current"),
                s = o.append("span").attr("class", "symbol"),
                l = r.append("div").attr("class", "list"),
                u = function() { r.classed("open", !1) },
                c = r.node();
            document.querySelector("body").addEventListener("click", function(t) {
                if (r.classed("open")) {
                    for (var e = t.target, n = e.parentElement; n;) {
                        if (e === c) return;
                        n = (e = n).parentElement
                    }
                    u()
                }
            }, !1), o.on("click", function() { r.classed("open", !r.classed("open")) });
            var h, f = function() { h !== n.dropdown_icon_colour && (h = n.dropdown_icon_colour, s.style("background-image", nl('<svg width="6px" height="12px" viewBox="0 0 6 12" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"> <g transform="translate(-442.000000, -44.000000)" fill="' + h + '"> <g id="Group" transform="translate(442.000000, 44.000000)"> <polygon id="Triangle-2" points="3 0 6 5 0 5"></polygon> <polygon id="Triangle-2-Copy" points="3 12 0 7 6 7"></polygon> </g> </g> </svg>'))) },
                _ = { handle: r };
            return _.show = function() { return f(), r.style("width", n.width).style("display", "inline-table"), r.select(".main").style("width", n.width), _ }, _.hide = function() { return u(), r.style("display", "none"), _ }, _.setValue = function() { return a.text(n.value).attr("title", n.value), _ }, _.setOptions = function() { return l.text("").selectAll(".list-item").data(n.options).enter().append("div").attr("class", "list-item").text(function(t) { return t }).on("click", function(t, e) { u(), V(this).classed("selected") || (n.index = e, i()) }), _ }, _.remove = function() { return r.remove(), _ }, _
        }

        function sl(t, e) {
            var n, i, r = t.container,
                o = t.props,
                a = t.onChangeCallbacks,
                s = r.append("div").attr("class", "button-container"),
                l = function() { s.style("display", "none") },
                u = { handle: s };
            return u.show = function() { return "floating" === o.buttons_type ? s.style("width", null).style("display", "inline-block").classed("button-group", !1) : (s.style("width", o.width).style("display", "table").classed("button-group", !0), "auto" === o.buttons_type && (i.every(function(t) { return t.offsetWidth >= t.scrollWidth }) || (l(), e.show()))), u }, u.hide = function() { return l(), u }, u.setValue = function() { return n && n.each(function(t, e) { V(this).classed("selected", e === o.index) }), u }, u.setOptions = function() { return n = s.text("").selectAll(".button").data(o.options).enter().append("div").attr("class", "button").classed("selected", function(t, e) { return e === o.index }).text(function(t) { return t }).attr("title", function(t) { return t }).on("click", function(t, e) { e !== o.index && (o.index = e, a()) }), i = n.nodes(), u }, u.remove = function() { return s.remove(), u }, u
        }
        var ll = Array.prototype,
            ul = ll.map,
            cl = ll.slice;

        function hl(t) { return +t }
        var fl = [0, 1];

        function _l(e, n) { return (n -= e = +e) ? function(t) { return (t - e) / n } : (t = n, function() { return t }); var t }

        function dl(t, e, n, i) {
            var r = t[0],
                o = t[1],
                a = e[0],
                s = e[1];
            return a = o < r ? (r = n(o, r), i(s, a)) : (r = n(r, o), i(a, s)),
                function(t) { return a(r(t)) }
        }

        function pl(n, t, e, i) {
            var r = Math.min(n.length, t.length) - 1,
                o = new Array(r),
                a = new Array(r),
                s = -1;
            for (n[r] < n[0] && (n = n.slice().reverse(), t = t.slice().reverse()); ++s < r;) o[s] = e(n[s], n[s + 1]), a[s] = i(t[s], t[s + 1]);
            return function(t) { var e = ln(n, t, 1, r) - 1; return a[e](o[e](t)) }
        }

        function gl(s) {
            var l = s.domain;
            return s.ticks = function(t) { var e = l(); return fn(e[0], e[e.length - 1], null == t ? 10 : t) }, s.tickFormat = function(t, e) {
                return function(t, e, n) {
                    var i, r = t[0],
                        o = t[t.length - 1],
                        a = dn(r, o, null == e ? 10 : e);
                    switch ((n = vr(null == n ? ",f" : n)).type) {
                        case "s":
                            var s = Math.max(Math.abs(r), Math.abs(o));
                            return null != n.precision || isNaN(i = Sr(a, s)) || (n.precision = i), zr(n, s);
                        case "":
                        case "e":
                        case "g":
                        case "p":
                        case "r":
                            null != n.precision || isNaN(i = Er(a, Math.max(Math.abs(r), Math.abs(o)))) || (n.precision = i - ("e" === n.type));
                            break;
                        case "f":
                        case "%":
                            null != n.precision || isNaN(i = Nr(a)) || (n.precision = i - 2 * ("%" === n.type))
                    }
                    return Tr(n)
                }(l(), t, e)
            }, s.nice = function(t) {
                null == t && (t = 10);
                var e, n = l(),
                    i = 0,
                    r = n.length - 1,
                    o = n[i],
                    a = n[r];
                return a < o && (e = o, o = a, a = e, e = i, i = r, r = e), 0 < (e = _n(o, a, t)) ? e = _n(o = Math.floor(o / e) * e, a = Math.ceil(a / e) * e, t) : e < 0 && (e = _n(o = Math.ceil(o * e) / e, a = Math.floor(a * e) / e, t)), 0 < e ? (n[i] = Math.floor(o / e) * e, n[r] = Math.ceil(a / e) * e, l(n)) : e < 0 && (n[i] = Math.ceil(o * e) / e, n[r] = Math.floor(a * e) / e, l(n)), s
            }, s
        }

        function yl() {
            var e = function(e, n) {
                var i, o, a, s = fl,
                    l = fl,
                    u = Ue,
                    c = !1;

                function r() { return i = 2 < Math.min(s.length, l.length) ? pl : dl, o = a = null, t }

                function t(t) { return (o || (o = i(s, l, c ? (r = e, function(e, n) { var i = r(e = +e, n = +n); return function(t) { return t <= e ? 0 : n <= t ? 1 : i(t) } }) : e, u)))(+t); var r }
                return t.invert = function(t) { return (a || (a = i(l, s, _l, c ? (r = n, function(e, n) { var i = r(e = +e, n = +n); return function(t) { return t <= 0 ? e : 1 <= t ? n : i(t) } }) : n)))(+t); var r }, t.domain = function(t) { return arguments.length ? (s = ul.call(t, hl), r()) : s.slice() }, t.range = function(t) { return arguments.length ? (l = cl.call(t), r()) : l.slice() }, t.rangeRound = function(t) { return l = cl.call(t), u = He, r() }, t.clamp = function(t) { return arguments.length ? (c = !!t, r()) : c }, t.interpolate = function(t) { return arguments.length ? (u = t, r()) : u }, r()
            }(_l, Le);
            return e.copy = function() { return t = e, yl().domain(t.domain()).range(t.range()).interpolate(t.interpolate()).clamp(t.clamp()); var t }, gl(e)
        }

        function ml(t) { this.container = V(t), this._width = null, this._height = null, this._handleRadius = 15, this._channelHeight = 5, this._channelRadius = null, this._handleFill = "black", this._channelFill = "#eee", this._margin = { top: null, left: null, right: null }, this._domain = [0, 1], this._value = null, this._snap = !1, this._scale = null, this._axis = !1, this._ticks = null, this._tickFormat = null, this._tickSize = null, this._label = null, this._labelSize = 18, this._startLabel = null, this._startLabelBelow = !1, this._endLabel = null, this._endLabelBelow = !1, this._startEndLabelSize = 16, this.handlers = { change: [] } }

        function vl(e) { 0 < e.length && "_" == e.charAt(0) && (ml.prototype[e.substr(1)] = function(t) { return void 0 === t ? this[e] : (this[e] = t, this) }) }
        var xl, bl, wl, kl, Ml, Tl, zl, Cl, Al, Nl, Sl, El = new ml;
        for (var Fl in El) vl(Fl);

        function Ll(t, e) {
            return "boolean" == typeof t ? t ? Math.round(e) : e : function t(e, n, i, r) {
                if (void 0 === i && (i = 0), void 0 === r && (r = e.length), r - i == 0) return n;
                if (r - i == 1) return e[i];
                if (r - i == 2) return Math.abs(e[i] - n) <= Math.abs(e[i + 1] - n) ? e[i] : e[i + 1];
                var o = i + Math.floor((r - i) / 2),
                    a = e[o],
                    s = e[o - 1];
                return s <= n && n <= a ? Math.abs(s - n) <= Math.abs(a - n) ? s : a : a <= n ? t(e, n, o, r) : t(e, n, i, o)
            }(t, e)
        }

        function Pl(t) { return new ml(t) }

        function Dl(t) {
            var e, r, n = t.container,
                o = t.props,
                a = t.onChangeCallbacks,
                i = t.container_selector,
                s = n.append("div").attr("class", "slider-holder animatable"),
                l = s.append("div").attr("class", "slider-play");
            s.append("div").attr("class", "slider");
            var u, c = Pl(i + " .slider-holder .slider").channelHeight(6).snap(!0).on("change", function(t) { t !== o.index && (o.index = t, a()) }),
                h = function() { u && (clearInterval(u), u = void 0, s.classed("playing", !1), l.style("background-image", e)) },
                f = function(n) {
                    if (0 !== n || o.slider_loop) {
                        var t = 1e3 * (Math.abs(o.slider_step_time) + (n ? 0 : o.slider_loop_pause));
                        u = setTimeout(function() {
                            var t = o.n_options,
                                e = 0 <= o.slider_step_time ? n : t - (1 + n);
                            c.value(e).update(), o.index = e, a(), f((n + 1) % t)
                        }, t)
                    } else h()
                };
            l.on("click", function() {
                s.classed("playing") ? h() : o.slider_play_button && function() {
                    var t = o.n_options;
                    if (!(t < 2)) {
                        var e = t - 1,
                            n = o.index,
                            i = o.slider_step_time;
                        s.classed("playing", !0), l.style("background-image", r), 0 < i && n === e ? (n = 0, c.value(n).update(), o.index = n, a()) : i < 0 && 0 === n && (n = e, c.value(n).update(), o.index = n, a()), f((0 < i ? n : t - (1 + n)) + 1)
                    }
                }()
            });
            var _, d = function() { o.slider_play_button ? (s.classed("animatable", !0), l.style("transform", o.slider_step_time < 0 ? "rotate(180deg)" : null)) : (h(), s.classed("animatable", !1)), _ !== o.slider_handle_colour && (c.update(), _ = o.slider_handle_colour, s.select(".slider-handle").style("fill", _), e = nl('<svg width="25px" height="30px" viewBox="0 0 25 30" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"> <polygon id="Triangle" fill="' + _ + '" stroke="none" points="25 15 0 30 0 0"></polygon> </svg>'), r = nl('<svg width="26px" height="30px" viewBox="0 0 26 30" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"> <g stroke="none" stroke-width="1" fill="' + _ + '"><rect x="2" y="2" width="9" height="26"></rect> <rect x="15" y="2" width="9" height="26"></rect> </g> </svg>'), l.style("background-image", u ? r : e)) },
                p = function() {
                    var t;
                    ! function() {
                        s.style("width", o.width);
                        var t = window.innerWidth,
                            e = t < 520 ? 12 : 15;
                        c.labelSize(t < 520 ? 12 : 14).handleRadius(e).margin({ left: e + 5, right: e, top: t < 520 ? 33 : 31 })
                    }(), d(), t = !0 === o.slider_label ? o.value : "string" == typeof o.slider_label ? o.slider_label : null, c.label(t)
                },
                g = { handle: s };
            return g.show = function() { return s.style("display", "inline-block"), p(), c.update(), g }, g.hide = function() { return h(), s.style("display", "none"), g }, g.setValue = function() { return c.value(o.index), g }, g.setOptions = function() { return c.domain([0, o.n_options - 1]).update(), g }, g.remove = function() { return s.remove(), g }, g
        }

        function Ol(t) {
            var n, e, i, r = ol(t),
                o = r.output_obj,
                a = r.props,
                s = r.container,
                l = al(r),
                u = sl(r, l),
                c = Dl(r),
                h = (n = [], function() {
                    var t = a.options,
                        e = t.length;
                    if (!(e < 2)) return !(n && t.length === n.length && t.every(function(t, e) { return t === n[e] }) || (n = Object.freeze(t.slice()), a.index > e - 1 && (a.index = e - 1), 0))
                }),
                f = function() { if (e === a.index && i === a.value) return !1; var t = a.n_options; return a.index > t - 1 && (a.index = t - 1), e = a.index, i = a.value, !0 },
                _ = function(t) { "none" === t ? s.style("display", "none") : s.style("display", null), "dropdown" === t ? l.show() : l.hide(), "slider" === t ? c.show() : c.hide(), "buttons" === t ? u.show() : u.hide() },
                d = function() {
                    var t = h();
                    if (a.n_options < 2) return a.index = 0, void _("none");
                    (f() || t) && (t && (l.setOptions(), u.setOptions(), c.setOptions()), l.setValue(), u.setValue(), c.setValue()), _(a.control)
                };
            return window.addEventListener("resize", d), o.update = function() { return d(), this }, o.remove = function() { return l.remove(), u.remove(), c.remove(), r.added_class && s.classed("controls-container", !1), window.removeEventListener("resize", d), this }, o
        }

        function Ul() {
            var t, e;
            t = wl.getBoundingClientRect().width, e = kl.getBoundingClientRect().width, bl.style("width", Math.min(_.filter_width, t - e) + "px"), bl.node().getBoundingClientRect().width + e > t && bl.style("width", Math.min(_.filter_width, t) + "px");
            var n = function() {
                if (void 0 === f.horserace.column_names.filter) return null;
                var t = To(f.horserace, function(t) { return t.filter }),
                    e = [];
                return t.each(function(t) { e.push(t) }), e.length && _.filter_include_all && e.unshift(_.filter_all_label), e
            }();
            n ? xl.options(n).value(_.filter).type(_.filter_control_type).update() : xl.options([]).update(), _.filter = xl.value()
        }
        ml.prototype.margin = function(t) {
            if (!t) return this._margin;
            for (Fl in t) {
                if (!(Fl in this._margin)) throw "Slider.margin: unrecognised option " + Fl;
                this._margin[Fl] = t[Fl]
            }
            return this
        }, ml.prototype.on = function(t, e) { if (!(t in this.handlers)) throw "Slider.on: No such event: " + t; return this.handlers[t].push(e), this }, ml.prototype.fire = function(t, e) { if (!(t in this.handlers)) throw "Slider.fire: No such event: " + t; for (var n = this.handlers[t], i = 0; i < n.length; i++) n[i].call(this, e); return this }, ml.prototype.update = ml.prototype.draw = function() {
            var r = this,
                t = this._width,
                e = this._height,
                n = this.container.node();
            if (!t) {
                var i = n.getBoundingClientRect();
                if (!i || 0 == i.width) return this;
                t = i.width, e = i.height
            }
            var o, a = null == this._channelRadius ? this._channelHeight / 2 : this._channelRadius,
                s = null == this._margin.left ? Math.max(this._handleRadius, a) : this._margin.left,
                l = null == this._margin.right ? Math.max(this._handleRadius, a) : this._margin.right,
                u = null == this._margin.top ? Math.max(this._handleRadius, this._channelHeight / 2) : this._margin.top,
                c = t - s - l,
                h = c + 2 * a,
                f = 1.5 * this._labelSize;
            null != this._label && null == this._margin.top && (u += f), "http://www.w3.org/2000/svg" == n.namespaceURI ? o = this.container : ((o = this.container.selectAll("svg").data([{ width: t, height: e }])).exit().remove(), (o = o.enter().append("svg").merge(o)).attr("width", function(t) { return t.width }).attr("height", function(t) { return t.height }));
            var _ = o.selectAll("g.slider-container").data([{ left: s, top: u, id: this._id }]);
            _.exit().remove(), (_ = _.enter().append("g").attr("class", "slider-container").merge(_)).attr("transform", function(t) { return "translate(" + t.left + "," + t.top + ")" }).attr("id", function(t) { return t.id }), this.scale = (this._scale ? this._scale() : yl()).domain(this._domain).range([0, c]), null == this._value || this._value < this._domain[0] ? this._value = this._domain[0] : this._value > this._domain[1] && (this._value = this._domain[1]), this._snap && (this._value = Ll(this._snap, this._value));
            var d, p, g = [];
            this._axis && (d = "boolean" != typeof this._axis ? this._axis(this.scale) : js(Os, p).scale(this.scale).tickPadding(6), this._ticks && d.ticks(this._ticks), this._tickFormat && d.tickFormat(this._tickFormat), this._tickSize ? d.tickSize(this._tickSize) : d.tickSize(Math.max(5, this._handleRadius - this._channelHeight - 2)), g.push(d));
            var y, m, v, x, b = _.selectAll(".slider-axis").data(g).enter();

            function w() { document.removeEventListener("mouseup", w, !1), document.removeEventListener("mousemove", k, !1) }

            function k(t) { z(t.clientX - v) }

            function M() { document.removeEventListener("touchend", M, !1), document.removeEventListener("touchmove", T, !1) }

            function T(t) { 1 == t.touches.length && z(t.touches[0].clientX - v) }

            function z(t) {
                var e = x + t,
                    n = Math.max(0, Math.min(c, e)),
                    i = r.scale.invert(n);
                r._snap && (i = Ll(r._snap, i)), m.attr("cx", r.scale(i)), i != r._value && (r._value = i, r.fire("change", r._value))
            }
            b.append("g").attr("class", "slider-axis").attr("transform", "translate(0," + this._channelHeight / 2 + ")").each(function(t) { t(V(this)) }), b.select(".domain").attr("fill", "none"), b.selectAll(".tick line").attr("stroke", "black"), b.exit().remove(), (y = _.selectAll(".slider-channel").data([{ width: h, height: this._channelHeight, channel_r: a }])).exit().remove(), (y = y.enter().append("rect").attr("class", "slider-channel").attr("fill", this._channelFill).attr("cursor", "pointer").on("click", function() {
                var t = Math.max(0, Math.min(c, W(this)[0]));
                r._value = r.scale.invert(t), r._snap && (r._value = Ll(r._snap, r._value)), m.attr("cx", r.scale(r._value)), r.fire("change", r._value)
            }).merge(y)).attr("width", function(t) { return t.width }).attr("height", function(t) { return t.height }).attr("y", function(t) { return -t.height / 2 }).attr("x", function(t) { return -t.channel_r }).attr("rx", function(t) { return t.channel_r }), (m = (m = _.selectAll(".slider-handle").data([{ v: this._value, x: this.scale(this._value) }])).enter().append("circle").attr("class", "slider-handle").attr("cursor", "col-resize").merge(m)).attr("cx", function(t) { return t.x }).attr("r", this._handleRadius).attr("fill", this._handleFill).on("mousedown", function() {
                var t;
                U.preventDefault(), t = U, document.addEventListener("mouseup", w, !1), document.addEventListener("mousemove", k, !1), v = t.clientX, x = r.scale(r._value)
            }).on("touchstart", function() {
                var t;
                U.preventDefault(), 1 == (t = U).touches.length && (document.addEventListener("touchend", M, !1), document.addEventListener("touchmove", T, !1), v = t.touches[0].clientX, x = r.scale(r._value))
            });
            var C = [];
            this._label && C.push({ label: this._label, x: c / 2, y: -f, font_size: this._labelSize });
            var A = _.selectAll(".slider-label").data(C);
            A.exit().remove(), (A = A.enter().append("text").attr("class", "slider-label").attr("text-anchor", "middle").attr("cursor", "default").merge(A)).text(function(t) { return t.label }).attr("x", function(t) { return t.x }).attr("y", function(t) { return t.y }).attr("font-size", this._labelSize);
            var N = [];
            this._startLabel && N.push({ label: this._startLabel, x: this._startLabelBelow ? 0 : -(a + 5 + Math.max(0, this._handleRadius - a)), y: this._startLabelBelow ? a + 15 : this._startEndLabelSize / 1.75 - a / 2, anchor: this._startLabelBelow ? "middle" : "end", font_size: this._startEndLabelSize }), this._endLabel && N.push({ label: this._endLabel, x: this._endLabelBelow ? c : c + (a + Math.max(0, this._handleRadius - a) + 5), y: this._startLabelBelow ? a + 15 : this._startEndLabelSize / 1.75 - a / 2, anchor: this._endLabelBelow ? "middle" : "start", font_size: this._startEndLabelSize });
            var S = _.selectAll(".slider-end-labels").data(N);
            return S.exit().remove(), (S = S.enter().append("text").attr("class", "slider-end-labels").attr("pointer-events", "none").merge(S)).text(function(t) { return t.label }).attr("font-size", function(t) { return t.font_size }).attr("x", function(t) { return t.x }).attr("y", function(t) { return t.y }).attr("text-anchor", function(t) { return t.anchor }), this
        }, Pl.version = "1.3.2";
        var Hl = function(t) {
            for (var e in no = t, eo) void 0 === no[e] && (no[e] = eo[e]);
            return (Dr = document.createElement("style")).id = "flourish-page-styles", Dr.type = "text/css", document.head.appendChild(Dr), (Ur = document.createElement("link")).setAttribute("rel", "stylesheet"), document.body.appendChild(Ur), ro.wrapper = function() {
                var t = document.querySelector("#fl-layout-wrapper") || document.createElement("main");
                t.id = "fl-layout-wrapper";
                var e = t.style;
                return e.display = "flex", e.flexDirection = "column", e.boxSizing = "border-box", e.marginLeft = "auto", e.marginRight = "auto", t
            }(), io.forEach(function(t, e) {
                ro[t] = function(t, e) {
                    var n = "fl-layout-" + t,
                        i = document.createElement("section");
                    i.className = "fl-layout-container", i.id = n + "-container", i.style.width = "100%", i.style.position = "relative", i.style.order = e;
                    var r = document.createElement("div");
                    return r.className = "fl-layout-inner", r.id = n, r.style.width = "100%", r.style.overflow = "hidden", i.appendChild(r), ro.wrapper.appendChild(i), { outer: i, inner: r }
                }(t, e)
            }), lo("header").appendChild(function() {
                (Yr = document.createElement("header")).className = "flourish-header";
                var t = document.createElement("hgroup");
                return qr = document.createElement("h1"), jr = document.createElement("h2"), Br = document.createElement("p"), Yr.appendChild(t), t.appendChild(qr), t.appendChild(jr), Yr.appendChild(Br), Yr
            }()), lo("footer").appendChild(Kr()), ro.primary.outer.style.overflow = "hidden", ro.controls.inner.style.overflow = null, document.body.appendChild(ro.wrapper), to(), { update: to, getWrapper: so, getSection: lo, getOuterWidth: uo, getInnerWidth: co, getOuterHeight: ho, getInnerHeight: fo, getPrimaryHeight: _o, getPrimaryWidth: po, getDefaultPrimaryHeight: yo, setHeight: mo, setLegendPosition: vo }
        }(_.layout);

        function Rl() { U.target && (U.target.getAttribute("class"), "check-rect" == U.target.getAttribute("class")) || (_.selected_horse = null, _u()) }

        function Yl() {
            Sl = V(Hl.getSection("controls")).append("div").attr("id", "viz-ui"), Ml = V(Hl.getSection("primary")).append("svg").on("click", Rl), (Tl = Ml.append("g").attr("id", "plot")).append("clipPath").attr("id", "clip").append("rect").attr("width", 0), Tl.append("clipPath").attr("id", "circleClip").append("circle"), Nl = Tl.append("g").attr("class", "g-checks"), Tl.append("g").attr("class", "x axis").style("pointer-events", "none"), Tl.append("g").attr("class", "y axis").style("pointer-events", "none"), zl = Tl.append("g").attr("class", "g-lines").attr("clip-path", "url(#clip)"), Al = Tl.append("g").attr("class", "g-start-circles"), Cl = Tl.append("g").attr("class", "g-labels");
            var t = Sl.append("div").attr("id", "horse-controls");
            t.append("button").attr("id", "replay").text(_.label_replay).on("click", Zs);
            var e, n = t.append("div").attr("id", "rank-toggle");
            n.append("button").attr("id", "ranks").text(_.label_ranks).attr("data-type", "ranks"), n.append("button").attr("id", "scores").text(_.label_scores).attr("data-type", "scores"), n.selectAll("button").on("click", function() { _.value_type = V(this).attr("data-type"), _u() }).classed("selected", function() { return V(this).attr("data-type") === ("ranks" == _.value_type ? _.label_ranks : _.label_scores) }), Sl.append("div").attr("id", "filter-control").style("display", "inline-block"), xl = Ol(e = "#filter-control").on("change", function(t) { _.filter = t, _u() }), bl = V(e), wl = Sl.node(), kl = Sl.select("#horse-controls").node()
        }
        var ql = (1 + Math.sqrt(5)) / 2;
        var jl = Object.freeze({ palette: ["#1D6996", "#EDAD08", "#73AF48", "#94346E", "#38A6A5", "#E17C05", "#5F4690", "#0F8554", "#6F4070", "#CC503E", "#994E95", "#666666"], extend: !0, advanced: !1, hue_rotation_angle: 222.49, custom_palette: "" });
        var Bl, Il, Xl = function(h, e) {
            var f = {},
                r = function(t) { return "function" == typeof e ? e(t) : e ? t.toLowerCase().replace(/\s+/g, "") : t };
            for (var t in jl) void 0 === h[t] && (h[t] = jl[t]);
            return {
                find: function(t) { return f[r(t)] },
                updateColors: function(t) {
                    f = {};
                    var l, e = To(t.map(r)).values(),
                        u = h.palette,
                        c = u.length;
                    h.extend ? e.forEach(function(t, e) {
                        if (e < c) f[t] = u[e];
                        else {
                            if (e === c) {
                                for (var n, i = u.map(function(t) { return ve(t) }), r = i.reduce(function(t, e) { return t + e.c }, 0) / c, o = i.reduce(function(t, e) { return t + e.l }, 0) / c, a = c; n = i[--a].h, isNaN(n) && 0 < a;);
                                var s = h.advanced ? h.hue_rotation_angle : jl.hue_rotation_angle;
                                (l = function(t, e) {
                                    e = void 0 !== e ? e : 360 / ql;
                                    var n = ve(t = t || "#FF0000"),
                                        i = n.h,
                                        r = n.c,
                                        o = n.l,
                                        a = 0;
                                    return function() { var t = a++ * e; return $t(ve((i + t) % 360, r, o)).hex() }
                                }(ve(n, r, o).toString(), s))()
                            }
                            f[t] = l()
                        }
                    }) : e.forEach(function(t, e) { f[t] = u[e % c] }), h.custom_palette.split("\n").filter(function(t) { return t }).forEach(function(t) {
                        var e = t.lastIndexOf(":");
                        if (-1 !== e) {
                            var n = r(t.slice(0, e).trim()),
                                i = t.slice(e + 1).trim();
                            n && i && (f[n] = i)
                        }
                    })
                }
            }
        }(_.color, !0);
        var Vl, Wl, $l, Zl, Ql = null,
            Jl = [],
            Gl = Vn().x(function(t) { return Ts(t.i) }).y(function(t) { return zs(t.value) }).defined(function(t) { return null != t.value }),
            Kl = dr(_.label_format);

        function tu(t) {
            var e = zl.selectAll(".line-group").data(Bl, function(t) { return t.name }),
                n = e.enter().append("g").attr("class", "horse line-group").on("mouseenter", lu).on("mouseleave", uu).on("click", cu).attr("clip-path", "url(#clip)").attr("stroke-linejoin", "round").attr("stroke-linecap", "round").attr("fill", "none");
            n.append("path").attr("class", "missing"), n.append("path").attr("class", "line"), n.append("path").attr("class", "shade"), (Zl = e.merge(n)).attr("opacity", su).attr("stroke", function(t) { return Xl.find(t.name) }), Zl.select(".line").transition().duration(t).attr("d", function(t) { return Gl(t.line) }).attr("opacity", _.line_opacity).attr("stroke-width", xs), Zl.select(".shade").transition().duration(t).attr("d", function(t) { return Gl(t.line) }).attr("display", _.shade ? "block" : "none").attr("opacity", _.shade_opacity).attr("stroke-width", bs), Zl.select(".missing").transition().duration(t).attr("d", function(t) { return Gl(t.missing_line) }).attr("opacity", _.missing ? _.missing_opacity : 0).attr("stroke-dasharray", _.missing_dash_width + "," + _.missing_dash_space).attr("stroke-width", Il ? Math.max(Math.round(_.missing_width / 2), 2) : _.missing_width), e.exit().remove()
        }

        function eu(t) {
            var e = Al.selectAll(".start-circle").data(Bl, function(t) { return t.name }),
                n = e.enter().append("circle").attr("class", "horse start-circle").attr("cy", function(t) { return zs(t.start_circle.value) }).attr("cx", function(t) { return Ts(t.start_circle.i) }).attr("clip-path", "url(#clip)");
            e.merge(n).attr("opacity", su).transition().duration(t).attr("cy", function(t) { return zs(t.start_circle.value) }).attr("cx", function(t) { return Ts(t.start_circle.i) }).attr("r", vs).attr("fill", function(t) { return Xl.find(t.name) }), e.exit().remove()
        }

        function nu(t, e) { var n = t.line[Math.floor(Ws)]; "ahead" == e ? n = t.line[Math.floor(Ws + 1)] : "behind" == e && (n = t.line[Math.floor(Ws)]); var i = n && n.value || t.line[iu(t)].value; return "" == i ? "" : Wl(i) }

        function iu(t) {
            for (var e = 0, n = Math.floor(Ws); 0 < n; n--)
                if (null != t.line[n].value) { e = n; break } return e
        }

        function ru(t) {
            var e = Ws < t.start_circle.i ? 0 : 1,
                n = Math.floor(Ws),
                i = t.line[n].value,
                r = t.line[n + 1] ? t.line[n + 1].value : null,
                o = Ws - Math.floor(Ws),
                a = Math.floor(Ws),
                s = i;
            if (null == i || n < t.stages.length && null == r && 0 < o) {
                var l = iu(t);
                a = l, s = t.line[l].value
            } else a = Ws, s = i + (r - i) * o;
            return "translate(" + Ts(a) + "," + zs(s) + ") scale(" + e + ")"
        }

        function ou() {
            var n = _.zoom_enabled ? Ts(Math.max(Ws - _.zoom_steps_to_show + 1, 1)) : Ts(1),
                t = Nl.selectAll(".check").data(f.horserace.column_names.stages),
                e = t.enter().append("g").attr("class", "check");
            e.append("rect").attr("class", "check-rect"), e.append("line"), e.append("circle");
            var i = t.merge(e);
            i.on("mouseenter", function(t, e) { Ql = "check-" + e, V(this).select("line").attr("opacity", "1"), V(this).select("circle").attr("opacity", "1") }).on("mouseleave", function() { Ql = null, V(this).select("line").attr("opacity", "0"), V(this).select("circle").attr("opacity", "0") }).on("click", function(t, e) { _.target_position = e + 1, _u() }), i.attr("transform", function(t, e) { return "translate(" + (Ts(e) - n / 2) + ", -60)" }), i.select("rect").attr("x", 0).attr("y", 0).attr("height", Ms + 60).attr("fill", "none").style("pointer-events", "all").attr("width", n), i.select("line").attr("x1", n / 2).attr("x2", n / 2).attr("y1", 40).attr("y2", Ms + 60).attr("stroke", "#e1e1e1").attr("opacity", function(t, e) { return "check-" + e === Ql ? 1 : 0 }).style("pointer-events", "none"), i.select("circle").attr("r", 3).attr("cx", n / 2).attr("cy", 40).attr("fill", "#e1e1e1").attr("opacity", function(t, e) { return "check-" + e === Ql ? 1 : 0 }).style("pointer-events", "none"), t.exit().remove()
        }

        function au(t) {
            var e, n;
            (n = f.horserace.column_names.stages.length) - 1 < Ws && (Ws = n - 1), e && (Ws = 1), tu(t), eu(t),
                function(t) {
                    var e = Cl.selectAll(".labels-group").data(Bl, function(t) { return t.name }),
                        n = e.enter().append("g").attr("class", "horse labels-group").on("mouseenter", lu).on("mouseleave", uu).on("click", cu).attr("transform", ru),
                        i = n.append("g").attr("class", "end-circle-container");
                    if (i.append("circle").attr("class", "circle bg"), i.append("circle").attr("class", "end circle"), i.append("image").attr("clip-path", "url(#circleClip)").attr("preserveAspectRatio", "xMidYMid slice"), i.append("text").attr("class", "rank-number").attr("alignment-baseline", "central").attr("fill", "white").attr("dominant-baseline", "central").attr("text-anchor", "middle"), n.append("g").attr("class", "name"), n.select(".name").append("text").attr("class", "name-bg").attr("alignment-baseline", "central").attr("dominant-baseline", "central").attr("stroke-width", "5px"), n.select(".name").append("text").attr("class", "name-fg").attr("alignment-baseline", "central").attr("dominant-baseline", "central"), n.selectAll(".name-fg, .name-bg").append("tspan").attr("class", "name-rank").attr("font-weight", "bold"), n.selectAll(".name-fg, .name-bg").append("tspan").attr("class", "name-label"), ($l = e.merge(n)).attr("fill", function(t) { return Xl.find(t.name) }).classed("tied", !1).each(function(t) {
                            var e = !1;
                            0 < Jl.length && -1 < Jl.indexOf(String(t.unfiltered_index)) && (e = !0), 0 == Jl.length && null != _.mouseover_horse && t.unfiltered_index == _.mouseover_horse && (e = !0), e && this.parentNode.appendChild(this)
                        }).transition().duration(t).attr("transform", ru), $l.select(".end-circle-container").attr("transform", null), $l.select(".end.circle").attr("r", ys).attr("fill", function(t) { return Xl.find(t.name) }).attr("opacity", su).attr("stroke-width", ms).attr("stroke", function(t) { return _.end_circle_stroke_bg && _.layout.background_color_enabled ? _.layout.background_color : Xl.find(t.name) }), $l.select(".bg.circle").attr("r", ys).attr("fill", _.layout.background_color_enabled ? _.layout.background_color : "#ffffff"), $l.select(".name-bg").attr("stroke", _.layout.background_color_enabled ? _.layout.background_color : "transparent"), _.horse_images) {
                        var r = 2 * ys - ms;
                        $l.select("image").attr("xlink:href", function(t) { return t.pic }).style("display", "inherit").attr("opacity", su).attr("height", r).attr("width", r).attr("x", -r / 2).attr("y", -r / 2), Tl.select("#circleClip circle").attr("r", ys - ms / 2)
                    } else $l.select("image").style("display", "none");
                    var o = Il ? Math.min(_.rank_font_size, 12) : _.rank_font_size,
                        a = Il ? Math.min(_.label_font_size, 12) : _.label_font_size;
                    $l.select(".rank-number").attr("font-size", o).text(function(t) { return _.rank_outside_picture ? "" : nu(t) + " " }), $l.select(".name-bg .name-label").text(function(t) { return t.name }), $l.select(".name-fg .name-label").text(function(t) { return t.name }), $l.select(".name-bg .name-rank").attr("font-size", o).text(function(t) { return _.rank_outside_picture ? nu(t) + " " : "" }), $l.select(".name-fg .name-rank").attr("font-size", o).text(function(t) { return _.rank_outside_picture ? nu(t) + " " : "" }), $l.selectAll(".name-fg, .name-bg").attr("font-size", a).attr("x", function() { if (!Il || _.zoom_enabled) return ys + ms / 2 + 4; var t = this.getBBox().width; return -ys - 4 - t }).attr("y", 0), $l.select(".name-fg").attr("opacity", su), $l.select(".name-bg").attr("opacity", su), e.exit().remove()
                }(t), ou()
        }

        function su(t) { return 0 < Jl.length ? -1 < Jl.indexOf(String(t.unfiltered_index)) ? 1 : .1 : null != _.mouseover_horse ? t.unfiltered_index == _.mouseover_horse ? 1 : .1 : _.hide_labels && (V(this).classed("name-bg") || V(this).classed("name-fg")) ? t.unfiltered_index == _.mouseover_horse ? 1 : 0 : 1 }

        function lu(t, n) { t.unfiltered_index !== _.mouseover_horse && (_.mouseover_horse = t.unfiltered_index, 0 == Jl.length && ($l.select(".end.circle").attr("opacity", su), $l.select("image").attr("opacity", su), $l.select(".name-fg").attr("opacity", su), $l.select(".name-bg").attr("opacity", su), $l.each(function(t, e) { n === e && this.parentNode.appendChild(this) }), Zl.attr("opacity", su), $(".start-circle").attr("opacity", su))) }

        function uu() {
            if (_.mouseover_horse = null, 0 == Jl.length) {
                $l.select(".end.circle").attr("opacity", su), $l.select("image").attr("opacity", su), $l.select(".name-fg").attr("opacity", su), $l.select(".name-bg").attr("opacity", su), Zl.attr("opacity", su);
                var e = [];
                $l.each(function(t) { V(this).classed("tied") && e.push([t.index, this]) }), e.sort(function(t, e) { return on(t[0], e[0]) }).forEach(function(t) { t[1].parentNode.appendChild(t[1]) }), $(".start-circle").attr("opacity", su)
            }
        }

        function cu(t) {
            (_.mouseover_horse = null, U.stopPropagation(), null == _.selected_horse) ? Jl = [String(t.unfiltered_index)]: -1 < Jl.indexOf(String(t.unfiltered_index)) ? 1 < Jl.length ? Jl.splice(Jl.indexOf(String(t.unfiltered_index)), 1) : Jl = [] : Jl.push(String(t.unfiltered_index));
            _.selected_horse = Jl.join(), _u()
        }

        function hu() { var t = f.horserace.column_names.stages.length; return null == _.target_position ? t - 1 : Math.max(0, Math.min(t - 1, _.target_position - 1)) }

        function fu(t) {
            Il = window.innerWidth <= 420, Vl = Hr.getFormatterFunction(), Wl = Kl(Vl), V("#viz-ui").style("margin-top", _.show_buttons || _.show_replay ? null : 0), V("#rank-toggle").style("display", _.show_buttons ? null : "none").selectAll("button").classed("selected", function() { return V(this).attr("data-type") === ("ranks" == _.value_type ? "ranks" : "scores") }), V("#ranks").text(_.label_ranks), V("#scores").text(_.label_scores), V("#replay").style("display", _.show_replay ? null : "none").text(_.label_replay), Ul(), Hl.update(), Bl = Rr(), Jl = _.selected_horse ? _.selected_horse.split(",") : [], Ns(Ws, Bl.max_rank, t), Gl.curve(hr[_.curve]), Xl.updateColors(f.horserace.map(function(t) { return t.name }));
            var e = _.zoom_enabled ? Math.min(Ts(f.horserace.column_names.stages.length - 1), ks) : ks;
            Vs(Ts, zs, e, t), au(t), Ws != hu() ? tl() : $s()
        }

        function _u() { fu(_.update_duration) }
        return t.data = f, t.state = _, t.draw = function() { window.onresize = function() { fu(0) }, Yl(), _u() }, t.update = _u, t
    }({});
    //# sourceMappingURL=template.js.map
    </script>
    <script>
    var path = document.location.href.match(/\/visualisation\/(\d+)/);
    if (path) {
        path = path[0];
        (function(i, s, o, g, r, a, m) {
            i['GoogleAnalyticsObject'] = r;
            i[r] = i[r] || function() {
                (i[r].q = i[r].q || []).push(arguments)
            }, i[r].l = 1 * new Date();
            a = s.createElement(o),
                m = s.getElementsByTagName(o)[0];
            a.async = 1;
            a.src = g;
            m.parentNode.insertBefore(a, m)
        })(window, document, 'script', 'https://www.google-analytics.com/analytics.js', 'ga');

        ga("create", "UA-44635456-19", "auto", { storage: "none" });
        ga("set", "transport", "beacon");
        ga("set", "dimension1", path.substr(1));
        ga("set", "dimension2", new Date().toISOString());
        ga("send", "pageview", path);
    }
    </script>
    <script src="https://public.flourish.studio/resources/v3/embedded.js"></script>
    <script>
    function _Flourish_unflattenInto(dest, src) {
        dest = dest || {};
        for (var k in src) {
            var t = dest;
            for (var i = k.indexOf("."), p = 0; i >= 0; i = k.indexOf(".", p = i + 1)) {
                var s = k.substring(p, i);
                if (!(s in t)) t[s] = {};
                t = t[s];
            }
            t[k.substring(p)] = src[k];
        }
        return dest;
    }
    var _Flourish_settings = {
        "end_circle_r": 15,
        "value_type": "ranks",
        "y_axis_max_rank": 10,
        "zoom_enabled": true,
        "zoom_y_axis": false
    };
    _Flourish_unflattenInto(window.template.state, _Flourish_settings);

    var _Flourish_data_column_names = { "horserace": { "name": "month", "pic": "image", "stages": ["Jan 2018", "Feb 2018", "Mar 2018", "Apr 2018", "May 2018", "Jun 2018", "Jul 2018", "Aug 2018", "Sep 2018", "Oct 2018", "Nov 2018", "Dec 2018", "Jan 2019", "Feb 2019", "Mar 2019"] } },
        _Flourish_data = { "horserace": [{ "name": "Daenerys Targaryen", "pic": "https://upload.wikimedia.org/wikipedia/en/0/0d/Daenerys_Targaryen_with_Dragon-Emilia_Clarke.jpg", "stages": ["9.649973291", "7.561360737", "6.863107857", "6.874083241", "7.445359895", "7.545340636", "8.264385788", "8.082249931", "8.161844604", "9.303974123", "7.553144686", "9.283326814", "12.65141439", "11.53935356", "16.33602088"] }, { "name": "Jon Snow", "pic": "https://upload.wikimedia.org/wikipedia/en/thumb/f/f0/Jon_Snow-Kit_Harington.jpg/220px-Jon_Snow-Kit_Harington.jpg", "stages": ["8.819231152", "6.719694831", "5.69859572", "6.054615609", "5.365130193", "7.69255922", "7.091685475", "6.899833934", "6.223068894", "6.574393388", "6.368739674", "8.025735995", "12.80955824", "10.88285442", "15.95217879"] }, { "name": "Gregor Clegane", "pic": "http://pm1.narvii.com/6364/d683a242fda982ab6746bc82f73df2ab1c670f8a_00.jpg", "stages": ["3.112426269", "2.571962772", "4.020370696", "2.504668493", "3.585913248", "3.229997645", "2.698198986", "3.215632916", "2.801921919", "2.654124291", "2.670674818", "3.353884622", "4.150929159", "5.57819022", "7.424513939"] }, { "name": "Sansa Stark", "pic": "https://upload.wikimedia.org/wikipedia/en/thumb/7/74/SophieTurnerasSansaStark.jpg/220px-SophieTurnerasSansaStark.jpg", "stages": ["2.615728782", "2.157162806", "1.813884279", "1.968103375", "1.932726821", "2.015383923", "2.49704587", "2.226593901", "2.296800214", "1.961002021", "2.557584187", "2.835667855", "4.482546947", "3.658222548", "6.702745512"] }, { "name": "Arya Stark", "pic": "https://upload.wikimedia.org/wikipedia/en/thumb/3/39/Arya_Stark-Maisie_Williams.jpg/220px-Arya_Stark-Maisie_Williams.jpg", "stages": ["2.777685525", "2.109995864", "2.001658849", "1.771738799", "1.697857386", "2.027645423", "2.477764654", "2.302932281", "1.937397786", "2.046423074", "2.411988725", "2.820321199", "4.028391827", "3.846455224", "6.01528197"] }, { "name": "Night King", "pic": "https://vignette.wikia.nocookie.net/villains/images/8/87/Night%27s_King.png/revision/latest?cb=20150604122004", "stages": ["1.822076061", "1.402880877", "1.164027818", "1.280790833", "1.316609733", "1.540944429", "1.687739589", "1.713456088", "1.384309246", "4.935323007", "3.153606189", "4.439670125", "4.229080963", "3.587590418", "5.756513712"] }, { "name": "Cersei Lannister", "pic": "https://upload.wikimedia.org/wikipedia/en/thumb/9/94/Cersei_Lannister-Lena_Headey.jpg/220px-Cersei_Lannister-Lena_Headey.jpg", "stages": ["2.464722465", "2.066177711", "1.946880465", "2.032421038", "2.070967061", "2.042979843", "2.501320109", "2.261706052", "1.990517718", "2.137301655", "2.276053764", "2.813058837", "4.176435384", "3.858334624", "5.431657397"] }, { "name": "Joffrey Baratheon", "pic": "https://upload.wikimedia.org/wikipedia/en/thumb/b/bd/Joffrey_Baratheon-Jack_Gleeson.jpg/220px-Joffrey_Baratheon-Jack_Gleeson.jpg", "stages": ["2.142864279", "1.758647506", "1.451572206", "1.521712075", "1.317595267", "1.625869413", "1.930013838", "1.782803397", "1.614314135", "1.406348822", "1.62581338", "2.718905124", "3.790853448", "3.763861002", "4.75456317"] }, { "name": "Tyrion Lannister", "pic": "https://upload.wikimedia.org/wikipedia/en/thumb/5/50/Tyrion_Lannister-Peter_Dinklage.jpg/220px-Tyrion_Lannister-Peter_Dinklage.jpg", "stages": ["2.323269041", "2.489079474", "1.716561299", "1.83716735", "1.740763945", "1.754214487", "2.197365417", "2.15005108", "2.315261361", "1.79651818", "1.794821279", "2.464060162", "3.357368084", "3.372627349", "4.584296057"] }] };
    for (var _Flourish_dataset in _Flourish_data) {
        window.template.data[_Flourish_dataset] = _Flourish_data[_Flourish_dataset];
        window.template.data[_Flourish_dataset].column_names = _Flourish_data_column_names[_Flourish_dataset];
    }
    window.template.draw();
    </script>
</body>

</html>